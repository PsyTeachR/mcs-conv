<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Multiple regression | MSc Conversion in Psychological Studies</title>
  <meta name="description" content="This book contains the materials for the MSc Conversion in Psychological Studies/Science." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Multiple regression | MSc Conversion in Psychological Studies" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book contains the materials for the MSc Conversion in Psychological Studies/Science." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Multiple regression | MSc Conversion in Psychological Studies" />
  
  <meta name="twitter:description" content="This book contains the materials for the MSc Conversion in Psychological Studies/Science." />
  



<meta name="date" content="2021-05-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression.html"/>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="include/psyteachr.css" type="text/css" />
<link rel="stylesheet" href="include/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MSc Conversion in Psychological Studies/Science (face-to-face)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#how-to-use-this-book-and-the-walkthrough-videos"><i class="fa fa-check"></i><b>0.1</b> How to use this book and the walkthrough videos</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#intended-learning-outcomes"><i class="fa fa-check"></i><b>0.2</b> Intended Learning Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="programming-basics.html"><a href="programming-basics.html"><i class="fa fa-check"></i><b>1</b> Programming basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="programming-basics.html"><a href="programming-basics.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="programming-basics.html"><a href="programming-basics.html#r-server"><i class="fa fa-check"></i><b>1.1.1</b> R server</a></li>
<li class="chapter" data-level="1.1.2" data-path="programming-basics.html"><a href="programming-basics.html#installing-r-on-your-computer"><i class="fa fa-check"></i><b>1.1.2</b> Installing R on your computer</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="programming-basics.html"><a href="programming-basics.html#getting-to-know-r-studio"><i class="fa fa-check"></i><b>1.2</b> Getting to know R Studio</a></li>
<li class="chapter" data-level="1.3" data-path="programming-basics.html"><a href="programming-basics.html#console-vs.-scripts"><i class="fa fa-check"></i><b>1.3</b> Console vs. scripts</a></li>
<li class="chapter" data-level="1.4" data-path="programming-basics.html"><a href="programming-basics.html#functions-and-arguments"><i class="fa fa-check"></i><b>1.4</b> Functions and arguments</a></li>
<li class="chapter" data-level="1.5" data-path="programming-basics.html"><a href="programming-basics.html#activity-1"><i class="fa fa-check"></i><b>1.5</b> Activity 1</a></li>
<li class="chapter" data-level="1.6" data-path="programming-basics.html"><a href="programming-basics.html#activity-2"><i class="fa fa-check"></i><b>1.6</b> Activity 2</a></li>
<li class="chapter" data-level="1.7" data-path="programming-basics.html"><a href="programming-basics.html#argument-names"><i class="fa fa-check"></i><b>1.7</b> Argument names</a></li>
<li class="chapter" data-level="1.8" data-path="programming-basics.html"><a href="programming-basics.html#tab-auto-complete"><i class="fa fa-check"></i><b>1.8</b> Tab auto-complete</a></li>
<li class="chapter" data-level="1.9" data-path="programming-basics.html"><a href="programming-basics.html#packages"><i class="fa fa-check"></i><b>1.9</b> Base R and packages</a></li>
<li class="chapter" data-level="1.10" data-path="programming-basics.html"><a href="programming-basics.html#activity-3-install-the-tidyverse-optional"><i class="fa fa-check"></i><b>1.10</b> Activity 3: Install the tidyverse (optional)</a></li>
<li class="chapter" data-level="1.11" data-path="programming-basics.html"><a href="programming-basics.html#activity-4-load-the-tidyverse"><i class="fa fa-check"></i><b>1.11</b> Activity 4: Load the tidyverse</a></li>
<li class="chapter" data-level="1.12" data-path="programming-basics.html"><a href="programming-basics.html#package-updates"><i class="fa fa-check"></i><b>1.12</b> Package updates</a></li>
<li class="chapter" data-level="1.13" data-path="programming-basics.html"><a href="programming-basics.html#conflicts"><i class="fa fa-check"></i><b>1.13</b> Package conflicts</a></li>
<li class="chapter" data-level="1.14" data-path="programming-basics.html"><a href="programming-basics.html#objects"><i class="fa fa-check"></i><b>1.14</b> Objects</a></li>
<li class="chapter" data-level="1.15" data-path="programming-basics.html"><a href="programming-basics.html#activity-5-create-some-objects"><i class="fa fa-check"></i><b>1.15</b> Activity 5: Create some objects</a></li>
<li class="chapter" data-level="1.16" data-path="programming-basics.html"><a href="programming-basics.html#looking-after-the-environment"><i class="fa fa-check"></i><b>1.16</b> Looking after the environment</a></li>
<li class="chapter" data-level="1.17" data-path="programming-basics.html"><a href="programming-basics.html#global-options"><i class="fa fa-check"></i><b>1.17</b> Global options</a></li>
<li class="chapter" data-level="1.18" data-path="programming-basics.html"><a href="programming-basics.html#r-sessions"><i class="fa fa-check"></i><b>1.18</b> R sessions</a></li>
<li class="chapter" data-level="1.19" data-path="programming-basics.html"><a href="programming-basics.html#activity-6"><i class="fa fa-check"></i><b>1.19</b> Activity 6</a></li>
<li class="chapter" data-level="1.20" data-path="programming-basics.html"><a href="programming-basics.html#how-to-cite-r-and-rstudio"><i class="fa fa-check"></i><b>1.20</b> How to cite R and RStudio</a></li>
<li class="chapter" data-level="1.21" data-path="programming-basics.html"><a href="programming-basics.html#help-and-additional-resources"><i class="fa fa-check"></i><b>1.21</b> Help and additional resources</a></li>
<li class="chapter" data-level="1.22" data-path="programming-basics.html"><a href="programming-basics.html#debugging-tips"><i class="fa fa-check"></i><b>1.22</b> Debugging tips</a></li>
<li class="chapter" data-level="1.23" data-path="programming-basics.html"><a href="programming-basics.html#test-yourself"><i class="fa fa-check"></i><b>1.23</b> Test yourself</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-to-r.html"><a href="intro-to-r.html"><i class="fa fa-check"></i><b>2</b> Intro to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro-to-r.html"><a href="intro-to-r.html#intro-a1"><i class="fa fa-check"></i><b>2.1</b> Activity 1: Create the working directory</a></li>
<li class="chapter" data-level="2.2" data-path="intro-to-r.html"><a href="intro-to-r.html#intro-a1b"><i class="fa fa-check"></i><b>2.2</b> Activity 1b: Upload data files to the server</a></li>
<li class="chapter" data-level="2.3" data-path="intro-to-r.html"><a href="intro-to-r.html#intro-a2"><i class="fa fa-check"></i><b>2.3</b> Activity 2: Set the working directory</a></li>
<li class="chapter" data-level="2.4" data-path="intro-to-r.html"><a href="intro-to-r.html#r-markdown-for-r-book-work-and-portfolio-assignments"><i class="fa fa-check"></i><b>2.4</b> R Markdown for R book work and portfolio assignments</a></li>
<li class="chapter" data-level="2.5" data-path="intro-to-r.html"><a href="intro-to-r.html#intro-a3"><i class="fa fa-check"></i><b>2.5</b> Activity 3: Open and save a new R Markdown document</a></li>
<li class="chapter" data-level="2.6" data-path="intro-to-r.html"><a href="intro-to-r.html#intro-a4"><i class="fa fa-check"></i><b>2.6</b> Activity 4: Create a new code chunk</a></li>
<li class="chapter" data-level="2.7" data-path="intro-to-r.html"><a href="intro-to-r.html#intro-a5"><i class="fa fa-check"></i><b>2.7</b> Activity 5: Write some code</a></li>
<li class="chapter" data-level="2.8" data-path="intro-to-r.html"><a href="intro-to-r.html#running-code"><i class="fa fa-check"></i><b>2.8</b> Running code</a></li>
<li class="chapter" data-level="2.9" data-path="intro-to-r.html"><a href="intro-to-r.html#intro-a6"><i class="fa fa-check"></i><b>2.9</b> Activity 6: Run your code</a></li>
<li class="chapter" data-level="2.10" data-path="intro-to-r.html"><a href="intro-to-r.html#intro-a7"><i class="fa fa-check"></i><b>2.10</b> Activity 7: Inline code</a></li>
<li class="chapter" data-level="2.11" data-path="intro-to-r.html"><a href="intro-to-r.html#intro-a8"><i class="fa fa-check"></i><b>2.11</b> Activity 8: Knitting your file</a></li>
<li class="chapter" data-level="2.12" data-path="intro-to-r.html"><a href="intro-to-r.html#intro-a9"><i class="fa fa-check"></i><b>2.12</b> Activity 9: Make R your own</a></li>
<li class="chapter" data-level="2.13" data-path="intro-to-r.html"><a href="intro-to-r.html#finished"><i class="fa fa-check"></i><b>2.13</b> Finished</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="loading-data.html"><a href="loading-data.html"><i class="fa fa-check"></i><b>3</b> Loading data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="loading-data.html"><a href="loading-data.html#getting-data-ready-to-work-with"><i class="fa fa-check"></i><b>3.1</b> Getting data ready to work with</a></li>
<li class="chapter" data-level="3.2" data-path="loading-data.html"><a href="loading-data.html#ld-a1"><i class="fa fa-check"></i><b>3.2</b> Activity 1: Set-up Loading Data</a></li>
<li class="chapter" data-level="3.3" data-path="loading-data.html"><a href="loading-data.html#ld-a2"><i class="fa fa-check"></i><b>3.3</b> Activity 2: Load in the package</a></li>
<li class="chapter" data-level="3.4" data-path="loading-data.html"><a href="loading-data.html#open-data"><i class="fa fa-check"></i><b>3.4</b> Open data</a></li>
<li class="chapter" data-level="3.5" data-path="loading-data.html"><a href="loading-data.html#ld-a3"><i class="fa fa-check"></i><b>3.5</b> Activity 3: Read in data</a></li>
<li class="chapter" data-level="3.6" data-path="loading-data.html"><a href="loading-data.html#ld-a4"><i class="fa fa-check"></i><b>3.6</b> Activity 4: Check yo’ data</a></li>
<li class="chapter" data-level="3.7" data-path="loading-data.html"><a href="loading-data.html#ld-a5"><i class="fa fa-check"></i><b>3.7</b> Activity 5: Join the files together</a></li>
<li class="chapter" data-level="3.8" data-path="loading-data.html"><a href="loading-data.html#ld-a6"><i class="fa fa-check"></i><b>3.8</b> Activity 6: Pull out variables of interest</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="loading-data.html"><a href="loading-data.html#ld-fin"><i class="fa fa-check"></i><b>3.8.1</b> Finished!</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="loading-data.html"><a href="loading-data.html#ld-debug"><i class="fa fa-check"></i><b>3.9</b> Debugging tips</a></li>
<li class="chapter" data-level="3.10" data-path="loading-data.html"><a href="loading-data.html#ld-debugex"><i class="fa fa-check"></i><b>3.10</b> Debugging exercises</a></li>
<li class="chapter" data-level="3.11" data-path="loading-data.html"><a href="loading-data.html#ld-test"><i class="fa fa-check"></i><b>3.11</b> Test yourself</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#tidyverse"><i class="fa fa-check"></i><b>4.1</b> Tidyverse</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-babynames-database"><i class="fa fa-check"></i><b>4.2</b> The <code>babynames</code> database</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#dw1-a1"><i class="fa fa-check"></i><b>4.3</b> Activity 1: Set-up</a></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#dw1-a2"><i class="fa fa-check"></i><b>4.4</b> Activity 2: Look at the data</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#dw1-a3"><i class="fa fa-check"></i><b>4.5</b> Activity 3: Your first plot</a></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#dw1-a4"><i class="fa fa-check"></i><b>4.6</b> Activity 4: Selecting variables of interest</a></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#dw1-a5"><i class="fa fa-check"></i><b>4.7</b> Activity 5: Arranging the data</a></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#dw1-a6"><i class="fa fa-check"></i><b>4.8</b> Activity 6: Using filter to select observations</a></li>
<li class="chapter" data-level="4.9" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#dw1-a7"><i class="fa fa-check"></i><b>4.9</b> Activity 7: Creating new variables</a></li>
<li class="chapter" data-level="4.10" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#dw1-a8"><i class="fa fa-check"></i><b>4.10</b> Activity 8: Grouping and summarising</a></li>
<li class="chapter" data-level="4.11" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#dw1-a9"><i class="fa fa-check"></i><b>4.11</b> Activity 9: Pipes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-to-wrangle-is-there-a-chastity-belt-on-perception"><i class="fa fa-check"></i><b>5.1</b> Learning to wrangle: Is there a chastity belt on perception</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a1"><i class="fa fa-check"></i><b>5.2</b> Activity 1: Set-up Data Wrangling 2</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a2"><i class="fa fa-check"></i><b>5.3</b> Activity 2: Look at your data</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a3"><i class="fa fa-check"></i><b>5.4</b> Activity 3: <strong><code>select()</code></strong></a></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a4"><i class="fa fa-check"></i><b>5.5</b> Activity 4: Reorder the variables</a></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a5"><i class="fa fa-check"></i><b>5.6</b> Activity 5: <strong><code>arrange()</code></strong></a></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a6"><i class="fa fa-check"></i><b>5.7</b> Activity 6: <code>filter()</code></a></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a7"><i class="fa fa-check"></i><b>5.8</b> Activity 7: <code>mutate()</code></a></li>
<li class="chapter" data-level="5.9" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a8"><i class="fa fa-check"></i><b>5.9</b> Activity 8: Summarising data</a></li>
<li class="chapter" data-level="5.10" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a9"><i class="fa fa-check"></i><b>5.10</b> Activity 9: Counting observations</a></li>
<li class="chapter" data-level="5.11" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-bind"><i class="fa fa-check"></i><b>5.11</b> <code>bind_rows()</code></a></li>
<li class="chapter" data-level="5.12" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-pipes"><i class="fa fa-check"></i><b>5.12</b> Pipes (<strong><code>%&gt;%</code></strong>)</a>
<ul>
<li class="chapter" data-level="5.12.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-fin"><i class="fa fa-check"></i><b>5.12.1</b> Finished!</a></li>
</ul></li>
<li class="chapter" data-level="5.13" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#ds2-activity-solutions---data-wrangling-2"><i class="fa fa-check"></i><b>5.13</b> DS2 Activity solutions - Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.13.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a3sol"><i class="fa fa-check"></i><b>5.13.1</b> Activity 3</a></li>
<li class="chapter" data-level="5.13.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a4sol"><i class="fa fa-check"></i><b>5.13.2</b> Activity 4</a></li>
<li class="chapter" data-level="5.13.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a5sol"><i class="fa fa-check"></i><b>5.13.3</b> Activity 5</a></li>
<li class="chapter" data-level="5.13.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a6sol"><i class="fa fa-check"></i><b>5.13.4</b> Activity 6</a></li>
<li class="chapter" data-level="5.13.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a7sol"><i class="fa fa-check"></i><b>5.13.5</b> Activity 7</a></li>
<li class="chapter" data-level="5.13.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-a8sol"><i class="fa fa-check"></i><b>5.13.6</b> Activity 8</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-debug"><i class="fa fa-check"></i><b>5.14</b> Debugging tips</a></li>
<li class="chapter" data-level="5.15" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dw2-test"><i class="fa fa-check"></i><b>5.15</b> Test yourself</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html"><i class="fa fa-check"></i><b>6</b> Data Wrangling 3</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#data-wrangling-recap"><i class="fa fa-check"></i><b>6.1</b> Data wrangling recap</a></li>
<li class="chapter" data-level="6.2" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#tidy-data"><i class="fa fa-check"></i><b>6.2</b> Tidy data</a></li>
<li class="chapter" data-level="6.3" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#analysing-the-autism-spectrum-quotient-aq"><i class="fa fa-check"></i><b>6.3</b> Analysing the Autism Spectrum Quotient (AQ)</a></li>
<li class="chapter" data-level="6.4" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a1"><i class="fa fa-check"></i><b>6.4</b> Activity 1: Set-up Data Wrangling 3</a></li>
<li class="chapter" data-level="6.5" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a2"><i class="fa fa-check"></i><b>6.5</b> Activity 2: Load in the data</a></li>
<li class="chapter" data-level="6.6" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a3"><i class="fa fa-check"></i><b>6.6</b> Activity 3: Look at your data</a></li>
<li class="chapter" data-level="6.7" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a4"><i class="fa fa-check"></i><b>6.7</b> Activity 4: Tidying data</a></li>
<li class="chapter" data-level="6.8" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a5"><i class="fa fa-check"></i><b>6.8</b> Activity 5: Combining data</a></li>
<li class="chapter" data-level="6.9" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a6"><i class="fa fa-check"></i><b>6.9</b> Activity 6: Combining more data</a></li>
<li class="chapter" data-level="6.10" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a7"><i class="fa fa-check"></i><b>6.10</b> Activity 7: Calculating the AQ scores</a></li>
<li class="chapter" data-level="6.11" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a8"><i class="fa fa-check"></i><b>6.11</b> Activity 8: One last thing on pipes</a></li>
<li class="chapter" data-level="6.12" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-sols"><i class="fa fa-check"></i><b>6.12</b> Activity solutions</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a2sol"><i class="fa fa-check"></i><b>6.12.1</b> Activity 2</a></li>
<li class="chapter" data-level="6.12.2" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a5sol"><i class="fa fa-check"></i><b>6.12.2</b> Activity 5</a></li>
<li class="chapter" data-level="6.12.3" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a7sol"><i class="fa fa-check"></i><b>6.12.3</b> Activity 7</a></li>
<li class="chapter" data-level="6.12.4" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-a8sol"><i class="fa fa-check"></i><b>6.12.4</b> Activity 8</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#dw3-test"><i class="fa fa-check"></i><b>6.13</b> Test yourself</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intro-to-data-viz.html"><a href="intro-to-data-viz.html"><i class="fa fa-check"></i><b>7</b> Intro to Data Viz</a>
<ul>
<li class="chapter" data-level="7.1" data-path="intro-to-data-viz.html"><a href="intro-to-data-viz.html#introviz-a1"><i class="fa fa-check"></i><b>7.1</b> Activity 1: dplyr recap</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="intro-to-data-viz.html"><a href="intro-to-data-viz.html#data-visualisation"><i class="fa fa-check"></i><b>7.1.1</b> Data visualisation</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="intro-to-data-viz.html"><a href="intro-to-data-viz.html#introviz-a2"><i class="fa fa-check"></i><b>7.2</b> Activity 2: Set-up</a></li>
<li class="chapter" data-level="7.3" data-path="intro-to-data-viz.html"><a href="intro-to-data-viz.html#introviz-a3"><i class="fa fa-check"></i><b>7.3</b> Activity 3: Factors</a></li>
<li class="chapter" data-level="7.4" data-path="intro-to-data-viz.html"><a href="intro-to-data-viz.html#introviz-a4"><i class="fa fa-check"></i><b>7.4</b> Activity 4: Bar plot</a></li>
<li class="chapter" data-level="7.5" data-path="intro-to-data-viz.html"><a href="intro-to-data-viz.html#introviz-a5"><i class="fa fa-check"></i><b>7.5</b> Activity 5: Violin-boxplot</a></li>
<li class="chapter" data-level="7.6" data-path="intro-to-data-viz.html"><a href="intro-to-data-viz.html#introviz-a6"><i class="fa fa-check"></i><b>7.6</b> Activity 6: Layers part 2</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="intro-to-data-viz.html"><a href="intro-to-data-viz.html#introviz-fin"><i class="fa fa-check"></i><b>7.6.1</b> Finished!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>8</b> Probability</a>
<ul>
<li class="chapter" data-level="8.1" data-path="probability.html"><a href="probability.html#prob-a1"><i class="fa fa-check"></i><b>8.1</b> Activity 1: Prep</a></li>
<li class="chapter" data-level="8.2" data-path="probability.html"><a href="probability.html#what-is-probability"><i class="fa fa-check"></i><b>8.2</b> What is probability?</a></li>
<li class="chapter" data-level="8.3" data-path="probability.html"><a href="probability.html#types-of-data"><i class="fa fa-check"></i><b>8.3</b> Types of data</a></li>
<li class="chapter" data-level="8.4" data-path="probability.html"><a href="probability.html#prob-a2"><i class="fa fa-check"></i><b>8.4</b> Activity 2: Types of data</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="probability.html"><a href="probability.html#probability-distributions"><i class="fa fa-check"></i><b>8.4.1</b> Probability distributions</a></li>
<li class="chapter" data-level="8.4.2" data-path="probability.html"><a href="probability.html#the-uniform-distribution"><i class="fa fa-check"></i><b>8.4.2</b> The uniform distribution</a></li>
<li class="chapter" data-level="8.4.3" data-path="probability.html"><a href="probability.html#the-binomial-distribution"><i class="fa fa-check"></i><b>8.4.3</b> The binomial distribution</a></li>
<li class="chapter" data-level="8.4.4" data-path="probability.html"><a href="probability.html#the-normal-distribution"><i class="fa fa-check"></i><b>8.4.4</b> The normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="probability.html"><a href="probability.html#prob-a3"><i class="fa fa-check"></i><b>8.5</b> Activity 3: Normal distribution</a></li>
<li class="chapter" data-level="8.6" data-path="probability.html"><a href="probability.html#prob-a4"><i class="fa fa-check"></i><b>8.6</b> Activity 4: Distribution test</a></li>
<li class="chapter" data-level="8.7" data-path="probability.html"><a href="probability.html#prob-a5"><i class="fa fa-check"></i><b>8.7</b> Activity 5: Binomial distribution</a></li>
<li class="chapter" data-level="8.8" data-path="probability.html"><a href="probability.html#prob-a6"><i class="fa fa-check"></i><b>8.8</b> Activity 6: <code>dbinom()</code></a></li>
<li class="chapter" data-level="8.9" data-path="probability.html"><a href="probability.html#prob-a7"><i class="fa fa-check"></i><b>8.9</b> Activity 7: <code>pbinom()</code></a></li>
<li class="chapter" data-level="8.10" data-path="probability.html"><a href="probability.html#prob-a8"><i class="fa fa-check"></i><b>8.10</b> Activity 8: <code>pbinom()</code> 2</a></li>
<li class="chapter" data-level="8.11" data-path="probability.html"><a href="probability.html#prob-a9"><i class="fa fa-check"></i><b>8.11</b> Activity 9: <code>qbinom()</code></a></li>
<li class="chapter" data-level="8.12" data-path="probability.html"><a href="probability.html#normal-distribution"><i class="fa fa-check"></i><b>8.12</b> Normal distribution</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="probability.html"><a href="probability.html#probability-of-heights"><i class="fa fa-check"></i><b>8.12.1</b> Probability of heights</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="probability.html"><a href="probability.html#prob-a10"><i class="fa fa-check"></i><b>8.13</b> Activity 10:<code>pnorm()</code></a></li>
<li class="chapter" data-level="8.14" data-path="probability.html"><a href="probability.html#prob-a11"><i class="fa fa-check"></i><b>8.14</b> Activity 11: <code>pnorm</code> 2</a></li>
<li class="chapter" data-level="8.15" data-path="probability.html"><a href="probability.html#prob-a12"><i class="fa fa-check"></i><b>8.15</b> Activity 12: <code>pnorm</code> 3</a></li>
<li class="chapter" data-level="8.16" data-path="probability.html"><a href="probability.html#prob-a13"><i class="fa fa-check"></i><b>8.16</b> Activity 13: <code>qnorm()</code></a></li>
<li class="chapter" data-level="8.17" data-path="probability.html"><a href="probability.html#prob-sols"><i class="fa fa-check"></i><b>8.17</b> Activity solutions</a>
<ul>
<li class="chapter" data-level="8.17.1" data-path="probability.html"><a href="probability.html#prob-a6sol"><i class="fa fa-check"></i><b>8.17.1</b> Activity 6</a></li>
<li class="chapter" data-level="8.17.2" data-path="probability.html"><a href="probability.html#prob-a7sol"><i class="fa fa-check"></i><b>8.17.2</b> Activity 7</a></li>
<li class="chapter" data-level="8.17.3" data-path="probability.html"><a href="probability.html#prob-a8sol"><i class="fa fa-check"></i><b>8.17.3</b> Activity 8</a></li>
<li class="chapter" data-level="8.17.4" data-path="probability.html"><a href="probability.html#prob-a10sol"><i class="fa fa-check"></i><b>8.17.4</b> Activity 10</a></li>
<li class="chapter" data-level="8.17.5" data-path="probability.html"><a href="probability.html#prob-a11sol"><i class="fa fa-check"></i><b>8.17.5</b> Activity 11</a></li>
<li class="chapter" data-level="8.17.6" data-path="probability.html"><a href="probability.html#prob-a12sol"><i class="fa fa-check"></i><b>8.17.6</b> Activity 12</a></li>
<li class="chapter" data-level="8.17.7" data-path="probability.html"><a href="probability.html#prob-a13sol"><i class="fa fa-check"></i><b>8.17.7</b> Activity 13</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>9</b> Correlation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="correlation.html"><a href="correlation.html#correlation-1"><i class="fa fa-check"></i><b>9.1</b> Correlation</a></li>
<li class="chapter" data-level="9.2" data-path="correlation.html"><a href="correlation.html#corr-a1"><i class="fa fa-check"></i><b>9.2</b> Activity 1: Set-up</a></li>
<li class="chapter" data-level="9.3" data-path="correlation.html"><a href="correlation.html#corr-a2"><i class="fa fa-check"></i><b>9.3</b> Activity 2: Look at your data</a></li>
<li class="chapter" data-level="9.4" data-path="correlation.html"><a href="correlation.html#corr-a3"><i class="fa fa-check"></i><b>9.4</b> Activity 3: Assumptions</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="correlation.html"><a href="correlation.html#assumption-1-level-of-measurement"><i class="fa fa-check"></i><b>9.4.1</b> Assumption 1: Level of Measurement</a></li>
<li class="chapter" data-level="9.4.2" data-path="correlation.html"><a href="correlation.html#assumption-2-pairs-of-data"><i class="fa fa-check"></i><b>9.4.2</b> Assumption 2: Pairs of Data</a></li>
<li class="chapter" data-level="9.4.3" data-path="correlation.html"><a href="correlation.html#assumption-3-5-normality-linearity-homoscedasticity"><i class="fa fa-check"></i><b>9.4.3</b> Assumption 3-5: Normality, linearity, homoscedasticity</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="correlation.html"><a href="correlation.html#correlation-scatterplot"><i class="fa fa-check"></i><b>9.5</b> Correlation Scatterplot</a></li>
<li class="chapter" data-level="9.6" data-path="correlation.html"><a href="correlation.html#corr-a4"><i class="fa fa-check"></i><b>9.6</b> Activity 4: Descriptive statistics</a></li>
<li class="chapter" data-level="9.7" data-path="correlation.html"><a href="correlation.html#corr-a5"><i class="fa fa-check"></i><b>9.7</b> Activity 5: Run the correlation</a></li>
<li class="chapter" data-level="9.8" data-path="correlation.html"><a href="correlation.html#corr-a6"><i class="fa fa-check"></i><b>9.8</b> Activity 6: Interpreting the correlation</a></li>
<li class="chapter" data-level="9.9" data-path="correlation.html"><a href="correlation.html#corr-a7"><i class="fa fa-check"></i><b>9.9</b> Activity 7: Write-up</a></li>
<li class="chapter" data-level="9.10" data-path="correlation.html"><a href="correlation.html#corr-a8"><i class="fa fa-check"></i><b>9.10</b> Activity 8: Scatterplot matrix</a></li>
<li class="chapter" data-level="9.11" data-path="correlation.html"><a href="correlation.html#corr-a9"><i class="fa fa-check"></i><b>9.11</b> Activity 9: Multiple correlations</a></li>
<li class="chapter" data-level="9.12" data-path="correlation.html"><a href="correlation.html#corr-fin"><i class="fa fa-check"></i><b>9.12</b> Finished!</a></li>
<li class="chapter" data-level="9.13" data-path="correlation.html"><a href="correlation.html#corr-sols"><i class="fa fa-check"></i><b>9.13</b> Activity solutions</a>
<ul>
<li class="chapter" data-level="9.13.1" data-path="correlation.html"><a href="correlation.html#corr-a1sol"><i class="fa fa-check"></i><b>9.13.1</b> Activity 1</a></li>
<li class="chapter" data-level="9.13.2" data-path="correlation.html"><a href="correlation.html#corr-a3sol"><i class="fa fa-check"></i><b>9.13.2</b> Activity 3</a></li>
<li class="chapter" data-level="9.13.3" data-path="correlation.html"><a href="correlation.html#corr-a4sol"><i class="fa fa-check"></i><b>9.13.3</b> Activity 4</a></li>
<li class="chapter" data-level="9.13.4" data-path="correlation.html"><a href="correlation.html#corr-a5sol"><i class="fa fa-check"></i><b>9.13.4</b> Activity 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="t-tests.html"><a href="t-tests.html"><i class="fa fa-check"></i><b>10</b> t-tests</a>
<ul>
<li class="chapter" data-level="10.1" data-path="t-tests.html"><a href="t-tests.html#ttest-a1"><i class="fa fa-check"></i><b>10.1</b> Activity 1: Set-up</a></li>
<li class="chapter" data-level="10.2" data-path="t-tests.html"><a href="t-tests.html#ttest-a2"><i class="fa fa-check"></i><b>10.2</b> Activity 2: Explore the dataset</a></li>
<li class="chapter" data-level="10.3" data-path="t-tests.html"><a href="t-tests.html#ttest-a3"><i class="fa fa-check"></i><b>10.3</b> Activity 3: Ratings</a></li>
<li class="chapter" data-level="10.4" data-path="t-tests.html"><a href="t-tests.html#ttest-a4"><i class="fa fa-check"></i><b>10.4</b> Activity 4: Visualisation</a></li>
<li class="chapter" data-level="10.5" data-path="t-tests.html"><a href="t-tests.html#ttest-a5"><i class="fa fa-check"></i><b>10.5</b> Activity 5: Assumptions</a></li>
<li class="chapter" data-level="10.6" data-path="t-tests.html"><a href="t-tests.html#ttest-a6"><i class="fa fa-check"></i><b>10.6</b> Activity 6: Running the t-test</a></li>
<li class="chapter" data-level="10.7" data-path="t-tests.html"><a href="t-tests.html#ttest-a7"><i class="fa fa-check"></i><b>10.7</b> Activity 7: Correcting for multiple comparisons</a></li>
<li class="chapter" data-level="10.8" data-path="t-tests.html"><a href="t-tests.html#ttest-a8"><i class="fa fa-check"></i><b>10.8</b> Activity 8: Effect size</a></li>
<li class="chapter" data-level="10.9" data-path="t-tests.html"><a href="t-tests.html#ttest-a9"><i class="fa fa-check"></i><b>10.9</b> Activity 9: Interpreting the results</a></li>
<li class="chapter" data-level="10.10" data-path="t-tests.html"><a href="t-tests.html#ttest-a10"><i class="fa fa-check"></i><b>10.10</b> Activity 10: Write-up</a></li>
<li class="chapter" data-level="10.11" data-path="t-tests.html"><a href="t-tests.html#ttest-a11"><i class="fa fa-check"></i><b>10.11</b> Activity 11: Paired-samples t-test</a></li>
<li class="chapter" data-level="10.12" data-path="t-tests.html"><a href="t-tests.html#ttest-a12"><i class="fa fa-check"></i><b>10.12</b> Activity 12: Assumptions</a></li>
<li class="chapter" data-level="10.13" data-path="t-tests.html"><a href="t-tests.html#ttest-a13"><i class="fa fa-check"></i><b>10.13</b> Activity 13: Descriptives and visualisations</a></li>
<li class="chapter" data-level="10.14" data-path="t-tests.html"><a href="t-tests.html#ttest-a14"><i class="fa fa-check"></i><b>10.14</b> Activity 14: Paired-samples t-test</a></li>
<li class="chapter" data-level="10.15" data-path="t-tests.html"><a href="t-tests.html#ttest-a15"><i class="fa fa-check"></i><b>10.15</b> Activity 15: Write-up</a>
<ul>
<li class="chapter" data-level="10.15.1" data-path="t-tests.html"><a href="t-tests.html#ttest-fin"><i class="fa fa-check"></i><b>10.15.1</b> Finished!</a></li>
</ul></li>
<li class="chapter" data-level="10.16" data-path="t-tests.html"><a href="t-tests.html#ttest-sols"><i class="fa fa-check"></i><b>10.16</b> Activity solutions</a>
<ul>
<li class="chapter" data-level="10.16.1" data-path="t-tests.html"><a href="t-tests.html#ttest-a1sol"><i class="fa fa-check"></i><b>10.16.1</b> Activity 1</a></li>
<li class="chapter" data-level="10.16.2" data-path="t-tests.html"><a href="t-tests.html#ttest-a2sol"><i class="fa fa-check"></i><b>10.16.2</b> Activity 2</a></li>
<li class="chapter" data-level="10.16.3" data-path="t-tests.html"><a href="t-tests.html#t-tests-activity-6"><i class="fa fa-check"></i><b>10.16.3</b> t-tests Activity 6</a></li>
<li class="chapter" data-level="10.16.4" data-path="t-tests.html"><a href="t-tests.html#ttest-a7sol"><i class="fa fa-check"></i><b>10.16.4</b> Activity 7</a></li>
<li class="chapter" data-level="10.16.5" data-path="t-tests.html"><a href="t-tests.html#ttest-a12sol"><i class="fa fa-check"></i><b>10.16.5</b> Activity 12</a></li>
<li class="chapter" data-level="10.16.6" data-path="t-tests.html"><a href="t-tests.html#ttest-a13sol"><i class="fa fa-check"></i><b>10.16.6</b> Activity 13</a></li>
<li class="chapter" data-level="10.16.7" data-path="t-tests.html"><a href="t-tests.html#ttest-a14sol"><i class="fa fa-check"></i><b>10.16.7</b> Activity 14</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="power-and-error.html"><a href="power-and-error.html"><i class="fa fa-check"></i><b>11</b> Power and error</a>
<ul>
<li class="chapter" data-level="11.1" data-path="power-and-error.html"><a href="power-and-error.html#effect-size"><i class="fa fa-check"></i><b>11.1</b> Effect Size</a></li>
<li class="chapter" data-level="11.2" data-path="power-and-error.html"><a href="power-and-error.html#power-a1"><i class="fa fa-check"></i><b>11.2</b> Activity 1: Set-up</a></li>
<li class="chapter" data-level="11.3" data-path="power-and-error.html"><a href="power-and-error.html#power-a2"><i class="fa fa-check"></i><b>11.3</b> Activity 2: Effect size from a one-sample t-test</a></li>
<li class="chapter" data-level="11.4" data-path="power-and-error.html"><a href="power-and-error.html#power-a3"><i class="fa fa-check"></i><b>11.4</b> Activity 3: Effect size from between-subjects t-test</a></li>
<li class="chapter" data-level="11.5" data-path="power-and-error.html"><a href="power-and-error.html#power-a4"><i class="fa fa-check"></i><b>11.5</b> Activity 4: t-value and effect size for a between-subjects Experiment</a></li>
<li class="chapter" data-level="11.6" data-path="power-and-error.html"><a href="power-and-error.html#power-a5"><i class="fa fa-check"></i><b>11.6</b> Activity 5: <code>pwr.t.test()</code></a></li>
<li class="chapter" data-level="11.7" data-path="power-and-error.html"><a href="power-and-error.html#power-a6"><i class="fa fa-check"></i><b>11.7</b> Activity 6: Sample size for standard power one-sample t-test</a></li>
<li class="chapter" data-level="11.8" data-path="power-and-error.html"><a href="power-and-error.html#pe-activity-7-effect-size-from-a-high-power-between-subjects-t-test"><i class="fa fa-check"></i><b>11.8</b> P&amp;E Activity 7: Effect size from a high power between-subjects t-test</a></li>
<li class="chapter" data-level="11.9" data-path="power-and-error.html"><a href="power-and-error.html#power-a8"><i class="fa fa-check"></i><b>11.9</b> Activity 8: Sample size for a correlation</a></li>
<li class="chapter" data-level="11.10" data-path="power-and-error.html"><a href="power-and-error.html#power-a9"><i class="fa fa-check"></i><b>11.10</b> Activity 9: Effect size for a correlation analysis</a></li>
<li class="chapter" data-level="11.11" data-path="power-and-error.html"><a href="power-and-error.html#power-a10"><i class="fa fa-check"></i><b>11.11</b> Activity 10: Power of published research</a>
<ul>
<li class="chapter" data-level="11.11.1" data-path="power-and-error.html"><a href="power-and-error.html#power-fin"><i class="fa fa-check"></i><b>11.11.1</b> Finished!</a></li>
</ul></li>
<li class="chapter" data-level="11.12" data-path="power-and-error.html"><a href="power-and-error.html#power-sols"><i class="fa fa-check"></i><b>11.12</b> Activity solutions</a>
<ul>
<li class="chapter" data-level="11.12.1" data-path="power-and-error.html"><a href="power-and-error.html#power-a1sol"><i class="fa fa-check"></i><b>11.12.1</b> Activity 1</a></li>
<li class="chapter" data-level="11.12.2" data-path="power-and-error.html"><a href="power-and-error.html#power-a2sol"><i class="fa fa-check"></i><b>11.12.2</b> Activity 2</a></li>
<li class="chapter" data-level="11.12.3" data-path="power-and-error.html"><a href="power-and-error.html#power-a3sol"><i class="fa fa-check"></i><b>11.12.3</b> Activity 3</a></li>
<li class="chapter" data-level="11.12.4" data-path="power-and-error.html"><a href="power-and-error.html#power-a4sol"><i class="fa fa-check"></i><b>11.12.4</b> Activity 4</a></li>
<li class="chapter" data-level="11.12.5" data-path="power-and-error.html"><a href="power-and-error.html#power-a6sol"><i class="fa fa-check"></i><b>11.12.5</b> Activity 6</a></li>
<li class="chapter" data-level="11.12.6" data-path="power-and-error.html"><a href="power-and-error.html#power-a7sol"><i class="fa fa-check"></i><b>11.12.6</b> Activity 7</a></li>
<li class="chapter" data-level="11.12.7" data-path="power-and-error.html"><a href="power-and-error.html#power-a8sol"><i class="fa fa-check"></i><b>11.12.7</b> Activity 8</a></li>
<li class="chapter" data-level="11.12.8" data-path="power-and-error.html"><a href="power-and-error.html#power-a9sol"><i class="fa fa-check"></i><b>11.12.8</b> Activity 9</a></li>
<li class="chapter" data-level="11.12.9" data-path="power-and-error.html"><a href="power-and-error.html#power-a10sol"><i class="fa fa-check"></i><b>11.12.9</b> Activity 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="screening-data.html"><a href="screening-data.html"><i class="fa fa-check"></i><b>12</b> Screening Data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="screening-data.html"><a href="screening-data.html#screening-a1"><i class="fa fa-check"></i><b>12.1</b> Activity 1: Set-up</a></li>
<li class="chapter" data-level="12.2" data-path="screening-data.html"><a href="screening-data.html#screening-a2"><i class="fa fa-check"></i><b>12.2</b> Activity 2: Look at the data</a></li>
<li class="chapter" data-level="12.3" data-path="screening-data.html"><a href="screening-data.html#missing-data"><i class="fa fa-check"></i><b>12.3</b> Missing data</a></li>
<li class="chapter" data-level="12.4" data-path="screening-data.html"><a href="screening-data.html#screening-a3"><i class="fa fa-check"></i><b>12.4</b> Activity 3: <code>summary()</code></a></li>
<li class="chapter" data-level="12.5" data-path="screening-data.html"><a href="screening-data.html#screening-a4"><i class="fa fa-check"></i><b>12.5</b> Activity 4: Listwise deletion</a></li>
<li class="chapter" data-level="12.6" data-path="screening-data.html"><a href="screening-data.html#pairwise-deletion"><i class="fa fa-check"></i><b>12.6</b> Pairwise deletion</a></li>
<li class="chapter" data-level="12.7" data-path="screening-data.html"><a href="screening-data.html#screening-a5"><i class="fa fa-check"></i><b>12.7</b> Activity 5: <code>na.rm = TRUE</code></a></li>
<li class="chapter" data-level="12.8" data-path="screening-data.html"><a href="screening-data.html#screening-a6"><i class="fa fa-check"></i><b>12.8</b> Activity 6: Implausible values</a></li>
<li class="chapter" data-level="12.9" data-path="screening-data.html"><a href="screening-data.html#screening-a7"><i class="fa fa-check"></i><b>12.9</b> Activity 7: Visualising implausible values</a></li>
<li class="chapter" data-level="12.10" data-path="screening-data.html"><a href="screening-data.html#dealing-with-implausible-values-or-missing-data"><i class="fa fa-check"></i><b>12.10</b> Dealing with implausible values or missing data</a></li>
<li class="chapter" data-level="12.11" data-path="screening-data.html"><a href="screening-data.html#alternative-descriptive-statistics"><i class="fa fa-check"></i><b>12.11</b> Alternative descriptive statistics</a></li>
<li class="chapter" data-level="12.12" data-path="screening-data.html"><a href="screening-data.html#screening-fin"><i class="fa fa-check"></i><b>12.12</b> Finished!</a></li>
<li class="chapter" data-level="12.13" data-path="screening-data.html"><a href="screening-data.html#screening-sols"><i class="fa fa-check"></i><b>12.13</b> Activity solutions</a>
<ul>
<li class="chapter" data-level="12.13.1" data-path="screening-data.html"><a href="screening-data.html#screening-a1sol"><i class="fa fa-check"></i><b>12.13.1</b> Activity 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="visualisation.html"><a href="visualisation.html"><i class="fa fa-check"></i><b>13</b> Visualisation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="visualisation.html"><a href="visualisation.html#viz-a1"><i class="fa fa-check"></i><b>13.1</b> Activity 1: Set-up Visualisation</a></li>
<li class="chapter" data-level="13.2" data-path="visualisation.html"><a href="visualisation.html#viz-a2"><i class="fa fa-check"></i><b>13.2</b> Activity 2: Histograms</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="visualisation.html"><a href="visualisation.html#basic-histogram"><i class="fa fa-check"></i><b>13.2.1</b> Basic histogram</a></li>
<li class="chapter" data-level="13.2.2" data-path="visualisation.html"><a href="visualisation.html#colour-and-fill"><i class="fa fa-check"></i><b>13.2.2</b> Colour and fill</a></li>
<li class="chapter" data-level="13.2.3" data-path="visualisation.html"><a href="visualisation.html#axis-labels"><i class="fa fa-check"></i><b>13.2.3</b> Axis labels</a></li>
<li class="chapter" data-level="13.2.4" data-path="visualisation.html"><a href="visualisation.html#density-curve"><i class="fa fa-check"></i><b>13.2.4</b> Density curve</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="visualisation.html"><a href="visualisation.html#viz-a3"><i class="fa fa-check"></i><b>13.3</b> Activity 3: Scatterplots</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="visualisation.html"><a href="visualisation.html#basic-scatterplot"><i class="fa fa-check"></i><b>13.3.1</b> Basic scatterplot</a></li>
<li class="chapter" data-level="13.3.2" data-path="visualisation.html"><a href="visualisation.html#axis-labels-1"><i class="fa fa-check"></i><b>13.3.2</b> Axis labels</a></li>
<li class="chapter" data-level="13.3.3" data-path="visualisation.html"><a href="visualisation.html#adding-a-regression-line"><i class="fa fa-check"></i><b>13.3.3</b> Adding a regression line</a></li>
<li class="chapter" data-level="13.3.4" data-path="visualisation.html"><a href="visualisation.html#grouped-scatterplots"><i class="fa fa-check"></i><b>13.3.4</b> Grouped scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="visualisation.html"><a href="visualisation.html#viz-a4"><i class="fa fa-check"></i><b>13.4</b> Activity 4: Boxplots</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="visualisation.html"><a href="visualisation.html#basic-boxplot"><i class="fa fa-check"></i><b>13.4.1</b> Basic boxplot</a></li>
<li class="chapter" data-level="13.4.2" data-path="visualisation.html"><a href="visualisation.html#adding-data-points"><i class="fa fa-check"></i><b>13.4.2</b> Adding data points</a></li>
<li class="chapter" data-level="13.4.3" data-path="visualisation.html"><a href="visualisation.html#adding-colour"><i class="fa fa-check"></i><b>13.4.3</b> Adding colour</a></li>
<li class="chapter" data-level="13.4.4" data-path="visualisation.html"><a href="visualisation.html#boxplots-for-multiple-factors"><i class="fa fa-check"></i><b>13.4.4</b> Boxplots for multiple factors</a></li>
<li class="chapter" data-level="13.4.5" data-path="visualisation.html"><a href="visualisation.html#colour-blind-friendly-options"><i class="fa fa-check"></i><b>13.4.5</b> Colour-blind friendly options</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="visualisation.html"><a href="visualisation.html#viz-a5"><i class="fa fa-check"></i><b>13.5</b> Activity 5: Reordering factors</a></li>
<li class="chapter" data-level="13.6" data-path="visualisation.html"><a href="visualisation.html#viz-a6"><i class="fa fa-check"></i><b>13.6</b> Activity 6: Bar Charts</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="visualisation.html"><a href="visualisation.html#basic-bar-chart"><i class="fa fa-check"></i><b>13.6.1</b> Basic bar chart</a></li>
<li class="chapter" data-level="13.6.2" data-path="visualisation.html"><a href="visualisation.html#bar-charts-with-two-factors"><i class="fa fa-check"></i><b>13.6.2</b> Bar charts with two factors</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="visualisation.html"><a href="visualisation.html#viz-a7"><i class="fa fa-check"></i><b>13.7</b> Activity 7: Violin plots</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="visualisation.html"><a href="visualisation.html#basic-violin-plot"><i class="fa fa-check"></i><b>13.7.1</b> Basic violin plot</a></li>
<li class="chapter" data-level="13.7.2" data-path="visualisation.html"><a href="visualisation.html#violin-plots-with-raw-data-points"><i class="fa fa-check"></i><b>13.7.2</b> Violin plots with raw data points</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="visualisation.html"><a href="visualisation.html#viz-a8"><i class="fa fa-check"></i><b>13.8</b> Activity 8: Violin-boxplots</a></li>
<li class="chapter" data-level="13.9" data-path="visualisation.html"><a href="visualisation.html#viz-a9"><i class="fa fa-check"></i><b>13.9</b> Activity 9: Faceting</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="visualisation.html"><a href="visualisation.html#facet-labelling"><i class="fa fa-check"></i><b>13.9.1</b> Facet labelling</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="visualisation.html"><a href="visualisation.html#viz-a10"><i class="fa fa-check"></i><b>13.10</b> Activity 10: Split-violins and raincloud plots</a>
<ul>
<li class="chapter" data-level="13.10.1" data-path="visualisation.html"><a href="visualisation.html#split-violin-plots"><i class="fa fa-check"></i><b>13.10.1</b> Split-violin plots</a></li>
<li class="chapter" data-level="13.10.2" data-path="visualisation.html"><a href="visualisation.html#raincloud-plots"><i class="fa fa-check"></i><b>13.10.2</b> Raincloud plots</a></li>
<li class="chapter" data-level="13.10.3" data-path="visualisation.html"><a href="visualisation.html#raincloud-plots-with-multiple-factors"><i class="fa fa-check"></i><b>13.10.3</b> Raincloud plots with multiple factors</a></li>
<li class="chapter" data-level="13.10.4" data-path="visualisation.html"><a href="visualisation.html#viz-fin"><i class="fa fa-check"></i><b>13.10.4</b> Finished!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>14</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="14.0.1" data-path="one-way-anova.html"><a href="one-way-anova.html#background-intrusive-memories"><i class="fa fa-check"></i><b>14.0.1</b> Background: Intrusive memories</a></li>
<li class="chapter" data-level="14.0.2" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-a1"><i class="fa fa-check"></i><b>14.0.2</b> Activity 1: Set-up</a></li>
<li class="chapter" data-level="14.0.3" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-a2"><i class="fa fa-check"></i><b>14.0.3</b> Activity 2: Data wrangling</a></li>
<li class="chapter" data-level="14.0.4" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-a3"><i class="fa fa-check"></i><b>14.0.4</b> Activity 3: Numbers and factors</a></li>
<li class="chapter" data-level="14.0.5" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-a4"><i class="fa fa-check"></i><b>14.0.5</b> Activity 4: Create summary statistics</a></li>
<li class="chapter" data-level="14.0.6" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-a5"><i class="fa fa-check"></i><b>14.0.6</b> Activity 5: Visualisation</a></li>
<li class="chapter" data-level="14.0.7" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-a6"><i class="fa fa-check"></i><b>14.0.7</b> Activity 6: One-way ANOVA</a></li>
<li class="chapter" data-level="14.0.8" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-a7"><i class="fa fa-check"></i><b>14.0.8</b> Activity 7: Assumption checking</a></li>
<li class="chapter" data-level="14.0.9" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-a8"><i class="fa fa-check"></i><b>14.0.9</b> Activity 8: Post-hoc tests</a></li>
<li class="chapter" data-level="14.0.10" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-a9"><i class="fa fa-check"></i><b>14.0.10</b> Activity 9: Power and effect size</a></li>
<li class="chapter" data-level="14.0.11" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-a10"><i class="fa fa-check"></i><b>14.0.11</b> Activity 10: Write-up</a></li>
<li class="chapter" data-level="14.0.12" data-path="one-way-anova.html"><a href="one-way-anova.html#anova-sols"><i class="fa fa-check"></i><b>14.0.12</b> Activity solutions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="factorial-anova.html"><a href="factorial-anova.html"><i class="fa fa-check"></i><b>15</b> Factorial ANOVA</a>
<ul>
<li class="chapter" data-level="15.0.1" data-path="factorial-anova.html"><a href="factorial-anova.html#factorial-a1"><i class="fa fa-check"></i><b>15.0.1</b> Activity 1: Set-up</a></li>
<li class="chapter" data-level="15.0.2" data-path="factorial-anova.html"><a href="factorial-anova.html#factorial-a2"><i class="fa fa-check"></i><b>15.0.2</b> Activity 2: Descriptive statistics</a></li>
<li class="chapter" data-level="15.0.3" data-path="factorial-anova.html"><a href="factorial-anova.html#factorial-a3"><i class="fa fa-check"></i><b>15.0.3</b> Activity 3: Violin-boxplots</a></li>
<li class="chapter" data-level="15.0.4" data-path="factorial-anova.html"><a href="factorial-anova.html#factorial-a4"><i class="fa fa-check"></i><b>15.0.4</b> Activity 4: Interaction plots</a></li>
<li class="chapter" data-level="15.0.5" data-path="factorial-anova.html"><a href="factorial-anova.html#factorial-a5"><i class="fa fa-check"></i><b>15.0.5</b> Activity 5: ANOVA</a></li>
<li class="chapter" data-level="15.0.6" data-path="factorial-anova.html"><a href="factorial-anova.html#factorial-a6"><i class="fa fa-check"></i><b>15.0.6</b> Activity 6: Assumption checking</a></li>
<li class="chapter" data-level="15.0.7" data-path="factorial-anova.html"><a href="factorial-anova.html#factorial-a7"><i class="fa fa-check"></i><b>15.0.7</b> Activity 7: Post-hoc tests</a></li>
<li class="chapter" data-level="15.0.8" data-path="factorial-anova.html"><a href="factorial-anova.html#factorial-a8"><i class="fa fa-check"></i><b>15.0.8</b> Activity 8: Write-up</a></li>
<li class="chapter" data-level="15.0.9" data-path="factorial-anova.html"><a href="factorial-anova.html#factorial-a9"><i class="fa fa-check"></i><b>15.0.9</b> Activity 9: Transforming data</a></li>
<li class="chapter" data-level="15.0.10" data-path="factorial-anova.html"><a href="factorial-anova.html#factorial-sols"><i class="fa fa-check"></i><b>15.0.10</b> Activity solutions</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>16</b> Regression</a>
<ul>
<li class="chapter" data-level="16.1" data-path="regression.html"><a href="regression.html#regression-a1"><i class="fa fa-check"></i><b>16.1</b> Activity 1: Setup</a></li>
<li class="chapter" data-level="16.2" data-path="regression.html"><a href="regression.html#regression-a2"><i class="fa fa-check"></i><b>16.2</b> Activity 2: Tidy the data</a></li>
<li class="chapter" data-level="16.3" data-path="regression.html"><a href="regression.html#regression-a3"><i class="fa fa-check"></i><b>16.3</b> Activity 3: Calculate mean anxiety for each student</a></li>
<li class="chapter" data-level="16.4" data-path="regression.html"><a href="regression.html#regression-a4"><i class="fa fa-check"></i><b>16.4</b> Activity 4: Join the datasets together</a></li>
<li class="chapter" data-level="16.5" data-path="regression.html"><a href="regression.html#regression-a5"><i class="fa fa-check"></i><b>16.5</b> Activity 5: Calculate descriptives for the variables overall</a></li>
<li class="chapter" data-level="16.6" data-path="regression.html"><a href="regression.html#regression-a6"><i class="fa fa-check"></i><b>16.6</b> Activity 6: Visualisations</a></li>
<li class="chapter" data-level="16.7" data-path="regression.html"><a href="regression.html#regression-a7"><i class="fa fa-check"></i><b>16.7</b> Activity 7: Run the regression</a></li>
<li class="chapter" data-level="16.8" data-path="regression.html"><a href="regression.html#regression-a8"><i class="fa fa-check"></i><b>16.8</b> Activity 8: Assumption checking</a></li>
<li class="chapter" data-level="16.9" data-path="regression.html"><a href="regression.html#regression-a9"><i class="fa fa-check"></i><b>16.9</b> Activity 9: Power and effect size</a></li>
<li class="chapter" data-level="16.10" data-path="regression.html"><a href="regression.html#regression-a10"><i class="fa fa-check"></i><b>16.10</b> Activity 10: Write-up</a></li>
<li class="chapter" data-level="16.11" data-path="regression.html"><a href="regression.html#regression-sols"><i class="fa fa-check"></i><b>16.11</b> Activity solutions</a>
<ul>
<li class="chapter" data-level="16.11.1" data-path="regression.html"><a href="regression.html#regression-a1sol"><i class="fa fa-check"></i><b>16.11.1</b> Activity 1</a></li>
<li class="chapter" data-level="16.11.2" data-path="regression.html"><a href="regression.html#regression-a2sol"><i class="fa fa-check"></i><b>16.11.2</b> Activity 2</a></li>
<li class="chapter" data-level="16.11.3" data-path="regression.html"><a href="regression.html#regression-a3sol"><i class="fa fa-check"></i><b>16.11.3</b> Activity 3</a></li>
<li class="chapter" data-level="16.11.4" data-path="regression.html"><a href="regression.html#regression-a4sol"><i class="fa fa-check"></i><b>16.11.4</b> Activity 4</a></li>
<li class="chapter" data-level="16.11.5" data-path="regression.html"><a href="regression.html#regression-a5sol"><i class="fa fa-check"></i><b>16.11.5</b> Activity 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>17</b> Multiple regression</a>
<ul>
<li class="chapter" data-level="17.1" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a1"><i class="fa fa-check"></i><b>17.1</b> Activity 1: Set-up</a></li>
<li class="chapter" data-level="17.2" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a2"><i class="fa fa-check"></i><b>17.2</b> Activity 2: Look at the data</a></li>
<li class="chapter" data-level="17.3" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a3"><i class="fa fa-check"></i><b>17.3</b> Activity 3: Compute the well-being score for each respondent</a></li>
<li class="chapter" data-level="17.4" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a4"><i class="fa fa-check"></i><b>17.4</b> Activity 4: Visualise the relationship</a></li>
<li class="chapter" data-level="17.5" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a5"><i class="fa fa-check"></i><b>17.5</b> Activity 5: Smartphone and well-being for boys and girls</a></li>
<li class="chapter" data-level="17.6" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a6"><i class="fa fa-check"></i><b>17.6</b> Activity 6: Mean-centering variables</a></li>
<li class="chapter" data-level="17.7" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a7"><i class="fa fa-check"></i><b>17.7</b> Activity 7: Visualise the relationship</a></li>
<li class="chapter" data-level="17.8" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a8"><i class="fa fa-check"></i><b>17.8</b> Activity 8: Running the regression</a></li>
<li class="chapter" data-level="17.9" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a9"><i class="fa fa-check"></i><b>17.9</b> Activity 9: Assumption checking</a></li>
<li class="chapter" data-level="17.10" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a10"><i class="fa fa-check"></i><b>17.10</b> Activity 10: Power and effect size</a></li>
<li class="chapter" data-level="17.11" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a11"><i class="fa fa-check"></i><b>17.11</b> Activity 11: Write-up</a></li>
<li class="chapter" data-level="17.12" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-fin"><i class="fa fa-check"></i><b>17.12</b> Finished!</a></li>
<li class="chapter" data-level="17.13" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-sols"><i class="fa fa-check"></i><b>17.13</b> Activity solutions</a>
<ul>
<li class="chapter" data-level="17.13.1" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a3sol"><i class="fa fa-check"></i><b>17.13.1</b> Activity 3</a></li>
<li class="chapter" data-level="17.13.2" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a5sol"><i class="fa fa-check"></i><b>17.13.2</b> Activity 5</a></li>
<li class="chapter" data-level="17.13.3" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a6sol"><i class="fa fa-check"></i><b>17.13.3</b> Activity 6</a></li>
<li class="chapter" data-level="17.13.4" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a7sol"><i class="fa fa-check"></i><b>17.13.4</b> Activity 7</a></li>
<li class="chapter" data-level="17.13.5" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a8sol"><i class="fa fa-check"></i><b>17.13.5</b> Activity 8</a></li>
<li class="chapter" data-level="17.13.6" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a9sol"><i class="fa fa-check"></i><b>17.13.6</b> Activity 9</a></li>
<li class="chapter" data-level="17.13.7" data-path="multiple-regression.html"><a href="multiple-regression.html#mulregression-a10sol"><i class="fa fa-check"></i><b>17.13.7</b> Activity 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#appendix-appendices"><i class="fa fa-check"></i>(APPENDIX) Appendices</a>
<ul>
<li class="chapter" data-level="17.14" data-path="17-multiple-regression.html"><a href="#exporting-files-from-the-server"><i class="fa fa-check"></i><b>17.14</b> Exporting files from the server</a></li>
<li class="chapter" data-level="17.15" data-path="multiple-regression.html"><a href="multiple-regression.html#installing-r"><i class="fa fa-check"></i><b>17.15</b> Installing R</a>
<ul>
<li class="chapter" data-level="17.15.1" data-path="multiple-regression.html"><a href="multiple-regression.html#why-should-i-install-r-on-my-computer"><i class="fa fa-check"></i><b>17.15.1</b> Why should I install R on my computer?</a></li>
<li class="chapter" data-level="17.15.2" data-path="multiple-regression.html"><a href="multiple-regression.html#windows"><i class="fa fa-check"></i><b>17.15.2</b> Windows</a></li>
<li class="chapter" data-level="17.15.3" data-path="multiple-regression.html"><a href="multiple-regression.html#mac"><i class="fa fa-check"></i><b>17.15.3</b> Mac</a></li>
<li class="chapter" data-level="17.15.4" data-path="multiple-regression.html"><a href="multiple-regression.html#chromebooks"><i class="fa fa-check"></i><b>17.15.4</b> Chromebooks</a></li>
</ul></li>
<li class="chapter" data-level="17.16" data-path="multiple-regression.html"><a href="multiple-regression.html#updating-r-rstudio-and-packages"><i class="fa fa-check"></i><b>17.16</b> Updating R, RStudio, and packages</a>
<ul>
<li class="chapter" data-level="17.16.1" data-path="multiple-regression.html"><a href="multiple-regression.html#updating-rstudio"><i class="fa fa-check"></i><b>17.16.1</b> Updating RStudio</a></li>
</ul></li>
<li class="chapter" data-level="17.17" data-path="multiple-regression.html"><a href="multiple-regression.html#updating-packages"><i class="fa fa-check"></i><b>17.17</b> Updating packages</a></li>
<li class="chapter" data-level="17.18" data-path="multiple-regression.html"><a href="multiple-regression.html#updating-r"><i class="fa fa-check"></i><b>17.18</b> Updating R</a></li>
<li class="chapter" data-level="17.19" data-path="multiple-regression.html"><a href="multiple-regression.html#additional-r-resources"><i class="fa fa-check"></i><b>17.19</b> Additional R resources</a></li>
<li class="chapter" data-level="17.20" data-path="multiple-regression.html"><a href="multiple-regression.html#comparing-two-correlations"><i class="fa fa-check"></i><b>17.20</b> Comparing two correlations</a>
<ul>
<li class="chapter" data-level="17.20.1" data-path="multiple-regression.html"><a href="multiple-regression.html#compare-two-correlations-based-on-two-independent-groups"><i class="fa fa-check"></i><b>17.20.1</b> Compare two correlations based on two independent groups</a></li>
<li class="chapter" data-level="17.20.2" data-path="multiple-regression.html"><a href="multiple-regression.html#compare-two-overlapping-correlations-based-on-two-dependent-groups"><i class="fa fa-check"></i><b>17.20.2</b> Compare two overlapping correlations based on two dependent groups</a></li>
<li class="chapter" data-level="17.20.3" data-path="multiple-regression.html"><a href="multiple-regression.html#compare-two-non-overlapping-correlations-from-two-dependent-groups"><i class="fa fa-check"></i><b>17.20.3</b> Compare two non-overlapping correlations from two dependent groups</a></li>
</ul></li>
<li class="chapter" data-level="17.21" data-path="multiple-regression.html"><a href="multiple-regression.html#data-transformation"><i class="fa fa-check"></i><b>17.21</b> Data transformation</a></li>
<li class="chapter" data-level="17.22" data-path="multiple-regression.html"><a href="multiple-regression.html#permutation-tests"><i class="fa fa-check"></i><b>17.22</b> Permutation tests</a>
<ul>
<li class="chapter" data-level="17.22.1" data-path="index.html"><a href="index.html#overview"><i class="fa fa-check"></i><b>17.22.1</b> Overview</a></li>
<li class="chapter" data-level="17.22.2" data-path="multiple-regression.html"><a href="multiple-regression.html#skill-1-generating-random-numbers"><i class="fa fa-check"></i><b>17.22.2</b> Skill 1: Generating Random Numbers</a></li>
<li class="chapter" data-level="17.22.3" data-path="multiple-regression.html"><a href="multiple-regression.html#skill-2-permuting-values"><i class="fa fa-check"></i><b>17.22.3</b> Skill 2: Permuting Values</a></li>
<li class="chapter" data-level="17.22.4" data-path="multiple-regression.html"><a href="multiple-regression.html#skill-3-creating-tibbles"><i class="fa fa-check"></i><b>17.22.4</b> Skill 3: Creating Tibbles</a></li>
<li class="chapter" data-level="17.22.5" data-path="multiple-regression.html"><a href="multiple-regression.html#entering-data-into-a-tibble"><i class="fa fa-check"></i><b>17.22.5</b> Entering Data into a Tibble</a></li>
<li class="chapter" data-level="17.22.6" data-path="multiple-regression.html"><a href="multiple-regression.html#repeating-values-to-save-typing"><i class="fa fa-check"></i><b>17.22.6</b> Repeating Values to Save Typing</a></li>
<li class="chapter" data-level="17.22.7" data-path="multiple-regression.html"><a href="multiple-regression.html#bringing-it-together-in-a-tibble"><i class="fa fa-check"></i><b>17.22.7</b> Bringing it Together in a Tibble</a></li>
<li class="chapter" data-level="17.22.8" data-path="multiple-regression.html"><a href="multiple-regression.html#skill-4-computing-differences-in-group-means"><i class="fa fa-check"></i><b>17.22.8</b> Skill 4: Computing Differences in Group Means</a></li>
<li class="chapter" data-level="17.22.9" data-path="multiple-regression.html"><a href="multiple-regression.html#skill-5-creating-your-own-functions"><i class="fa fa-check"></i><b>17.22.9</b> Skill 5: Creating Your Own Functions</a></li>
<li class="chapter" data-level="17.22.10" data-path="multiple-regression.html"><a href="multiple-regression.html#skill-6-replicating-operations"><i class="fa fa-check"></i><b>17.22.10</b> Skill 6: Replicating Operations</a></li>
<li class="chapter" data-level="17.22.11" data-path="intro-to-r.html"><a href="intro-to-r.html#finished"><i class="fa fa-check"></i><b>17.22.11</b> Finished!</a></li>
<li class="chapter" data-level="17.22.12" data-path="multiple-regression.html"><a href="multiple-regression.html#permutation-tests-of-hypotheses"><i class="fa fa-check"></i><b>17.22.12</b> Permutation Tests of Hypotheses</a></li>
<li class="chapter" data-level="17.22.13" data-path="multiple-regression.html"><a href="multiple-regression.html#Ch5InClassQueT1"><i class="fa fa-check"></i><b>17.22.13</b> Step 1: Load in Add-on Packages and Data</a></li>
<li class="chapter" data-level="17.22.14" data-path="multiple-regression.html"><a href="multiple-regression.html#Ch5InClassQueT2"><i class="fa fa-check"></i><b>17.22.14</b> Step 2: Calculate the Original Mean Difference - <span class="math inline">\(D_{orig}\)</span></a></li>
<li class="chapter" data-level="17.22.15" data-path="multiple-regression.html"><a href="multiple-regression.html#Ch5InClassQueT3"><i class="fa fa-check"></i><b>17.22.15</b> Step 3: Permute the Group Labels</a></li>
<li class="chapter" data-level="17.22.16" data-path="multiple-regression.html"><a href="multiple-regression.html#Ch5InClassQueT4"><i class="fa fa-check"></i><b>17.22.16</b> Step 4: Create the Null-Hypothesis Distribution (NHD) for the Difference</a></li>
<li class="chapter" data-level="17.22.17" data-path="multiple-regression.html"><a href="multiple-regression.html#Ch5InClassQueT5"><i class="fa fa-check"></i><b>17.22.17</b> Step 5: Compare the Observed Mean Difference to the NHD</a></li>
<li class="chapter" data-level="17.22.18" data-path="multiple-regression.html"><a href="multiple-regression.html#finished-1"><i class="fa fa-check"></i><b>17.22.18</b> Finished!</a></li>
</ul></li>
<li class="chapter" data-level="17.23" data-path="multiple-regression.html"><a href="multiple-regression.html#non-parametric-tests"><i class="fa fa-check"></i><b>17.23</b> Non-parametric tests</a></li>
<li class="chapter" data-level="17.24" data-path="multiple-regression.html"><a href="multiple-regression.html#dissertation-analysis-guide"><i class="fa fa-check"></i><b>17.24</b> Dissertation analysis guide</a>
<ul>
<li class="chapter" data-level="17.24.1" data-path="multiple-regression.html"><a href="multiple-regression.html#before-r"><i class="fa fa-check"></i><b>17.24.1</b> Before R</a></li>
<li class="chapter" data-level="17.24.2" data-path="multiple-regression.html"><a href="multiple-regression.html#study-design"><i class="fa fa-check"></i><b>17.24.2</b> Study design</a></li>
<li class="chapter" data-level="17.24.3" data-path="multiple-regression.html"><a href="multiple-regression.html#data-wrangling-considerations"><i class="fa fa-check"></i><b>17.24.3</b> Data wrangling considerations</a></li>
<li class="chapter" data-level="17.24.4" data-path="multiple-regression.html"><a href="multiple-regression.html#data-analysis"><i class="fa fa-check"></i><b>17.24.4</b> Data analysis</a></li>
<li class="chapter" data-level="17.24.5" data-path="multiple-regression.html"><a href="multiple-regression.html#exploring-and-cleaning-your-data"><i class="fa fa-check"></i><b>17.24.5</b> Exploring and cleaning your data</a></li>
<li class="chapter" data-level="17.24.6" data-path="multiple-regression.html"><a href="multiple-regression.html#summary"><i class="fa fa-check"></i><b>17.24.6</b> <code>summary()</code></a></li>
<li class="chapter" data-level="17.24.7" data-path="multiple-regression.html"><a href="multiple-regression.html#visualisations"><i class="fa fa-check"></i><b>17.24.7</b> Visualisations</a></li>
<li class="chapter" data-level="17.24.8" data-path="multiple-regression.html"><a href="multiple-regression.html#renaming-variables"><i class="fa fa-check"></i><b>17.24.8</b> Renaming variables</a></li>
<li class="chapter" data-level="17.24.9" data-path="multiple-regression.html"><a href="multiple-regression.html#converting-to-factors"><i class="fa fa-check"></i><b>17.24.9</b> Converting to factors</a></li>
<li class="chapter" data-level="17.24.10" data-path="multiple-regression.html"><a href="multiple-regression.html#dropping-irrelevant-variables"><i class="fa fa-check"></i><b>17.24.10</b> Dropping irrelevant variables</a></li>
<li class="chapter" data-level="17.24.11" data-path="multiple-regression.html"><a href="multiple-regression.html#recoding-variables"><i class="fa fa-check"></i><b>17.24.11</b> Recoding variables</a></li>
<li class="chapter" data-level="17.24.12" data-path="multiple-regression.html"><a href="multiple-regression.html#exclude-participantsdata"><i class="fa fa-check"></i><b>17.24.12</b> Exclude participants/data</a></li>
<li class="chapter" data-level="17.24.13" data-path="multiple-regression.html"><a href="multiple-regression.html#reliability"><i class="fa fa-check"></i><b>17.24.13</b> Reliability</a></li>
<li class="chapter" data-level="17.24.14" data-path="multiple-regression.html"><a href="multiple-regression.html#transforming-data"><i class="fa fa-check"></i><b>17.24.14</b> Transforming data</a></li>
<li class="chapter" data-level="17.24.15" data-path="multiple-regression.html"><a href="multiple-regression.html#replace-missing-values"><i class="fa fa-check"></i><b>17.24.15</b> Replace missing values</a></li>
<li class="chapter" data-level="17.24.16" data-path="multiple-regression.html"><a href="multiple-regression.html#convert-implausible-values"><i class="fa fa-check"></i><b>17.24.16</b> Convert implausible values</a></li>
<li class="chapter" data-level="17.24.17" data-path="multiple-regression.html"><a href="multiple-regression.html#calculate-z-scores"><i class="fa fa-check"></i><b>17.24.17</b> Calculate z-scores</a></li>
<li class="chapter" data-level="17.24.18" data-path="multiple-regression.html"><a href="multiple-regression.html#log-transformation"><i class="fa fa-check"></i><b>17.24.18</b> Log transformation</a></li>
<li class="chapter" data-level="17.24.19" data-path="multiple-regression.html"><a href="multiple-regression.html#square-root"><i class="fa fa-check"></i><b>17.24.19</b> Square root</a></li>
<li class="chapter" data-level="17.24.20" data-path="multiple-regression.html"><a href="multiple-regression.html#calculating-new-variables"><i class="fa fa-check"></i><b>17.24.20</b> Calculating new variables</a></li>
<li class="chapter" data-level="17.24.21" data-path="data-wrangling-3.html"><a href="data-wrangling-3.html#tidy-data"><i class="fa fa-check"></i><b>17.24.21</b> Tidy data</a></li>
<li class="chapter" data-level="17.24.22" data-path="multiple-regression.html"><a href="multiple-regression.html#summarising-and-visualising-data"><i class="fa fa-check"></i><b>17.24.22</b> Summarising and visualising data</a></li>
<li class="chapter" data-level="17.24.23" data-path="multiple-regression.html"><a href="multiple-regression.html#descriptive-statistics"><i class="fa fa-check"></i><b>17.24.23</b> Descriptive statistics</a></li>
<li class="chapter" data-level="17.24.24" data-path="intro-to-data-viz.html"><a href="intro-to-data-viz.html#data-visualisation"><i class="fa fa-check"></i><b>17.24.24</b> Data visualisation</a></li>
<li class="chapter" data-level="17.24.25" data-path="multiple-regression.html"><a href="multiple-regression.html#inferential-statistics"><i class="fa fa-check"></i><b>17.24.25</b> Inferential statistics</a></li>
<li class="chapter" data-level="17.24.26" data-path="multiple-regression.html"><a href="multiple-regression.html#assumption-tests"><i class="fa fa-check"></i><b>17.24.26</b> Assumption tests</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" 
    target="blank"><img alt="Creative Commons License" 
    style="border-width:0" 
    src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><li>
<li><a href="https://psyteachr.github.io/" target="blank">PsyTeachR</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MSc Conversion in Psychological Studies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-regression" class="section level1" number="17">
<h1><span class="header-section-number">Chapter 17</span> Multiple regression</h1>
<p>There is currently much debate (and hype) surrounding smartphones and their effects on well-being, especially with regard to children and teenagers. We’ll be looking at data from this recent study of English adolescents:</p>
<blockquote>
<p>Przybylski, A. &amp; Weinstein, N. (2017). A Large-Scale Test of the Goldilocks Hypothesis. <em>Psychological Science</em>, <em>28</em>, 204–215.</p>
</blockquote>
<p>This was a large-scale study that found support for the “Goldilocks” hypothesis among adolescents: that there is a “just right” amount of screen time, such that any amount more or less than this amount is associated with lower well-being. This was a huge survey study: the data contain responses from over 120,000 participants!</p>
<p>Fortunately, the authors made the data from this study openly available, which allows us to dig deeper into their results. In this exercise, we will look at whether the relationship between screen time and well-being is modulated by participants’ (self-reported) gender.</p>
<p>The dependent measure used in the study was the <a href="https://warwick.ac.uk/fac/med/research/platform/wemwbs/">Warwick-Edinburgh Mental Well-Being Scale (WEMWBS)</a>. This is a 14-item scale with 5 response categories, summed together to form a single score ranging from 14-70.</p>
<p>At <a href="https://osf.io/82ybd/">Przybylski &amp; Weinstein’s page for this study on the Open Science Framework</a>, you can find the <a href="https://osf.io/82ybd/">participant survey</a> which asks a large number of additional questions (see page 14 for the WEMWBS questions and pages 4-5 for the questions about screen time). Within the same page you can also find the <a href="https://osf.io/82ybd/">raw data</a>; however, for the purpose of this exercise, you will be using local pre-processed copies of the data which we will provide.</p>
<p>Przybylski and Weinstein looked at multiple measures of screen time, but we will be focusing on smartphone use. They found that decrements in well-being started to appear when respondents reported more than one hour of weekly smartphone use. Our question: Does the negative association between hours of use and well-being (beyond the one-hour point) differ for boys and girls?</p>
<p>Note that in this analysis, we have:</p>
<ul>
<li><p>a continuous<span class="math inline">\(^*\)</span> DV, well-being;</p></li>
<li><p>a continuous<span class="math inline">\(^*\)</span> predictor, screen time;</p></li>
<li><p>a categorical predictor, gender.</p></li>
</ul>
<p><span class="math inline">\(^*\)</span>these variables are only quasi-continuous, inasmuch as only discrete values are possible. However, there are a sufficient number of discrete categories that we can treat them as effectively continuous.</p>
<p>We want to estimate two slopes relating screen time to well-being, one for girls and one for boys, and then statistically compare these slopes. So this problem seems simultaneously like a situation where you would run a regression (to estimate the slopes) but also one where you would need a t-test (to compare two groups).</p>
<p>But the expressive power of regression allows us to do this all within a single model. As the <a href="http://deevybee.blogspot.com/2017/11/anova-t-tests-and-regression-different.html">Bishop blog showed</a>, <em>an independent groups t-test is just a special case of ordinary regression with a single categorical predictor; ANOVA is just a special case of regression where all predictors are categorical.</em> So although we can express any ANOVA design using regression, the converse is not true: we cannot express every regression design in ANOVA. Regression allows us to have any combination of continuous and categorical predictors in the model. The only inconvenience with running ANOVA models as regression models is that you have to take care in how you numerically code the categorical predictors.</p>
<div id="mulregression-a1" class="section level2" number="17.1">
<h2><span class="header-section-number">17.1</span> Activity 1: Set-up</h2>
<ul>
<li>Open R Studio and set the working directory to your chapter folder. Ensure the environment is clear.<br />
</li>
<li>Open a new R Markdown document and save it in your working directory. Call the file “Multiple Regression.”<br />
</li>
<li>Download <a href="wellbeing.csv" download>wellbeing.csv</a>, <a href="participant_info.csv" download>participant_info.csv</a> and <a href="screen_time.csv" download>screen_time.csv</a> and save them in your Chapter folder. Make sure that you do not change the file names at all.<br />
</li>
<li>If you’re on the server, avoid a number of issues by restarting the session - click <code>Session</code> - <code>Restart R</code></li>
<li>Delete the default R Markdown welcome text and insert a new code chunk that loads <code>pwr</code>, <code>car</code>, <code>broom</code>, and <code>tidyverse</code> using the <code>library()</code> function.</li>
<li>Load the CSV datasets into variables called <code>pinfo</code>, <code>wellbeing</code> and <code>screen</code> using <code>read_csv()</code>.</li>
</ul>
</div>
<div id="mulregression-a2" class="section level2" number="17.2">
<h2><span class="header-section-number">17.2</span> Activity 2: Look at the data</h2>
<p>Take a look at the resulting tibbles <code>pinfo</code>, <code>wellbeing</code>, and <code>screen</code>. The <code>wellbeing</code> tibble has information from the WEMWBS questionnaire; <code>screen</code> has information about screen time use on weekends (variables ending with <code>we</code>) and weekdays (variables ending with <code>wk</code>) for four types of activities: using a computer (variables starting with <code>Comph</code>; Q10 on the survey), playing video games (variables starting with <code>Comp</code>; Q9 on the survey), using a smartphone (variables starting with <code>Smart</code>; Q11 on the survey) and watching TV (variables starting with <code>Watch</code>; Q8 on the survey). If you want more information about these variables, look at the items 8-11 on pages 4-5 of the the <a href="https://osf.io/82ybd/">PDF version of the survey on the OSF website</a>.</p>
<ul>
<li><p>The variable corresponding to <em>gender</em> is located in the table named <select class='solveme' data-answer='["pinfo"]'> <option></option> <option>pinfo</option> <option>wellbeing</option> <option>screen</option></select> and this variable is called <input class='solveme nospaces' size='6' data-answer='["male"]'/>.</p></li>
<li><p>The WEMWBS data is in <select class='solveme' data-answer='["wide"]'> <option></option> <option>long</option> <option>wide</option></select> format, and contains observations from <input class='solveme nospaces' size='10' data-answer='["102580","102,580"]'/> participants on <input class='solveme nospaces' size='2' data-answer='["15"]'/> items.</p></li>
<li><p>Individual participants in this dataset are identified by the variable named <input class='solveme nospaces' size='9' data-answer='["Serial"]'/> [be sure to type the name <em>exactly</em>, including capitalization]. This variable will allow us to link information across the three tables.</p></li>
<li><p>Run <code>summary()</code> on the three data-sets. Are there any missing data points? <select class='solveme' data-answer='["No"]'> <option></option> <option>Yes</option> <option>No</option></select></p></li>
</ul>
</div>
<div id="mulregression-a3" class="section level2" number="17.3">
<h2><span class="header-section-number">17.3</span> Activity 3: Compute the well-being score for each respondent</h2>
<p>The WEMWBS well-being score is simply the <em>sum</em> of all the items.</p>
<ul>
<li>Write the code to create a new table called <code>wemwbs</code>, with two variables: <code>Serial</code> (the participant ID), and <code>tot_wellbeing</code>, the total WEMWBS score.</li>
</ul>
<div class="solution">
<button>
Hint
</button>
<ul>
<li>“pivot” the table from wide to long</li>
</ul>
</div>
<div class="solution">
<button>
Another Hint
</button>
<ul>
<li><code>group_by()</code>; <code>summarise(tot_wellbeing = ...)</code></li>
</ul>
</div>
<p><strong>Sanity check:</strong> Verify for yourself that the scores all fall in the 14-70 range. Przybylski and Weinstein reported a mean of 47.52 with a standard deviation of 9.55. Can you reproduce these values?</p>
<div class="solution">
<button>
Hint
</button>
<ul>
<li><code>summarise()</code>, <code>min()</code>, <code>max()</code></li>
</ul>
</div>
<p><br></p>
<ul>
<li>Now visualise the distribution of <code>tot_wellbeing</code> in a histogram using ggplot2.</li>
</ul>
<div class="solution">
<button>
Hint
</button>
<ul>
<li><code>geom_histogram()</code></li>
</ul>
</div>
<div class="solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="multiple-regression.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wemwbs, <span class="fu">aes</span>(tot_wellbeing)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center">
<img src="17-multiple-regression_files/figure-html/wemwbs_histogram-1.png" alt="**CAPTION THIS FIGURE!!**" width="100%" />
<p class="caption">
(#fig:wemwbs_histogram)<strong>CAPTION THIS FIGURE!!</strong>
</p>
</div>
</div>
<p>The distribution of well-being scores is <select class='solveme' data-answer='["negatively skewed"]'> <option></option> <option>symmetric</option> <option>negatively skewed</option> <option>positively skewed</option></select>.</p>
</div>
<div id="mulregression-a4" class="section level2" number="17.4">
<h2><span class="header-section-number">17.4</span> Activity 4: Visualise the relationship</h2>
<p>Let’s take a quick look at the relationship between screen time (for the four different technologies) and measures of well-being. Here is code to do this.</p>
<ul>
<li>Run the below code and try and explain in words what each line of code is doing (remember, pronounce <code>%&gt;%</code> as “and then”). You may find it easier to look at each of the tables that are produced.</li>
</ul>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="multiple-regression.html#cb311-1" aria-hidden="true" tabindex="-1"></a>screen_long <span class="ot">&lt;-</span> screen <span class="sc">%&gt;%</span></span>
<span id="cb311-2"><a href="multiple-regression.html#cb311-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;var&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;hours&quot;</span>, <span class="sc">-</span>Serial) <span class="sc">%&gt;%</span></span>
<span id="cb311-3"><a href="multiple-regression.html#cb311-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(var, <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;day&quot;</span>), <span class="st">&quot;_&quot;</span>)</span>
<span id="cb311-4"><a href="multiple-regression.html#cb311-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-5"><a href="multiple-regression.html#cb311-5" aria-hidden="true" tabindex="-1"></a>screen2 <span class="ot">&lt;-</span> screen_long <span class="sc">%&gt;%</span></span>
<span id="cb311-6"><a href="multiple-regression.html#cb311-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(variable,</span>
<span id="cb311-7"><a href="multiple-regression.html#cb311-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Watch&quot;</span> <span class="ot">=</span> <span class="st">&quot;Watching TV&quot;</span>,</span>
<span id="cb311-8"><a href="multiple-regression.html#cb311-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Comp&quot;</span> <span class="ot">=</span> <span class="st">&quot;Playing Video Games&quot;</span>,</span>
<span id="cb311-9"><a href="multiple-regression.html#cb311-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Comph&quot;</span> <span class="ot">=</span> <span class="st">&quot;Using Computers&quot;</span>,</span>
<span id="cb311-10"><a href="multiple-regression.html#cb311-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Smart&quot;</span> <span class="ot">=</span> <span class="st">&quot;Using Smartphone&quot;</span>),</span>
<span id="cb311-11"><a href="multiple-regression.html#cb311-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">day =</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(day,</span>
<span id="cb311-12"><a href="multiple-regression.html#cb311-12" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;wk&quot;</span> <span class="ot">=</span> <span class="st">&quot;Weekday&quot;</span>,</span>
<span id="cb311-13"><a href="multiple-regression.html#cb311-13" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;we&quot;</span> <span class="ot">=</span> <span class="st">&quot;Weekend&quot;</span>))</span>
<span id="cb311-14"><a href="multiple-regression.html#cb311-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-15"><a href="multiple-regression.html#cb311-15" aria-hidden="true" tabindex="-1"></a>dat_means <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(wemwbs, screen2, <span class="st">&quot;Serial&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb311-16"><a href="multiple-regression.html#cb311-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable, day, hours) <span class="sc">%&gt;%</span></span>
<span id="cb311-17"><a href="multiple-regression.html#cb311-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_wellbeing =</span> <span class="fu">mean</span>(tot_wellbeing))</span>
<span id="cb311-18"><a href="multiple-regression.html#cb311-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-19"><a href="multiple-regression.html#cb311-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat_means, <span class="fu">aes</span>(hours, mean_wellbeing, <span class="at">linetype =</span> day)) <span class="sc">+</span></span>
<span id="cb311-20"><a href="multiple-regression.html#cb311-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb311-21"><a href="multiple-regression.html#cb311-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb311-22"><a href="multiple-regression.html#cb311-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:combined"></span>
<img src="17-multiple-regression_files/figure-html/combined-1.png" alt="Relationship between wellbeing and screentime usage by technology and weekday" width="100%" />
<p class="caption">
Figure 17.1: Relationship between wellbeing and screentime usage by technology and weekday
</p>
</div>
<p>The graph makes it evident that smartphone use of more than 1 hour per day is associated with increasingly negative well-being. Note that we have combined the tables using an <code>inner_join()</code>, such that we only include data for which we have observations across the <code>wemwbs</code> and <code>screen2</code> tables.</p>
<p>In the next step, we are going to focus in on the smartphone/well-being relationship.</p>
</div>
<div id="mulregression-a5" class="section level2" number="17.5">
<h2><span class="header-section-number">17.5</span> Activity 5: Smartphone and well-being for boys and girls</h2>
<p>For this analysis, we are going to collapse weekday and weekend use for smartphones.</p>
<ul>
<li>Create a new table, <code>smarttot</code>, that has the that has mean number of hours per day of smartphone use for each participant, averaged over weekends/weekdays.</li>
<li>You will need to filter the dataset to only include smartphone use and not other technologies.</li>
<li>You will also need to group the results by the participant ID (i.e., <code>serial</code>).</li>
<li>The final data-set should have two variables: <code>Serial</code> (the participant) and <code>tothours</code>.</li>
<li>You will need to use the data-set <code>screen2</code> to do this.</li>
</ul>
<div class="solution">
<button>
Hint
</button>
<ul>
<li><code>filter()</code> then <code>group_by()</code> then <code>summarise()</code></li>
</ul>
</div>
<ul>
<li>Next, create a new tibble called <code>smart_wb</code> that only includes (filters) participants from <code>smarttot</code> who used a smartphone for more than one hour per day each week, and then combine (join) this table with the information in <code>wemwbs</code> and <code>pinfo</code>.**</li>
</ul>
<div class="solution">
<button>
Hint
</button>
<ul>
<li><code>filter()</code> then <code>inner_join()</code> then another <code>inner_join()</code></li>
</ul>
</div>
</div>
<div id="mulregression-a6" class="section level2" number="17.6">
<h2><span class="header-section-number">17.6</span> Activity 6: Mean-centering variables</h2>
<p>As discussed in the lecture, When you have continuous variables in a regression, it is often sensible to transform them by <em>mean centering</em>. You mean center a predictor <code>X</code> simply by subtracting the mean (<code>X_centered = X - mean(X)</code>). This has two useful consequences:</p>
<ul>
<li><p>the model intercept reflects the prediction for <span class="math inline">\(Y\)</span> at the mean value of the predictor variable, rather than at the zero value of the unscaled variable;</p></li>
<li><p>if there are interactions in the model, any lower-order effects can be given the same interpretation as they receive in ANOVA (main effects, rather than simple effects).</p></li>
</ul>
<p>For categorical predictors with two levels, these become coded as -.5 and .5 (because the mean of these two values is 0).</p>
<ul>
<li>Use <code>mutate</code> to add two new variables to <code>smart_wb</code>: <code>tothours_c</code>, calculated as a mean-centered version of the <code>tothours</code> predictor; and <code>male_c</code>, recoded as -.5 for female and .5 for male.</li>
<li>To create <code>male_c</code> you will need to use <code>if_else(male == 1, .5, -.5)</code> You can read this code as “if the variable <code>male</code> equals 1, recode it as .5, if not, recode it as -.5.”</li>
<li>Finally, recode <code>male</code> and <code>male_c</code> as factors, so that R knows not to treat them as a real numbers.</li>
</ul>
</div>
<div id="mulregression-a7" class="section level2" number="17.7">
<h2><span class="header-section-number">17.7</span> Activity 7: Visualise the relationship</h2>
<ul>
<li>Reverse-engineer the below plot. Calculate mean well-being scores for each combination of <code>male</code> and <code>tothours</code>, and then create a scatterplot plot that includes separate regression lines for each gender.</li>
<li>You may find it useful to refer to the Visualisation chapter.</li>
</ul>
<div class="solution">
<button>
Hint
</button>
<ul>
<li><code>group_by()</code> both variables then <code>summarise()</code></li>
<li><code>colour = variable_you_want_different_colours_for</code></li>
</ul>
</div>
<div class="figure" style="text-align: center"><span id="fig:plots"></span>
<img src="17-multiple-regression_files/figure-html/plots-1.png" alt="Relationship between mean wellbeing and smartphone use by gender" width="100%" />
<p class="caption">
Figure 17.2: Relationship between mean wellbeing and smartphone use by gender
</p>
</div>
<p>Write an interpretation of the above plot in plain English.</p>
<div class="solution">
<button>
Possible solution
</button>
<p>Girls show lower overall well-being compared to boys. In addition, the slope for girls appears more negative than that for boys; the one for boys appears relatively flat. This suggests that the negative association between well-being and smartphone use is stronger for girls.</p>
</div>
</div>
<div id="mulregression-a8" class="section level2" number="17.8">
<h2><span class="header-section-number">17.8</span> Activity 8: Running the regression</h2>
<p>Now we’re going to see if there is statistical support for our above interpretation of the graph.</p>
<p>For the data in <code>smart_wb</code>, use the <code>lm()</code> function to calculate the multiple regression model:</p>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{3i} + e_i\)</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(Y_i\)</span> is the well-being score for participant <span class="math inline">\(i\)</span>;</li>
<li><span class="math inline">\(X_{1i}\)</span> is the mean-centered smartphone use variable for participant <span class="math inline">\(i\)</span>;</li>
<li><span class="math inline">\(X_{2i}\)</span> is gender (-.5 = female, .5 = male);</li>
<li><span class="math inline">\(X_{3i}\)</span> is the interaction between smartphone use and gender (<span class="math inline">\(= X_{1i} \times X_{2i}\)</span>)</li>
</ul>
<p>Then use <code>summary()</code> to view the results and store this in an object called <code>mod_summary()</code>.</p>
<div class="solution">
<button>
Hint
</button>
<ul>
<li>R formulas look like this: <code>y ~ a + b + a:b</code> where <code>a:b</code> means interaction</li>
</ul>
</div>
<ul>
<li><p>The interaction between smartphone use and gender is shown by the variable <select class='solveme' data-answer='["thours_c:male_c"]'> <option></option> <option>thours_c</option> <option>male_c</option> <option>thours_c:male_c</option></select>, and this interaction was <select class='solveme' data-answer='["significant"]'> <option></option> <option>significant</option> <option>nonsignificant</option></select> at the <span class="math inline">\(\alpha = .05\)</span> level.</p></li>
<li><p>To 2 decimal places, what proportion of the variance in well-being scores does the overall model explain? <input class='solveme nospaces' size='4' data-answer='["9.38"]'/></p></li>
<li><p>The p-value for the overall model fit is <code>&lt; 2.2e-16</code>. Is this significant? <select class='solveme' data-answer='["Yes"]'> <option></option> <option>Yes</option> <option>No</option></select></p></li>
<li><p>What is the most reasonable interpretation of these results? <select class='solveme' data-answer='["smartphone use was more negatively associated with wellbeing for girls than for boys"]'> <option></option> <option>smartphone use harms girls more than boys</option> <option>smartphone use harms boys more than girls</option> <option>there is no evidence for gender differences in the relationship between smartphone use and well-being</option> <option>smartphone use was more negatively associated with wellbeing for girls than for boys</option></select></p></li>
</ul>
</div>
<div id="mulregression-a9" class="section level2" number="17.9">
<h2><span class="header-section-number">17.9</span> Activity 9: Assumption checking</h2>
<p>Now it’s time to test those pesky assumptions. The assumptions for multiple regression are the same as simple regression but there is one additional assumption, that of multicollinearity, the idea that predictor variables should not be too highly correlated.</p>
<ol style="list-style-type: decimal">
<li>The outcome/DV is a interval/ratio level data</li>
<li>The predictor variable is interval/ratio or categorical (with two levels)</li>
<li>All values of the outcome variable are independent (i.e., each score should come from a different participant)</li>
<li>The predictors have non-zero variance</li>
<li>The relationship between outcome and predictor is linear</li>
<li>The residuals should be normally distributed</li>
<li>There should be homoscedasticity (homogeneity of variance, but for the residuals)</li>
<li>Multicollinearity: predictor variables should not be too highly correlated</li>
</ol>
<p>From the work we’ve done so far we know that assumptions 1 - 4 are met. Unlike when we did simple regression we can’t use <code>crPlots()</code> to test for linearity when there is an interaction, but we know from looking at the grouped scatterplot that this assumption has been met.</p>
<p>Normally we would test for normality with a qqplot and a Shapiro-Wilk test. However, because this dataset is so large, the Shapiro-Wilk is not appropriate (if you try to run the test it will produce a warning telling you that the sample size must be between 3 and 5000). This is because as we have mentioned before, with extremely large sample sizes the Shapiro-Wilk test will find that any deviation from normality is significant. Therefore we should judge normality based upon the qqplots.</p>
<ul>
<li>Create a qqplot of the model residuals. Can we assume normality? <select class='solveme' data-answer='["Yes"]'> <option></option> <option>Yes</option> <option>No</option></select></li>
</ul>
<p>We also have this problem for testing homoscedasticity with <code>ncvTest()</code> so we need to rely on plots again. To check for homoscedasticity we can use <code>plot()</code> from Base R that will produce a bunch of helpful plots (<a href="https://www.r-bloggers.com/how-to-detect-heteroscedasticity-and-rectify-it/">more information here</a>). The residuals vs leverage plot shows a flat red line so, whilst it isn’t perfect, we can assume that with such a large sample size regression is still an appropriate analysis.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="multiple-regression.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co"># 4 charts in 1 panel</span></span>
<span id="cb312-2"><a href="multiple-regression.html#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plots2"></span>
<img src="17-multiple-regression_files/figure-html/plots2-1.png" alt="Regression assumption plots" width="100%" />
<p class="caption">
Figure 17.3: Regression assumption plots
</p>
</div>
<p>Finally, to check for multicollinearity we can use <code>vif()</code> to calculate the variance inflation factor. Essentially, this function estimates how much the variance of a coefficient is “inflated” because of linear dependence with other predictors, i.e., that a predictor isn’t actually adding any unique variance to the model, it’s just really strongly related to other predictors. <a href="https://statisticalhorizons.com/multicollinearity">You can read more about this here</a>. Thankfully, VIF is not affected by large samples like the other tests.</p>
<p>There are various rules of thumb, but most converge on a VIF of above 2 - 2.5 for any one predictor being problematic.</p>
<ul>
<li>Run the below code. Do any of the predictors show evidence of multicollinearity? <select class='solveme' data-answer='["There is no evidence of multicollinearity"]'> <option></option> <option>thours_c</option> <option>male_c</option> <option>thours_c:male_c</option> <option>There is no evidence of multicollinearity</option></select></li>
</ul>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="multiple-regression.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(mod)</span></code></pre></div>
</div>
<div id="mulregression-a10" class="section level2" number="17.10">
<h2><span class="header-section-number">17.10</span> Activity 10: Power and effect size</h2>
<p>Finally, we’ll calculate power and effect size as usual.</p>
<ul>
<li><p>Using the code from Power and Effect Size calculate the minimum effect size we could reliably observe given our sample size and design but for 99% power. Report this to 2 decimal places <input class='solveme nospaces' size='0.00' data-answer='[".00"]'/></p></li>
<li><p>What is the observed effect size for the study to 2 decimal places? <input class='solveme nospaces' size='0.10' data-answer='[".10"]'/><br />
</p></li>
<li><p>Is the study sufficiently powered? <select class='solveme' data-answer='["Yes"]'> <option></option> <option>Yes</option> <option>No</option></select></p></li>
</ul>
</div>
<div id="mulregression-a11" class="section level2" number="17.11">
<h2><span class="header-section-number">17.11</span> Activity 11: Write-up</h2>
<p>Now, copy and paste the below code into <strong>white-space</strong> and then knit the document. Note that the p-values are entered manually because of the APA <code>p &lt; .001</code> formatting.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="multiple-regression.html#cb314-1" aria-hidden="true" tabindex="-1"></a>All continuous predictors were mean<span class="sc">-</span>centered and deviation coding was used <span class="cf">for</span> categorical predictors. The results of the regression indicated that the model significantly predicted course <span class="fu">engagement</span> (<span class="fu">F</span>(<span class="st">`</span><span class="at">r mod_summary$fstatistic[2]</span><span class="st">`</span>, <span class="st">`</span><span class="at">r mod_summary$fstatistic[3] %&gt;% round(2)</span><span class="st">`</span>) <span class="ot">=</span> <span class="st">`</span><span class="at">r mod_summary$fstatistic[1] %&gt;% round(2)</span><span class="st">`</span>, p <span class="sc">&lt;</span> .<span class="dv">001</span>, Adjusted <span class="at">R2 =</span> <span class="st">`</span><span class="at">r mod_summary$adj.r.squared %&gt;% round(2)</span><span class="st">`</span>, f<span class="sc">^</span><span class="dv">2</span><span class="sc">^</span> <span class="er">=</span> .<span class="dv">63</span>), accounting <span class="cf">for</span> <span class="st">`</span><span class="at">r (mod_summary$adj.r.squared %&gt;% round(2))*100</span><span class="st">`</span><span class="sc">% of the variance. Total screen time was a significant negative predictor of wellbeing scores (β = `r mod$coefficients[2] %</span><span class="er">&gt;</span><span class="sc">% round(2)`, p &lt; .001, as was gender (β = `r mod$coefficients[3] %</span><span class="er">&gt;</span><span class="sc">% round(2)`, p &lt; .001, with girls having lower wellbeing scores than boys. Importantly, there was a significant interaction between screentime and gender (β = `r mod$coefficients[4] %</span><span class="er">&gt;</span>% <span class="fu">round</span>(<span class="dv">2</span>)<span class="st">`</span><span class="at">, p &lt; .001), smartphone use was more negatively associated with wellbeing for girls than for boys. </span></span></code></pre></div>
<blockquote>
<p>All continuous predictors were mean-centered and deviation coding was used for categorical predictors. The results of the regression indicated that the model significantly predicted course engagement (F(3, 7.1029^{4}) = 2450.89, p &lt; .001, Adjusted R2 = 0.09, f2 = .63), accounting for 9% of the variance. Total screen time was a significant negative predictor of well-being scores (β = -0.77, p &lt; .001, as was gender (β = 5.14, p &lt; .001, with girls having lower well-being scores than boys. Importantly, there was a significant interaction between screen time and gender (β = 0.45, p &lt; .001), smartphone use was more negatively associated with well-being for girls than for boys.</p>
</blockquote>
</div>
<div id="mulregression-fin" class="section level2" number="17.12">
<h2><span class="header-section-number">17.12</span> Finished!</h2>
<p>And you’re done! Not just with this week but with the R component of RM2! Well, aside from the final portfolio worksheet. The progress that you have made is truly astonishing. Even if you struggled with R and haven’t quite understood every single line of code we’ve shown, what you’re capable of with data wrangling and visualisation alone makes you some of the most highly competitive psychology graduates in the world.</p>
<p>Regardless of whether you continue with quantitative methods and using R, remember the more important critical skills that you have learned as part of this process. The next time you see a dataset or you see data being talked about in the news, think about all work that was put into getting the data into the final format. More importantly, think about all the decisions that the researcher needed to make along the way and how that might have affected the outcome.</p>
<p><img src="https://media.giphy.com/media/ujGfBmVppmgEg/giphy.gif" /></p>
</div>
<div id="mulregression-sols" class="section level2" number="17.13">
<h2><span class="header-section-number">17.13</span> Activity solutions</h2>
<div id="mulregression-a3sol" class="section level3" number="17.13.1">
<h3><span class="header-section-number">17.13.1</span> Activity 3</h3>
<div class="solution">
<button>
Activity 3
</button>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="multiple-regression.html#cb315-1" aria-hidden="true" tabindex="-1"></a>wemwbs <span class="ot">&lt;-</span> wellbeing <span class="sc">%&gt;%</span></span>
<span id="cb315-2"><a href="multiple-regression.html#cb315-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;var&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;score&quot;</span>, <span class="sc">-</span>Serial) <span class="sc">%&gt;%</span></span>
<span id="cb315-3"><a href="multiple-regression.html#cb315-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Serial) <span class="sc">%&gt;%</span></span>
<span id="cb315-4"><a href="multiple-regression.html#cb315-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tot_wellbeing =</span> <span class="fu">sum</span>(score))</span>
<span id="cb315-5"><a href="multiple-regression.html#cb315-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-6"><a href="multiple-regression.html#cb315-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sanity check values</span></span>
<span id="cb315-7"><a href="multiple-regression.html#cb315-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-8"><a href="multiple-regression.html#cb315-8" aria-hidden="true" tabindex="-1"></a>wemwbs <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(tot_wellbeing),</span>
<span id="cb315-9"><a href="multiple-regression.html#cb315-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sd =</span> <span class="fu">sd</span>(tot_wellbeing),</span>
<span id="cb315-10"><a href="multiple-regression.html#cb315-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span> <span class="fu">min</span>(tot_wellbeing), </span>
<span id="cb315-11"><a href="multiple-regression.html#cb315-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">max =</span> <span class="fu">max</span>(tot_wellbeing))</span></code></pre></div>
</div>
</div>
<div id="mulregression-a5sol" class="section level3" number="17.13.2">
<h3><span class="header-section-number">17.13.2</span> Activity 5</h3>
<div class="solution">
<button>
Activity 5
</button>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="multiple-regression.html#cb316-1" aria-hidden="true" tabindex="-1"></a>smarttot <span class="ot">&lt;-</span> screen2 <span class="sc">%&gt;%</span></span>
<span id="cb316-2"><a href="multiple-regression.html#cb316-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">&quot;Using Smartphone&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb316-3"><a href="multiple-regression.html#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Serial) <span class="sc">%&gt;%</span></span>
<span id="cb316-4"><a href="multiple-regression.html#cb316-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tothours =</span> <span class="fu">mean</span>(hours))</span>
<span id="cb316-5"><a href="multiple-regression.html#cb316-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-6"><a href="multiple-regression.html#cb316-6" aria-hidden="true" tabindex="-1"></a>smart_wb <span class="ot">&lt;-</span> smarttot <span class="sc">%&gt;%</span></span>
<span id="cb316-7"><a href="multiple-regression.html#cb316-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tothours <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb316-8"><a href="multiple-regression.html#cb316-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(wemwbs, <span class="st">&quot;Serial&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb316-9"><a href="multiple-regression.html#cb316-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(pinfo, <span class="st">&quot;Serial&quot;</span>) </span></code></pre></div>
</div>
</div>
<div id="mulregression-a6sol" class="section level3" number="17.13.3">
<h3><span class="header-section-number">17.13.3</span> Activity 6</h3>
<div class="solution">
<button>
Activity 6
</button>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="multiple-regression.html#cb317-1" aria-hidden="true" tabindex="-1"></a>smart_wb <span class="ot">&lt;-</span> smarttot <span class="sc">%&gt;%</span></span>
<span id="cb317-2"><a href="multiple-regression.html#cb317-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tothours <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb317-3"><a href="multiple-regression.html#cb317-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(wemwbs, <span class="st">&quot;Serial&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb317-4"><a href="multiple-regression.html#cb317-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(pinfo, <span class="st">&quot;Serial&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb317-5"><a href="multiple-regression.html#cb317-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">thours_c =</span> tothours <span class="sc">-</span> <span class="fu">mean</span>(tothours),</span>
<span id="cb317-6"><a href="multiple-regression.html#cb317-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">male_c =</span> <span class="fu">ifelse</span>(male <span class="sc">==</span> <span class="dv">1</span>, .<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>),</span>
<span id="cb317-7"><a href="multiple-regression.html#cb317-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">male_c =</span> <span class="fu">as.factor</span>(male_c),</span>
<span id="cb317-8"><a href="multiple-regression.html#cb317-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">male =</span> <span class="fu">as.factor</span>(male))</span></code></pre></div>
</div>
</div>
<div id="mulregression-a7sol" class="section level3" number="17.13.4">
<h3><span class="header-section-number">17.13.4</span> Activity 7</h3>
<div class="solution">
<button>
Activity 7
</button>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="multiple-regression.html#cb318-1" aria-hidden="true" tabindex="-1"></a>smart_wb_gen <span class="ot">&lt;-</span> smart_wb <span class="sc">%&gt;%</span></span>
<span id="cb318-2"><a href="multiple-regression.html#cb318-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tothours, male) <span class="sc">%&gt;%</span></span>
<span id="cb318-3"><a href="multiple-regression.html#cb318-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_wellbeing =</span> <span class="fu">mean</span>(tot_wellbeing))</span>
<span id="cb318-4"><a href="multiple-regression.html#cb318-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-5"><a href="multiple-regression.html#cb318-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(smart_wb_gen, <span class="fu">aes</span>(tothours, mean_wellbeing, <span class="at">color =</span> male)) <span class="sc">+</span></span>
<span id="cb318-6"><a href="multiple-regression.html#cb318-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb318-7"><a href="multiple-regression.html#cb318-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb318-8"><a href="multiple-regression.html#cb318-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Gender&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>))<span class="sc">+</span></span>
<span id="cb318-9"><a href="multiple-regression.html#cb318-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Total hours smartphone use&quot;</span>) <span class="sc">+</span></span>
<span id="cb318-10"><a href="multiple-regression.html#cb318-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Mean well-being score&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="mulregression-a8sol" class="section level3" number="17.13.5">
<h3><span class="header-section-number">17.13.5</span> Activity 8</h3>
<div class="solution">
<button>
Activity 8
</button>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="multiple-regression.html#cb319-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(tot_wellbeing <span class="sc">~</span> thours_c <span class="sc">*</span> male_c, smart_wb)</span>
<span id="cb319-2"><a href="multiple-regression.html#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively: </span></span>
<span id="cb319-3"><a href="multiple-regression.html#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mod &lt;- lm(tot_wellbeing ~ thours_c + male_c + thours_c:male_c, smart_wb)</span></span>
<span id="cb319-4"><a href="multiple-regression.html#cb319-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-5"><a href="multiple-regression.html#cb319-5" aria-hidden="true" tabindex="-1"></a>mod_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)</span></code></pre></div>
</div>
</div>
<div id="mulregression-a9sol" class="section level3" number="17.13.6">
<h3><span class="header-section-number">17.13.6</span> Activity 9</h3>
<div class="solution">
<button>
Activity 9
</button>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="multiple-regression.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(mod<span class="sc">$</span>residuals)</span></code></pre></div>
</div>
</div>
<div id="mulregression-a10sol" class="section level3" number="17.13.7">
<h3><span class="header-section-number">17.13.7</span> Activity 10</h3>
<div class="solution">
<button>
Activity 9
</button>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="multiple-regression.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> <span class="dv">3</span>, <span class="at">v =</span> <span class="dv">71029</span>, <span class="at">f2 =</span> <span class="cn">NULL</span>, <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="at">power =</span> .<span class="dv">99</span>)</span>
<span id="cb321-2"><a href="multiple-regression.html#cb321-2" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> mod_summary<span class="sc">$</span>adj.r.squared<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> mod_summary<span class="sc">$</span>adj.r.squared)</span></code></pre></div>
</div>

</div>
</div>
</div>



<h2><span class="header-section-number">14</span> Exporting files from the server</h2>
<p>If you are using the R server, you may need to export files to share them with other people or submit them for your assignments.</p>
<ul>
<li>First, make sure you have saved any changes you have made to the file. Do this by clicking “File - Save,” Ctrl + S, or clicking the save icon. If all your changes have been saved, the save icon will be greyed out. If there are new unsaved changes, you will be able to click the icon.</li>
<li>Select the file you and to download in the files pane (bottom right) by ticking the box next to it, then click “More - Export” and save the file to your computer.<br />
</li>
<li>If you do not have R installed, DO NOT try to open it on your computer. If you do, it will open in Word, Endnote or similar, and it may corrupt your code. Only open the file if you have R and R Studio installed.<br />
</li>
<li>If you want to double check that this file is definitely the right one to submit for an assignment, you can re-upload it to the server and open it again to make sure it has the answers in it.</li>
</ul>
</div>
<div id="installing-r" class="section level2" number="17.15">
<h2><span class="header-section-number">15</span> Installing R</h2>
<div id="why-should-i-install-r-on-my-computer" class="section level3" number="17.15.1">
<h3><span class="header-section-number">15.1</span> Why should I install R on my computer?</h3>
<p>The R Server is cuts down on a lot of installation problems and it means that you have all the packages and functions you need already installed. However, it requires an internet connection to use and additional when it comes time to submit your R assessments, if you don’t have R on your computer it means that you won’t be able to open the files you download from the server to check they’re ok before you submit them.</p>
<p>There are some great detailed walkthrough videos by <a href="https://www.youtube.com/playlist?list=PLRPB0ZzEYegOZivdelOuEn-R-XUN-DOjd">Danielle Narvarro on YouTube</a> re: how to install R on both Windows and Mac.</p>
</div>
<div id="windows" class="section level3" number="17.15.2">
<h3><span class="header-section-number">15.2</span> Windows</h3>
<p>If you are using Windows, you should download and install the following:</p>
<ul>
<li><a href="https://cran.r-project.org/bin/windows/base/">R</a></li>
<li><a href="https://rstudio.com/products/rstudio/download/#download">R Studio</a></li>
<li><a href="https://cran.r-project.org/bin/windows/Rtools/">RTools</a></li>
</ul>
<p>Once you’ve installed all three programs, restart your computer. Then, open RStudio (not R) and run the below code:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="multiple-regression.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>This will install the <code>tidyverse</code> package on your computer. If you have any problems installing R, please book into a GTA session as they should be able to help you with any installation problems.</p>
</div>
<div id="mac" class="section level3" number="17.15.3">
<h3><span class="header-section-number">15.3</span> Mac</h3>
<p>If you are using a Mac, you should download and install the following:</p>
<ul>
<li><a href="https://www.stats.bris.ac.uk/R/">R</a><br />
</li>
<li><a href="https://rstudio.com/products/rstudio/download/#download">R Studio</a><br />
</li>
<li><a href="https://www.xquartz.org/">XQuartz</a></li>
</ul>
<p>If you have any issues installing R on your Mac, first, we recommend that you watch the <a href="https://www.youtube.com/watch?v=ay25o485YXs&amp;list=PLRPB0ZzEYegOZivdelOuEn-R-XUN-DOjd&amp;index=1&amp;t=113s">walkthrough by Danielle Navarro</a>.</p>
<p>If you have further issues on Mac, you may find this video helpful <a href="https://www.youtube.com/watch?v=90IdULVGmYY">walkthrough video</a>. Additionally, if you are using a Mac with the Catalina OS, we also recommend you read this <a href="https://psyteachr.github.io/FAQ/installing-r-and-rstudio.html#i-am-using-macos-10.15-catalina">troubleshooting guide</a></p>
<p>Once you’ve installed all three programs, restart your computer. Then, open RStudio (not R) and run the below code:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="multiple-regression.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>This will install the <code>tidyverse</code> package on your computer. If you have any problems installing R, please book into a GTA session as they should be able to help you with any installation problems.</p>
</div>
<div id="chromebooks" class="section level3" number="17.15.4">
<h3><span class="header-section-number">15.4</span> Chromebooks</h3>
<p>Please note that you cannot currently install R on a Chromebook, please use the R Server.</p>
</div>
</div>
<div id="updating-r-rstudio-and-packages" class="section level2" number="17.16">
<h2><span class="header-section-number">16</span> Updating R, RStudio, and packages</h2>
<p>From time-to-time, updated versions of R, RStudio, and the packages you use (e.g., ggplot) will become available. Remember that each of these are separate, so they each have a different process and come with different considerations. We recommend updating to the latest version of all three at the start of each academic year.</p>
<div id="updating-rstudio" class="section level3" number="17.16.1">
<h3><span class="header-section-number">16.1</span> Updating RStudio</h3>
<p>RStudio is the easiest component to update. Typically, updates to RStudio won’t affect your code, instead they add in new features, like spell-check or upgrades to what RStudio can do. There’s usually very little downside to updating RStudio and it’s easy to do.</p>
<p>Click <code>Help - Check for updates</code></p>
<div class="figure" style="text-align: center"><span id="fig:img-updaterstudio"></span>
<img src="images/update_rstudio.jpg" alt="Updating RStudio" width="100%" />
<p class="caption">
Figure 17.4: Updating RStudio
</p>
</div>
<p>If an update is available, it will prompt you to download it and you can install it as usual.</p>
</div>
</div>
<div id="updating-packages" class="section level2" number="17.17">
<h2><span class="header-section-number">17</span> Updating packages</h2>
<p>Package developers will occasionally release updates to their packages. This is typically to add in new functions to the package, or to fix or amend existing functions. <strong>Be aware that some package updates may cause your previous code to stop working</strong>. This does not tend to happen with minor updates to packages, but occasionally with major updates, you can have serious issues if the developer has made fundamental changes to how the code works. For this reason, we recommend updating all your packages once at the beginning of each academic year (or semester) - don’t do it before an assessment or deadline just in case!</p>
<p>To update an individual package, the easiest way is to use the <code>install.packages()</code> function, as this always installs the most recent version of the package.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="multiple-regression.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>To update multiple packages, or indeed all packages, RStudio provides helpful tools. Click <code>Tools - Check for Package Updates</code>. A dialogue box will appear and you can select the packages you wish to update. Be aware that if you select all packages, this may take some time and you will be unable to use R whilst the process completes.</p>
<div class="figure" style="text-align: center"><span id="fig:img-updateall"></span>
<img src="images/update_packages.jpg" alt="Updating packages with RStudio" width="100%" />
<p class="caption">
Figure 17.5: Updating packages with RStudio
</p>
</div>
<p>Occasionally, you might have a few problem packages that seemingly refuse to update, for me, <code>rlang</code> and <code>vctrs</code> cause me no end of trouble. These aren’t packages that you will likely ever explicitly load, but they’re required beneath the surface for R to do things like knit your Markdown files etc.</p>
<p>If you try to update an existing package and get an error message that says something like <code>Warning in install.packages : installation of package ‘vctrs’ had non-zero exit status</code> or perhaps <code>Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]) :  namespace 'rlang' 0.4.9 is being loaded, but &gt;= 0.4.10 is required</code> one solution I have found is to manually uninstall the package, restart R, and then install the package new, rather than trying to update an existing version. The <code>installr</code> package also has a useful function for uninstalling packages.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="multiple-regression.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load installr</span></span>
<span id="cb325-2"><a href="multiple-regression.html#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(installr)</span>
<span id="cb325-3"><a href="multiple-regression.html#cb325-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-4"><a href="multiple-regression.html#cb325-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Uninstall the problem package</span></span>
<span id="cb325-5"><a href="multiple-regression.html#cb325-5" aria-hidden="true" tabindex="-1"></a><span class="fu">uninstall.packages</span>(<span class="st">&quot;package_name&quot;</span>)</span>
<span id="cb325-6"><a href="multiple-regression.html#cb325-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-7"><a href="multiple-regression.html#cb325-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Then restart R using session - restart R</span></span>
<span id="cb325-8"><a href="multiple-regression.html#cb325-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Then install the package fresh</span></span>
<span id="cb325-9"><a href="multiple-regression.html#cb325-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-10"><a href="multiple-regression.html#cb325-10" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;package&quot;</span>)</span></code></pre></div>
</div>
<div id="updating-r" class="section level2" number="17.18">
<h2><span class="header-section-number">18</span> Updating R</h2>
<p>Finally, you may also wish to update R itself. The key thing to be aware of is that when you update R, if you just download the latest version from the website, you will lose all your packages. The easiest way to update R and not cause yourself a huge headache is to use the <code>installr</code> package. When you use the <code>updateR()</code> function, a series of dialogue boxes will appear. These should be fairly self-explanatory but there is a <a href="https://www.r-statistics.com/2015/06/a-step-by-step-screenshots-tutorial-for-upgrading-r-on-windows/">full step-by-step guide available</a> for how to use <code>installr</code>, the important bit is to select “Yes” when it asked if you would like to copy your packages from the older version of R.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="multiple-regression.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install the installr package</span></span>
<span id="cb326-2"><a href="multiple-regression.html#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;installr&quot;</span>)</span>
<span id="cb326-3"><a href="multiple-regression.html#cb326-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-4"><a href="multiple-regression.html#cb326-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load installr</span></span>
<span id="cb326-5"><a href="multiple-regression.html#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(installr)</span>
<span id="cb326-6"><a href="multiple-regression.html#cb326-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-7"><a href="multiple-regression.html#cb326-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the update function</span></span>
<span id="cb326-8"><a href="multiple-regression.html#cb326-8" aria-hidden="true" tabindex="-1"></a><span class="fu">updateR</span>()</span></code></pre></div>
<p>As always, if you’re having issues, please ask on Teams or book into a GTA session.</p>
</div>
<div id="additional-r-resources" class="section level2" number="17.19">
<h2><span class="header-section-number">19</span> Additional R resources</h2>
<p>If you would like additional practice, you can check out the other UofG PsyTeachR course books.</p>
<ul>
<li><a href="https://psyteachr.github.io/ug1-practical/">Level 1</a> - Intro to R (overlaps with Msc Conv book), data wrangling, data viz, descriptive statistics<br />
</li>
<li><a href="https://psyteachr.github.io/ug2-practical/">Level 2</a> - Our second-year undergraduate course introduces statistical concepts such as permutation tests,t-tests, NHST, alpha, power, effect size, and sample size. Semester 2 focusses on correlations and the general linear model.</li>
<li><a href="https://psyteachr.github.io/ug3-stats/">Level 3</a>: This third-year undergraduate course teaches students how to specify, estimate, and interpret statistical models corresponding to various study designs, using a General Linear Models approach.</li>
<li><a href="https://psyteachr.github.io/msc-data-skills/">MSc Data Skills</a>: This course provides an overview of skills needed for reproducible research and open science using the statistical programming language R. Students will learn about data visualisation, data tidying and wrangling, archiving, iteration and functions, probability and data simulations, general linear models, and reproducible workflows.</li>
</ul>
<p>We also highly recommend the following, they will help practice your data wrangling skills but also they’re great options if you’re enjoying R and want to stretch yourself:</p>
<ul>
<li><a href="https://sites.trinity.edu/osl">Open Stats Lab</a> - this wonderful resource gives you practice at running statistical tests by providing you with datasets from published papers.</li>
<li><a href="https://r4ds.had.co.nz/">R for Data Science</a> - written by the authors of the tidyverse, this is a great resource for additional data wrangling practice and more depth on many of the tidyverse functions.</li>
<li><a href="https://www.tidytextmining.com/">Text Mining with R</a> - Shows you how to use R to work with text. This isn’t something we cover in this course, but it uses the same data wrangling skills and be a very useful additional skill to have.</li>
<li><a href="https://bbc.github.io/rcookbook/#how_to_create_bbc_style_graphics">How to make BBC style graphics</a> - Ever wondered how the BBC News makes their data visualisation? Well, now you can make your own!</li>
<li><a href="https://socviz.co/">Data Vizualisation</a> - this is an entire book on data visualisation and goes into detail on how to take <code>ggplot</code> to its limits.</li>
</ul>
</div>
<div id="comparing-two-correlations" class="section level2" number="17.20">
<h2><span class="header-section-number">20</span> Comparing two correlations</h2>
<p>Sometimes you will need or want to statistically compare the strength of two correlation coefficients to help determine whether they are statistically different (rather than just comparing r values). For this set of analyses you will need to install and load the <code>cocor</code> package as well as the <code>tidyverse</code> and <code>lsr</code>.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="multiple-regression.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cocor)</span>
<span id="cb327-2"><a href="multiple-regression.html#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb327-3"><a href="multiple-regression.html#cb327-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lsr)</span></code></pre></div>
<p>The <code>cocor</code> package comes with a built-in dataset called <code>aptitude</code>. This dataset contains scores on four aptitude tests <code>knowledge</code>, <code>logic</code>, <code>intelligence.a</code>, and <code>intelligence.b</code> for two separate samples. This data is stored in a <code>list</code> object that then contains two separate data frames <code>sample1</code> and <code>sample2</code>. We haven’t worked with lists much in this book but <code>cocor</code> requires the data to be in list format so it’s worth spending a little time on this before we get going.</p>
<p>First, load the built-in aptitude dataset.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="multiple-regression.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;aptitude&quot;</span>)</span></code></pre></div>
<p>You can view the contents of each dataset by calling them separately:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="multiple-regression.html#cb329-1" aria-hidden="true" tabindex="-1"></a>aptitude<span class="sc">$</span>sample1</span>
<span id="cb329-2"><a href="multiple-regression.html#cb329-2" aria-hidden="true" tabindex="-1"></a>aptitude<span class="sc">$</span>sample2</span></code></pre></div>
<p>However, it may that your research dataset isn’t structured like this and that the data for the two groups or samples you want to compare is in the same dataset (for example, for the data for your quantitative report).</p>
<p>The below code transforms the data to the format you’re likely to have so that we can show you how to put it back into list form by using the <code>bind_rows()</code> function to pull out the two datasets, bind them together, and add on a column called <code>sample</code> that identifies which dataset the data is from.</p>
<ul>
<li>Run the below code and then view <code>full_dat</code> to see how it is structured.</li>
</ul>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="multiple-regression.html#cb330-1" aria-hidden="true" tabindex="-1"></a>full_dat <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(aptitude<span class="sc">$</span>sample1, aptitude<span class="sc">$</span>sample2, <span class="at">.id =</span> <span class="st">&quot;sample&quot;</span>)</span></code></pre></div>
<p>This is how the data for your quantitative report is structured. All the data you have is in a single table and there is a column that tells you what group it is from (in this case <code>sample</code> but for the quant report this might be gender or whether the student is mature).</p>
<p>To use <code>cocor</code> to compare the correlations you will need to transform it into a list object. We achieve this by creating two separate objects for each sample using <code>filter()</code> and then we combine them back into a <code>list</code>. We’ve also added in the code to ensure that the table is a data frame because <code>cocor</code> is a bit fussy about what it needs.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="multiple-regression.html#cb331-1" aria-hidden="true" tabindex="-1"></a>sample1 <span class="ot">&lt;-</span> full_dat <span class="sc">%&gt;%</span></span>
<span id="cb331-2"><a href="multiple-regression.html#cb331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb331-3"><a href="multiple-regression.html#cb331-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-4"><a href="multiple-regression.html#cb331-4" aria-hidden="true" tabindex="-1"></a>sample2 <span class="ot">&lt;-</span> full_dat <span class="sc">%&gt;%</span></span>
<span id="cb331-5"><a href="multiple-regression.html#cb331-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb331-6"><a href="multiple-regression.html#cb331-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-7"><a href="multiple-regression.html#cb331-7" aria-hidden="true" tabindex="-1"></a>dat_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">sample1 =</span> <span class="fu">as.data.frame</span>(sample1),</span>
<span id="cb331-8"><a href="multiple-regression.html#cb331-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sample2 =</span> <span class="fu">as.data.frame</span>(sample2))</span></code></pre></div>
<p>This is somewhat convoluted but the key takeaway is that if you want to use <code>cocor</code> to compare correlations, you need to ensure your data is in a list object and that may require the above transformation.</p>
<div id="compare-two-correlations-based-on-two-independent-groups" class="section level3" number="17.20.1">
<h3><span class="header-section-number">20.1</span> Compare two correlations based on two independent groups</h3>
<p>In this example we want to compare two correlations from two independent groups, i.e., where the participants involved in each correlation are completely different. Let’s run the correlations for the full dataset, and then for sample 1 and sample 2 separately.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="multiple-regression.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(full_dat<span class="sc">$</span>logic, full_dat<span class="sc">$</span>intelligence.a, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb332-2"><a href="multiple-regression.html#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(sample1<span class="sc">$</span>logic, sample1<span class="sc">$</span>intelligence.a, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb332-3"><a href="multiple-regression.html#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(sample2<span class="sc">$</span>logic, sample2<span class="sc">$</span>intelligence.a, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 	Pearson&#39;s product-moment correlation
## 
## data:  full_dat$logic and full_dat$intelligence.a
## t = 6.3039, df = 623, p-value = 5.497e-10
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.1697040 0.3172053
## sample estimates:
##      cor 
## 0.244871 
## 
## 
## 	Pearson&#39;s product-moment correlation
## 
## data:  sample1$logic and sample1$intelligence.a
## t = 5.7687, df = 289, p-value = 2.053e-08
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.2142758 0.4207744
## sample estimates:
##     cor 
## 0.32134 
## 
## 
## 	Pearson&#39;s product-moment correlation
## 
## data:  sample2$logic and sample2$intelligence.a
## t = 3.7665, df = 332, p-value = 0.0001958
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.09723082 0.30316175
## sample estimates:
##       cor 
## 0.2024331</code></pre>
<p>Here we can see that the correlations between logic scores and intelligence.a scores are significant overall and in both samples separately, however, the correlation for sample 1 is larger (r = .32) than for sample 2 (r = .20) and so we can compare these using <code>cocor</code>.</p>
<ul>
<li>The left-hand side of the formula (before the <code>|</code>) refers to variables in the first dataset in the list, the right-hand side of the formula (after the <code>|</code>) refers to variables in the second dataset in the list.</li>
<li>This comparison requires us to use the list object we created.</li>
</ul>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="multiple-regression.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cocor</span>(<span class="at">formula =</span> <span class="sc">~</span>logic <span class="sc">+</span> intelligence.a <span class="sc">|</span> logic <span class="sc">+</span> intelligence.a, </span>
<span id="cb334-2"><a href="multiple-regression.html#cb334-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> dat_list)</span></code></pre></div>
<pre><code>## 
##   Results of a comparison of two correlations based on independent groups
## 
## Comparison between r1.jk (logic, intelligence.a) = 0.3213 and r2.hm (logic, intelligence.a) = 0.2024
## Difference: r1.jk - r2.hm = 0.1189
## Data: sample1: j = logic, k = intelligence.a; sample2: h = logic, m = intelligence.a
## Group sizes: n1 = 291, n2 = 334
## Null hypothesis: r1.jk is equal to r2.hm
## Alternative hypothesis: r1.jk is not equal to r2.hm (two-sided)
## Alpha: 0.05
## 
## fisher1925: Fisher&#39;s z (1925)
##   z = 1.5869, p-value = 0.1125
##   Null hypothesis retained
## 
## zou2007: Zou&#39;s (2007) confidence interval
##   95% confidence interval for r1.jk - r2.hm: -0.0281 0.2637
##   Null hypothesis retained (Interval includes 0)</code></pre>
<p>The full paper by <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0121945#sec003">Diedenhofen and Musch (2015)</a> explains the output in detail, for our purposes, Fisher’s z-test tells us that our correlations are not significantly different (z = 1.59, p = .113) and Zou’s confidence intervals gives us the CI for the size of the difference between the two correlations (which at -0.0281 - 0.2637 is quite a range and so isn’t surprising that the two are not statistically different).</p>
<div id="visualising-two-groups-correlations" class="section level4" number="17.20.1.1">
<h4><span class="header-section-number">20.1.1</span> Visualising two groups correlations</h4>
<p>Rather than producing two separate scatterplots, it can be useful to display the data from bot groups on the same plot. For the dataset we have, this requires a little bit of wrangling first, if you have all the data from both groups in one object, you could skip step one.</p>
<ul>
<li>The <code>colour</code> argument tells <code>ggplot()</code> to draw the <code>geom_jitter()</code> and <code>geom_smooth()</code> in different colours for each level of <code>sample</code>.</li>
<li>We’re using <code>geom_jitter()</code> instead of <code>geom_point()</code> because many of the data points overlap - try changing it to <code>geom_point()</code> and see how it looks.</li>
<li></li>
</ul>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="multiple-regression.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(full_dat, <span class="fu">aes</span>(<span class="at">x =</span> logic, <span class="at">y =</span> intelligence.a, </span>
<span id="cb336-2"><a href="multiple-regression.html#cb336-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb336-3"><a href="multiple-regression.html#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb336-4"><a href="multiple-regression.html#cb336-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb336-5"><a href="multiple-regression.html#cb336-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb336-6"><a href="multiple-regression.html#cb336-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-9"></span>
<img src="appendix-0_files/figure-html/unnamed-chunk-9-1.png" alt="Scatterplot comparing correlation between two variables for two groups" width="100%" />
<p class="caption">
Figure 8.2: Scatterplot comparing correlation between two variables for two groups
</p>
</div>
</div>
</div>
<div id="compare-two-overlapping-correlations-based-on-two-dependent-groups" class="section level3" number="17.20.2">
<h3><span class="header-section-number">20.2</span> Compare two overlapping correlations based on two dependent groups</h3>
<p>In this example, we want to compare two correlations from two dependent groups (i.e., the participants are the same) and where one of the variables is also the same, i.e., it overlaps.</p>
<p>For example, let’s run all possible correlations for sample 2:</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="multiple-regression.html#cb338-1" aria-hidden="true" tabindex="-1"></a>sample2 <span class="sc">%&gt;%</span></span>
<span id="cb338-2"><a href="multiple-regression.html#cb338-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>(<span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">p.adjust.method =</span> <span class="st">&quot;holm&quot;</span>)</span></code></pre></div>
<pre><code>## 
## CORRELATIONS
## ============
## - correlation type:  pearson 
## - correlations shown only when both variables are numeric
## 
##                sample    knowledge    logic    intelligence.b   
## sample              .            .        .                 .   
## knowledge           .            .    0.031             0.129.  
## logic               .        0.031        .             0.201***
## intelligence.b      .        0.129.   0.201***              .   
## intelligence.a      .        0.116.   0.202***          0.643***
##                intelligence.a   
## sample                      .   
## knowledge               0.116.  
## logic                   0.202***
## intelligence.b          0.643***
## intelligence.a              .   
## 
## ---
## Signif. codes: . = p &lt; .1, * = p&lt;.05, ** = p&lt;.01, *** = p&lt;.001
## 
## 
## p-VALUES
## ========
## - total number of tests run:  6 
## - correction for multiple testing:  holm 
## 
##                sample knowledge logic intelligence.b intelligence.a
## sample              .         .     .              .              .
## knowledge           .         . 0.567          0.055          0.068
## logic               .     0.567     .          0.001          0.001
## intelligence.b      .     0.055 0.001              .          0.000
## intelligence.a      .     0.068 0.001          0.000              .
## 
## 
## SAMPLE SIZES
## ============
## 
##                sample knowledge logic intelligence.b intelligence.a
## sample            334       334   334            334            334
## knowledge         334       334   334            334            334
## logic             334       334   334            334            334
## intelligence.b    334       334   334            334            334
## intelligence.a    334       334   334            334            334</code></pre>
<p>We see that the correlations between <code>logic</code>, <code>intelligence.a</code> and <code>intelligence.b</code> are all significant. We can assess whether the correlation between <code>logic</code> and <code>intelligence.a</code> is strong than with <code>intelligence.b</code>.</p>
<ul>
<li>Note that the the <code>data</code> argument now specifies which dataset of the list to use. We could also have just used the <code>sample1</code> data that we extracted earlier.</li>
</ul>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="multiple-regression.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cocor</span>(<span class="at">formula =</span> <span class="sc">~</span>logic <span class="sc">+</span> intelligence.a <span class="sc">|</span> logic <span class="sc">+</span> intelligence.b,</span>
<span id="cb340-2"><a href="multiple-regression.html#cb340-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> dat_list<span class="sc">$</span>sample1)</span></code></pre></div>
<pre><code>## 
##   Results of a comparison of two overlapping correlations based on dependent groups
## 
## Comparison between r.jk (logic, intelligence.a) = 0.3213 and r.jh (logic, intelligence.b) = 0.2679
## Difference: r.jk - r.jh = 0.0534
## Related correlation: r.kh = 0.4731
## Data: dat_list$sample1: j = logic, k = intelligence.a, h = intelligence.b
## Group size: n = 291
## Null hypothesis: r.jk is equal to r.jh
## Alternative hypothesis: r.jk is not equal to r.jh (two-sided)
## Alpha: 0.05
## 
## pearson1898: Pearson and Filon&#39;s z (1898)
##   z = 0.9419, p-value = 0.3462
##   Null hypothesis retained
## 
## hotelling1940: Hotelling&#39;s t (1940)
##   t = 0.9422, df = 288, p-value = 0.3469
##   Null hypothesis retained
## 
## williams1959: Williams&#39; t (1959)
##   t = 0.9379, df = 288, p-value = 0.3491
##   Null hypothesis retained
## 
## olkin1967: Olkin&#39;s z (1967)
##   z = 0.9419, p-value = 0.3462
##   Null hypothesis retained
## 
## dunn1969: Dunn and Clark&#39;s z (1969)
##   z = 0.9370, p-value = 0.3487
##   Null hypothesis retained
## 
## hendrickson1970: Hendrickson, Stanley, and Hills&#39; (1970) modification of Williams&#39; t (1959)
##   t = 0.9422, df = 288, p-value = 0.3469
##   Null hypothesis retained
## 
## steiger1980: Steiger&#39;s (1980) modification of Dunn and Clark&#39;s z (1969) using average correlations
##   z = 0.9367, p-value = 0.3489
##   Null hypothesis retained
## 
## meng1992: Meng, Rosenthal, and Rubin&#39;s z (1992)
##   z = 0.9365, p-value = 0.3490
##   Null hypothesis retained
##   95% confidence interval for r.jk - r.jh: -0.0640 0.1811
##   Null hypothesis retained (Interval includes 0)
## 
## hittner2003: Hittner, May, and Silver&#39;s (2003) modification of Dunn and Clark&#39;s z (1969) using a backtransformed average Fisher&#39;s (1921) Z procedure
##   z = 0.9367, p-value = 0.3489
##   Null hypothesis retained
## 
## zou2007: Zou&#39;s (2007) confidence interval
##   95% confidence interval for r.jk - r.jh: -0.0583 0.1649
##   Null hypothesis retained (Interval includes 0)</code></pre>
<p>This produces a large number of tests, the mathematics of which are described in the <a href="https://cran.r-project.org/web/packages/cocor/cocor.pdf"><code>cocor</code> documentation.</a>. The <code>cocor</code> documentation suggests basing the decision on convergence - in this case all tests indicated the null hypothesis should be retained, i.e., the correlations are not significantly different. For the purposes of writing up such a comparison, [Silver, Hittner &amp; May (2004)]((<a href="https://www.tandfonline.com/doi/abs/10.3200/JEXE.71.1.53-70" class="uri">https://www.tandfonline.com/doi/abs/10.3200/JEXE.71.1.53-70</a>) suggest that Dunn &amp; Clark’s performs best so you can report that (z = .94, p = .349) as well as Zou’s confidence intervals.</p>
</div>
<div id="compare-two-non-overlapping-correlations-from-two-dependent-groups" class="section level3" number="17.20.3">
<h3><span class="header-section-number">20.3</span> Compare two non-overlapping correlations from two dependent groups</h3>
<p>The final comparison we could make is to compare two non-overlapping (none of the variables are the same) correlations from two dependent groups (the same sample).</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="multiple-regression.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cocor</span>(<span class="at">formula =</span> <span class="sc">~</span>logic <span class="sc">+</span> intelligence.b <span class="sc">|</span> knowledge <span class="sc">+</span> intelligence.a, </span>
<span id="cb342-2"><a href="multiple-regression.html#cb342-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> dat_list<span class="sc">$</span>sample1)</span></code></pre></div>
<pre><code>## 
##   Results of a comparison of two nonoverlapping correlations based on dependent groups
## 
## Comparison between r.jk (logic, intelligence.b) = 0.2679 and r.hm (knowledge, intelligence.a) = 0.1038
## Difference: r.jk - r.hm = 0.164
## Related correlations: r.jh = 0.0257, r.jm = 0.3213, r.kh = 0.1713, r.km = 0.4731
## Data: dat_list$sample1: j = logic, k = intelligence.b, h = knowledge, m = intelligence.a
## Group size: n = 291
## Null hypothesis: r.jk is equal to r.hm
## Alternative hypothesis: r.jk is not equal to r.hm (two-sided)
## Alpha: 0.05
## 
## pearson1898: Pearson and Filon&#39;s z (1898)
##   z = 2.0998, p-value = 0.0357
##   Null hypothesis rejected
## 
## dunn1969: Dunn and Clark&#39;s z (1969)
##   z = 2.0811, p-value = 0.0374
##   Null hypothesis rejected
## 
## steiger1980: Steiger&#39;s (1980) modification of Dunn and Clark&#39;s z (1969) using average correlations
##   z = 2.0755, p-value = 0.0379
##   Null hypothesis rejected
## 
## raghunathan1996: Raghunathan, Rosenthal, and Rubin&#39;s (1996) modification of Pearson and Filon&#39;s z (1898)
##   z = 2.0811, p-value = 0.0374
##   Null hypothesis rejected
## 
## silver2004: Silver, Hittner, and May&#39;s (2004) modification of Dunn and Clark&#39;s z (1969) using a backtransformed average Fisher&#39;s (1921) Z procedure
##   z = 2.0753, p-value = 0.0380
##   Null hypothesis rejected
## 
## zou2007: Zou&#39;s (2007) confidence interval
##   95% confidence interval for r.jk - r.hm: 0.0095 0.3162
##   Null hypothesis rejected (Interval does not include 0)</code></pre>
<p>Again the output produces a number of tests, although in this case they all converge on the conclusion that the null hypothesis should be rejected, i.e., the correlations are significantly different. Again following <a href="https://www.tandfonline.com/doi/abs/10.1080/00221300309601282">Silver et al.</a>, if you need to pick one to report, I’d suggest Dunn and Clark’s z with Zou’s confidence intervals.</p>
</div>
</div>
<div id="data-transformation" class="section level2" number="17.21">
<h2><span class="header-section-number">21</span> Data transformation</h2>
<p>This section has been adapted from materials made available by <a href="http://abacus.bates.edu/~ganderso/biology/bio270/homework_files/Data_Transformation.pdf">Greg Anderson at Bates College</a>.</p>
<p>The following brief overview of Data Transformation is compiled from Howell (pp. 318-324,
2007) and Tabachnick and Fidell (pp. 86-89, 2007). See the references at the end of this handout for a more complete discussion of data transformation. Most people find it difficult to accept the idea of transforming data. Tukey (1977) probably had the right idea when he called data transformation calculations “reexpressions” rather than “transformations.” A researcher is merely reexpressing what the data have to say in other terms. However, it is important to recognize that conclusions that you draw on transformed data do not always transfer neatly to the original measurements. Grissom (2000) reports that the means of transformed variables can occasionally reverse the difference of means of the original variables. While this is disturbing, and it is important to think about the meaning of what you are doing, but it is not, in itself, a reason to rule out the use of transformations as a viable option.</p>
<p>If you are willing to accept that is it permissible to transform one set of measures into another, then many possibilities become available for modifying the data to fit more closely the underlying assumptions of statistical tests. An added benefit about most of the transformations is that when we transform the data to meet one assumption, we often come closer to meeting other assumptions as well. For example, a square-root transformation may help equate group variances, and because it compresses the upper end of a distribution more than it compresses the lower end, it may also have the effect of making positively skewed distributions more nearly normal in shape. If you decide to transform, it is important to check that the variable is normally or nearly normally distributed after transformation. That is, make sure it worked.</p>
<p>When it comes to reporting our data… although it is legitimate and proper to run a statistical test, such as the one-way analysis of variance, on the transformed values, we often report means in the unit of the untransformed scale. This is especially true when the original units are intrinsically meaningful. Howell (2007) urges researchers to look at both the converted (transformed) and unconverted (original) means and make sure that they are telling the same basic story. Do not convert standard deviations – you will do serious injustice if you try that. And be sure to indicate to your readers what you have done. It is not uncommon to see both the converted and unconverted values reported. Tabachnick and Fidell (2007) point out that, although data transformations are recommended as a remedy for outliers and for failures of normality, linearity, and homoscedasticity, they are not universally recommended. The reason is that an analysis is interpreted from the variables that are in it, and transformed variables are sometimes harder to interpret.</p>
<p>You should not get the impression that data transformations should be applied routinely to all your data. As a rule of thumb, “If it’s not broken, don’t fix it.” If your data are reasonably distributed (i.e., are more or less symmetrical and have few, if any, outliers) and if your variances are reasonably homogeneous, there is probably nothing to be gained by applying a transformation. If you have markedly skewed data or heterogeneous variances, however, some form of data transformation may be useful. Furthermore, it is perfectly legitimate to shop around for a transformation that makes the necessary changes to the variance and shape. The only thing you should not do it to try out every transformation, looking for one that gives you a significant result. You are trying to optimize the data, not the resulting F.</p>
<p>As suggested by Tabachnick and Fidell (2007) and Howell (2007), the following guidelines
should be used when transforming data.</p>
<table>
<colgroup>
<col width="57%" />
<col width="23%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Problem</th>
<th align="left">Transformation</th>
<th align="left">R function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Moderately positive skewness</td>
<td align="left">Square-root</td>
<td align="left"><code>sqrt(var)</code></td>
</tr>
<tr class="even">
<td align="left">Substantially positive skewness</td>
<td align="left">Logarithmic (Log 10)</td>
<td align="left"><code>log10(var)</code></td>
</tr>
<tr class="odd">
<td align="left">Substantially positive skewness (with zero values)</td>
<td align="left">Logarithmic (Log 10)</td>
<td align="left"><code>log10(var + C)</code></td>
</tr>
<tr class="even">
<td align="left">Moderately negative skewness</td>
<td align="left">Square-Root</td>
<td align="left"><code>sqrt(var + K)</code></td>
</tr>
<tr class="odd">
<td align="left">Substantially negative skewness</td>
<td align="left">Logarithmic (Log 10)</td>
<td align="left"><code>log10(K - var)</code></td>
</tr>
</tbody>
</table>
<p><code>C</code> = a constant added to each score so that the smallest score is 1.<br />
<code>K</code> = a constant from which each score is subtracted so that the smallest score is 1; usually equal to the largest score + 1.</p>
<p><strong>References</strong></p>
<p>Howell, D. C. (2007). Statistical methods for psychology (6th ed.). Belmont, CA: Thomson
Wadsworth.<br />
Grissom, R. J. (2000). Heterogeneity of variance in clinical data. <em>Journal of Consulting and Clinical Psychology, 68</em>, 155-165.<br />
Tabachnick, B. G., &amp; Fidell, L. S. (2007). <em>Using multivariate statistics (5th ed.)</em>. Boston: Allyn and Bacon.<br />
Tukey, J. W. (1977). <em>Exploratory data analysis</em>. Reading, MA: Addison-Wesley.</p>
<p>Also see:</p>
<p>Hoaglin, D. C., Mosteller, F., &amp; Tukey, J. W. (1983). <em>Understanding robust and exploratory data analysis</em>. New York: Wiley.</p>
</div>
<div id="permutation-tests" class="section level2" number="17.22">
<h2><span class="header-section-number">22</span> Permutation tests</h2>
<p>This section has been adapated from the Level 2 class on permutation tests written by Dr. Phil McAleer. The original <a href="https://psyteachr.github.io/ug2-practical/permutation-tests-a-skill-set.html">can be viewed here</a>.</p>
<div id="overview" class="section level3" number="17.22.1">
<h3><span class="header-section-number">22.1</span> Overview</h3>
<p>In this week’s lab you will perform your first hypothesis test using a procedure known as a <strong>permutation test</strong>. We will help you learn how to do this through building and running data simulation procedures. In order to complete this lab you will require the following skills which we will teach you today:</p>
<ul>
<li>Skill 1: Generating random numbers with <code>base::rnorm()</code></li>
<li>Skill 2: Permuting values with <code>base::sample()</code><br />
</li>
<li>Skill 3: Creating a “tibble” (a type of data table) using <code>tibble::tibble()</code></li>
<li>Skill 4: Computing and extracting a difference in group means using <code>dplyr::pull()</code> and <code>purrr::pluck()</code></li>
<li>Skill 5: Creating your own custom functions using <code>base::function()</code></li>
<li>Skill 6: Repeating operations using <code>base::replicate()</code></li>
</ul>
<p>To many, a lot of statistics must seem a bit like blind faith as it deals with estimating quantities we haven’t observed (or can’t observe), e.g. the mean of a whole population. As such we have to know if we can trust our procedures for making estimations and inferences because we rarely get a chance to compare the estimated values to the true values to see if they match up. One way to test a procedure, and in turn learn about statistics, is through data simulation. In simulations <strong>we create</strong> a population and then draw samples and run tests on the data, i.e. on this <strong>known</strong> population. By running lots of simulations we can test our procedures and make sure they are acting as we expect them to. This approach is known as a <strong>Monte Carlo simulation</strong>, named after the city famous for the many games of chance that are played there.</p>
<div class="info">
<p>
You can go read up on the Monte Carlo approach if you like. It can however get quite indepth, as having a brief glance at the wikipedia entry on it highlights. The main thing to keep in mind is that the method involves creating a population and continually taking samples from that population in order to make an inference. This is what we will show you in the lab. Data simulation and “creating” your own datasets, to see how tests work, is a great way to understand statistics. When doing this lab, keep in mind how easy it really is to find a significant result if even randomly created data can give a significant result. This may help dispell any notion that there is something inherently important about a significant result, in itself.
</p>
</div>
<p>We will now take each skill in turn. Be sure to try them all out. It looks a lot of reading but it is mainly just showing you the output of the functions so you can see you are doing it correctly. The key thing is to try them yourselves and don’t be scared to change things to see what might happen if you do it slightly differently. We will also ask a couple of questions along the way to make sure you understand the skills.</p>
</div>
<div id="skill-1-generating-random-numbers" class="section level3" number="17.22.2">
<h3><span class="header-section-number">22.2</span> Skill 1: Generating Random Numbers</h3>
<p>The <code>base::rnorm()</code> function generates values from a normal distribution and takes the following arguments:</p>
<ul>
<li><code>n</code>: the number of observations to generate</li>
<li><code>mean</code>: the mean of the distribution (default 0)</li>
<li><code>sd</code> : the standard deviation of the distribution (default 1)</li>
</ul>
<p>To generate 10 or even 50 random numbers from a standard normal distribution (M = 0, SD = 1), you would use <code>rnorm(10)</code> or <code>rnorm(50)</code> respectively.</p>
<ul>
<li>Type <code>rnorm(50)</code> into your console and see what happens. Use the below example for <code>rnorm(10)</code> to help you.<br />
</li>
<li>Try increasing <code>n</code> to 1000.</li>
</ul>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="multiple-regression.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1]  0.4107336 -2.3137465 -0.4567339 -1.1958743 -0.6091073  0.9734550
##  [7] -1.6631409 -0.2289093 -0.7833809 -0.6083957</code></pre>
<p><br>
<span style="font-size: 22px; font-weight: bold; color: var(--green);">Quickfire Questions</span></p>
<p>If you enter <code>rnorm(50)</code> again you will get different numbers. Why? <select class='solveme' data-answer='["The numbers are random"]'> <option></option> <option>I have made a mistake</option> <option>The numbers are random</option> <option>R has made a mistake</option> <option>Phil has made a mistake</option></select></p>
<p>If you want to change the mean or sd, you would need to pass additional arguments to the function as shown below.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="multiple-regression.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> .<span class="dv">5</span>)</span></code></pre></div>
<ul>
<li>Try changing the mean and sd values a couple of times and see what happens. You get different numbers again that will be around the mean you set! Set a mean of 10, then a mean of 100, to test this.</li>
</ul>
<p>Finally, for this Skill, you can concatenate (i.e. link) numbers together into a single vector using the <code>c()</code> function from base R. For instance, say you wanted to create a vector with two sets of 50 random numbers from two separate samples: one set of 50 with a mean of 75 and the other with a mean of 90, you would use:</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="multiple-regression.html#cb347-1" aria-hidden="true" tabindex="-1"></a>random_numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">75</span>),</span>
<span id="cb347-2"><a href="multiple-regression.html#cb347-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">90</span>))</span></code></pre></div>
<p><span style="font-size: 22px; font-weight: bold; color: var(--green);">Quickfire Questions</span></p>
<p>In the above example code, what is the standard deviation of the two samples you have created? <select class='solveme' data-answer='["1"]'> <option></option> <option>50</option> <option>75</option> <option>90</option> <option>1</option></select></p>
<div class="solution">
<button>
Explain This - I don’t get this answer!
</button>
<div class="info">
<p>
What is the <strong>default</strong> sd of the function?
</p>
<p>
Both populations would have an sd of 1, because that is the default, although you could easily change that. Try it out!
</p>
</div>
</div>
<p><br>
It is always good to check that your new vector has the right number of data points in it - i.e. the total of the two samples; a sanity check if you will. The new vector <code>random_numbers</code> should have 100 elements. You could verify this using the <code>length()</code> function:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="multiple-regression.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(random_numbers)</span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p><br></p>
</div>
<div id="skill-2-permuting-values" class="section level3" number="17.22.3">
<h3><span class="header-section-number">22.3</span> Skill 2: Permuting Values</h3>
<p>Another thing that is useful to be able to do is to generate <strong>permutations</strong> of values.</p>
<div class="solution">
<button>
Portfolio Point - What are Permutations?
</button>
<div class="info">
<p>
A <strong>permutation</strong> is just a different ordering of the same values. For example, the numbers 1, 2, 3 can be permuted into the following 6 sequences:
</p>
<ul>
<li>
1, 2, 3
</li>
<li>
1, 3, 2
</li>
<li>
2, 1, 3
</li>
<li>
2, 3, 1
</li>
<li>
3, 1, 2
</li>
<li>
3, 2, 1
</li>
</ul>
<p>
The more values you have, the more permutations of the order you have. The number of permutations can be calculated by, for example, <code>3<em>2</em>1</code>, where 3 is the number of values you have. Or through code: <code>factorial(3) = 6</code>. This assumes that each value is used once in the sequence and that each value never changes, i.e. 1234 cannot suddenly become 1235.
</p>
</div>
</div>
<p>We can create random permutations of a vector using the <code>sample()</code> function. Let’s use one of R’s built in vectors: <code>letters</code>.</p>
<ul>
<li>Type <code>letters</code> into the console, as below, and press RETURN/ENTER. You will see it contains all the lowercase letters of the English alphabet. Now, I bet you are wondering what <code>LETTERS</code> does, right?</li>
</ul>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="multiple-regression.html#cb350-1" aria-hidden="true" tabindex="-1"></a>letters</span></code></pre></div>
<pre><code>##  [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; &quot;j&quot; &quot;k&quot; &quot;l&quot; &quot;m&quot; &quot;n&quot; &quot;o&quot; &quot;p&quot; &quot;q&quot; &quot;r&quot; &quot;s&quot;
## [20] &quot;t&quot; &quot;u&quot; &quot;v&quot; &quot;w&quot; &quot;x&quot; &quot;y&quot; &quot;z&quot;</code></pre>
<p>We can combine <code>base::sample()</code> with <code>letters</code> to put the letters into a random order:</p>
<ul>
<li>Run the below line. Run it again. And again. What do you notice? And why is our output different from yours? (The answer is below)</li>
</ul>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="multiple-regression.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(letters)</span></code></pre></div>
<pre><code>##  [1] &quot;r&quot; &quot;p&quot; &quot;e&quot; &quot;z&quot; &quot;y&quot; &quot;l&quot; &quot;w&quot; &quot;g&quot; &quot;h&quot; &quot;k&quot; &quot;v&quot; &quot;u&quot; &quot;a&quot; &quot;m&quot; &quot;q&quot; &quot;n&quot; &quot;i&quot; &quot;o&quot; &quot;b&quot;
## [20] &quot;t&quot; &quot;s&quot; &quot;x&quot; &quot;j&quot; &quot;d&quot; &quot;c&quot; &quot;f&quot;</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: var(--green);">Quickfire Questions</span></p>
<p>If <code>month.name</code> contains the names of the twelve months of the year, how many possible permutations are there of <code>sample(month.name)</code>? <select class='solveme' data-answer='["479001600"]'> <option></option> <option>1</option> <option>12</option> <option>144</option> <option>479001600</option></select></p>
<div class="solution">
<button>
Portfolio Point - Different samples with sample()
</button>
<div class="info">
<p>
Each time you run <code>sample(letters)</code> it will give you another random permutation of the sequence. That is what <code>sample()</code> does - creates a random permutation of the values you give it. Try repeating this command many times in the console. Because there are so many possible sequences, it is very unlikely that you will ever see the same sequence twice!
</p>
<p>
An interesting thing about <code>sample()</code> is that <code>sample(c(1,2,3,4))</code> is the same as <code>sample(4)</code>. And to recap, there would be 24 different permutations based on <code>factorial(4)</code>, meaning that each time you type <code>sample(4)</code> you are getting one of those 24 different orders. So what would factorial(12) be?
</p>
<p>
Top Tip: Remember that you can scroll up through your command history in the console using the up arrow on your keyboard; this way, you don’t ever have to retype a command you’ve already entered.
</p>
</div>
</div>
<p><br></p>
</div>
<div id="skill-3-creating-tibbles" class="section level3" number="17.22.4">
<h3><span class="header-section-number">22.4</span> Skill 3: Creating Tibbles</h3>
<p>Tables are important because most of the data we want to analyze comes in a table, i.e. tabular form. There are different ways to get tabular data into R for analysis. One common way is to load existing data in from a data file (for example, using <code>readr::read_csv()</code> which you have seen before). But other times you might want to just type in data directly. You can do this using the <code>tibble::tibble()</code> function. Being able to create a tibble is a useful data analysis skill because sometimes you will want to create some data on the fly just to try certain codes or functions.</p>
</div>
<div id="entering-data-into-a-tibble" class="section level3" number="17.22.5">
<h3><span class="header-section-number">22.5</span> Entering Data into a Tibble</h3>
<p>The <code>tibble()</code> function takes named arguments - this means that the name you give each argument within the tibble function, e.g. <code>Y = rnorm(10)</code> will be the name of the column that appears in the table, i.e. <code>Y</code>. It’s best to see how it works through an example.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="multiple-regression.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Y =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span></code></pre></div>
<pre><code>## # A tibble: 10 x 1
##         Y
##     &lt;dbl&gt;
##  1  0.443
##  2  0.535
##  3 -1.01 
##  4  0.141
##  5 -2.48 
##  6 -0.246
##  7  1.54 
##  8  1.23 
##  9 -1.50 
## 10 -0.739</code></pre>
<p>The above command creates a new table with one column named <code>Y</code>, and the values in that column are the result of a call to <code>rnorm(10)</code>: 10 randomly sampled values from a standard normal distribution (mean = 0, sd = 1) - See Skill 1.</p>
<p>If however we wanted to sample from two different populations for <code>Y</code>, we could combine two calls to <code>rnorm()</code> within the <code>c()</code> function. Again this was in Skill 1, here we are now just storing it in a tibble. See below:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="multiple-regression.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">10</span>), </span>
<span id="cb356-2"><a href="multiple-regression.html#cb356-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span>  <span class="dv">20</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 10 x 1
##         Y
##     &lt;dbl&gt;
##  1 -11.5 
##  2 -10.1 
##  3 -10.6 
##  4  -8.64
##  5 -11.1 
##  6  21.9 
##  7  17.9 
##  8  19.9 
##  9  17.5 
## 10  20.5</code></pre>
<p>Now we have sampled a total of 10 observations - the first 5 come from a group with a mean of -10, and the second 5 come from a group with a mean of 20. Try changing the values in the above example to get an idea of how this works. Maybe even add a third group!</p>
<p>But, of course, it would be good to know which population each data point refers to and so we should add some group names. We can do this with some additional trickery using the <code>rep()</code> function.</p>
</div>
<div id="repeating-values-to-save-typing" class="section level3" number="17.22.6">
<h3><span class="header-section-number">22.6</span> Repeating Values to Save Typing</h3>
<p>Before finalising our table let’s learn a little about the base R function, <code>rep()</code>. This is most useful for automatically repeating values in order to save typing. For instance, if we wanted 20 letter “A”s in a row, we would type:</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="multiple-regression.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">20</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot;
## [20] &quot;A&quot;</code></pre>
<p>The first argument to <code>rep()</code> is the vector containing the information you want repeated, <strong>A</strong>, and the second argument, <code>times</code>, is the number of times to repeat it; in this case <strong>20</strong>.</p>
<p>If you wanted to add more information, e.g. if the first argument has more than one element, say “A” and “B,” it will repeat the entire vector that number of times; A B, A B, A B, … . Note that we enclose “A” and “B” in the <code>c()</code> function so that it is seen as a single argument.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="multiple-regression.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="dv">20</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot;
## [20] &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;B&quot;
## [39] &quot;A&quot; &quot;B&quot;</code></pre>
<p>But sometimes we want a specific number of As followed by a specific number of Bs; A A A B B B. If the <code>times</code> argument has the same number of elements as the vector given for the first argument, it will repeat each element of the first vector as many times as given by the corresponding element in the <code>times</code> vector. In other words, for example, <code>times = c(2, 4)</code> for vector <code>c("A", "B")</code> will give you 2 As followed by 4 Bs.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="multiple-regression.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] &quot;A&quot; &quot;A&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot;</code></pre>
<p>The best way to learn about this function is to play around with it in the console and see what happens. From the dropdown menus, the correct output of the following function would be:</p>
<ol style="list-style-type: decimal">
<li><p><code>rep(c("A", "B", "C"),(2, 3, 1))</code> - <select class='solveme' data-answer='["A A B B B C"]'> <option></option> <option>A A A B B C</option> <option>A A B B B C</option> <option>A A B B C C</option> <option>A B C A B C</option></select></p></li>
<li><p><code>rep(1:5, 5:1)</code> - <select class='solveme' data-answer='["1 1 1 1 1 2 2 2 2 3 3 3 4 4 5"]'> <option></option> <option>1 2 3 4 5 1 2 3 4 5 1 2 3 4 5</option> <option>5 5 5 5 5 4 4 4 4 3 3 3 2 2 1</option> <option>1 1 1 1 1 2 2 2 2 3 3 3 4 4 5</option> <option>1 1 1 1 1 1 1 1 5 5 5 5 5 5 5</option></select></p></li>
</ol>
</div>
<div id="bringing-it-together-in-a-tibble" class="section level3" number="17.22.7">
<h3><span class="header-section-number">22.7</span> Bringing it Together in a Tibble</h3>
<p>Now we know <code>rep()</code>, we can complete our table of simulated data by combining what we’ve learned about generating random numbers and repeating values. We want our table to look like this:</p>
<pre><code>## # A tibble: 10 x 2
##    group      Y
##    &lt;chr&gt;  &lt;dbl&gt;
##  1 A      -9.61
##  2 A     -10.2 
##  3 A      -9.84
##  4 A      -9.28
##  5 A      -8.95
##  6 B      19.9 
##  7 B      19.3 
##  8 B      20.0 
##  9 B      20.0 
## 10 B      19.1</code></pre>
<p>You now know how to create this table. Have a look at the code below and make sure you understand it. We have one column called <code>group</code> where we create <strong>A</strong>s and <strong>B</strong>s through <code>rep()</code>, and one column called <strong>Y</strong>, our data, all in our <code>tibble()</code>:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="multiple-regression.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>)),</span>
<span id="cb365-2"><a href="multiple-regression.html#cb365-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">Y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">10</span>), <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span>  <span class="dv">20</span>)))</span></code></pre></div>
<p>Be sure to play around with the code chunk to get used to it. Try adding a third group or even a third column? Perhaps you want to give every participant a random age with a mean of 18, and a sd of 1; or even a participant number.</p>
<div class="solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
Try <code>row_number()</code> to create participant numbers.
</p>
</div>
</div>
<p><br>
Don’t forget, if you wanted to store your tibble, you would just assign it to a name, such as <code>my_data</code>:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="multiple-regression.html#cb366-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">ID =</span> <span class="fu">row_number</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), </span>
<span id="cb366-2"><a href="multiple-regression.html#cb366-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>)),</span>
<span id="cb366-3"><a href="multiple-regression.html#cb366-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">10</span>), <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span>  <span class="dv">20</span>)),</span>
<span id="cb366-4"><a href="multiple-regression.html#cb366-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Age =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">18</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><br>
<span style="font-size: 18px; font-weight: bold; color: var(--blue);">Skill 3 out of 6 Complete!</span></p>
</div>
<div id="skill-4-computing-differences-in-group-means" class="section level3" number="17.22.8">
<h3><span class="header-section-number">22.8</span> Skill 4: Computing Differences in Group Means</h3>
<p>You have already learned how to calculate group means using <code>group_by()</code> and <code>summarise()</code>. For example, you might want to calculate sample means for a randomly generated dataset like so:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="multiple-regression.html#cb367-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>)),</span>
<span id="cb367-2"><a href="multiple-regression.html#cb367-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,  <span class="dv">20</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="sc">-</span><span class="dv">20</span>, <span class="dv">5</span>)))</span>
<span id="cb367-3"><a href="multiple-regression.html#cb367-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-4"><a href="multiple-regression.html#cb367-4" aria-hidden="true" tabindex="-1"></a>my_data_means <span class="ot">&lt;-</span> my_data <span class="sc">%&gt;%</span></span>
<span id="cb367-5"><a href="multiple-regression.html#cb367-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb367-6"><a href="multiple-regression.html#cb367-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">m =</span> <span class="fu">mean</span>(Y))</span>
<span id="cb367-7"><a href="multiple-regression.html#cb367-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-8"><a href="multiple-regression.html#cb367-8" aria-hidden="true" tabindex="-1"></a>my_data_means</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   group     m
##   &lt;chr&gt; &lt;dbl&gt;
## 1 A      19.8
## 2 B     -18.9</code></pre>
<p>Sometimes what we want though is to calculate <strong>the differences between means</strong> rather than just the means; so we’d like to subtract the second group mean -18.9 from the first group mean of 19.8, to get a single value, the difference: 38.7.</p>
<p>We can do this using the <code>dplyr::pull()</code> and <code>purrr::pluck()</code> functions. <code>pull()</code> will extract a single column from a dataframe and turn it into a vector. <code>pluck()</code> then allows you to pull out an element (i.e. a value or values) from within that vector.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="multiple-regression.html#cb369-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> my_data_means <span class="sc">%&gt;%</span></span>
<span id="cb369-2"><a href="multiple-regression.html#cb369-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(m)</span>
<span id="cb369-3"><a href="multiple-regression.html#cb369-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-4"><a href="multiple-regression.html#cb369-4" aria-hidden="true" tabindex="-1"></a>vec</span></code></pre></div>
<pre><code>## [1]  19.77509 -18.91037</code></pre>
<p>We have now created <code>vec</code> which is a vector containing only the group means; the rest of the information in the table has been discarded. Now that we have <code>vec</code>, we can calculate the mean difference as below, where <code>vec</code> is our vector of the two means and <code>[1]</code> and <code>[2]</code> refer to the two means:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="multiple-regression.html#cb371-1" aria-hidden="true" tabindex="-1"></a>vec[<span class="dv">1</span>] <span class="sc">-</span> vec[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 38.68546</code></pre>
<p>But <code>pluck()</code> is also useful, and can be written as so:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="multiple-regression.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pluck</span>(vec, <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">pluck</span>(vec, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 38.68546</code></pre>
<p>It can also be incorporated into a pipeline as below where we still <code>pull()</code> the means column, <code>m</code>, and then <code>pluck()</code> each value in turn and subtract them from each other.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="multiple-regression.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="do">## whole thing in a pipeline</span></span>
<span id="cb375-2"><a href="multiple-regression.html#cb375-2" aria-hidden="true" tabindex="-1"></a>my_data_means <span class="sc">%&gt;%</span> <span class="fu">pull</span>(m) <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">1</span>) <span class="sc">-</span></span>
<span id="cb375-3"><a href="multiple-regression.html#cb375-3" aria-hidden="true" tabindex="-1"></a>  my_data_means <span class="sc">%&gt;%</span> <span class="fu">pull</span>(m) <span class="sc">%&gt;%</span> <span class="fu">pluck</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 38.68546</code></pre>
<p>However, there is an alternative way to extract the difference between means which may make more intuitive sense. You already know how to calculate a difference between values in the same row of a table using <code>dplyr::mutate()</code>, e.g. <code>mutate(new_column = column1 minus column2)</code>. So if you can get the observations in <code>my_data_means</code> into the same row, different columns, you could then use <code>mutate()</code> to calculate the difference. Previously you learned <code>gather()</code> to bring columns together. Well the opposite of gather is the <code>tidyr::spread()</code> function to split columns apart - as below.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="multiple-regression.html#cb377-1" aria-hidden="true" tabindex="-1"></a>my_data_means <span class="sc">%&gt;%</span></span>
<span id="cb377-2"><a href="multiple-regression.html#cb377-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(group, m)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##       A     B
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  19.8 -18.9</code></pre>
<p>The spread function (<code>?spread</code>) splits the data in column <code>m</code> by the information, i.e. labels, in column <code>group</code> and puts the data into separate columns. A call to <code>spread()</code> followed by a <code>mutate()</code> can be used to calculate the difference in means - see below:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="multiple-regression.html#cb379-1" aria-hidden="true" tabindex="-1"></a>my_data_means <span class="sc">%&gt;%</span></span>
<span id="cb379-2"><a href="multiple-regression.html#cb379-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(group, m) <span class="sc">%&gt;%</span></span>
<span id="cb379-3"><a href="multiple-regression.html#cb379-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> A <span class="sc">-</span> B) </span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##       A     B  diff
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  19.8 -18.9  38.7</code></pre>
<ul>
<li>What is the name of the column containing the differences between the means of A and B? <select class='solveme' data-answer='["diff"]'> <option></option> <option>means</option> <option>group</option> <option>m</option> <option>diff</option></select></li>
</ul>
<p>Finally, if you then wanted to just get <code>diff</code> and throw away everything else in the table:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="multiple-regression.html#cb381-1" aria-hidden="true" tabindex="-1"></a>my_data_means <span class="sc">%&gt;%</span></span>
<span id="cb381-2"><a href="multiple-regression.html#cb381-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(group, m) <span class="sc">%&gt;%</span></span>
<span id="cb381-3"><a href="multiple-regression.html#cb381-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> A <span class="sc">-</span> B) <span class="sc">%&gt;%</span></span>
<span id="cb381-4"><a href="multiple-regression.html#cb381-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(diff)</span></code></pre></div>
<pre><code>## [1] 38.68546</code></pre>
<div class="solution">
<button>
Portfolio Point - Reading pipes and verbalising tasks
</button>
<div class="info">
<p>
Keep in mind that a very useful technique for establishing what you want to do to a dataframe is to verbalise what you need, or to write it down in words, or to say it out loud. Take this last code chunk. What we wanted to do was to <code>spread()</code> the data in <code>m</code> into the groups A and B. Then we wanted to <code>mutate()</code> a new column that is the difference, <code>diff</code>, of A minus B. And finally we wanted to <code>pull()</code> out the value in <code>diff</code>.
</p>
<p>
Often step 1 of writing code or understanding code is knowing what it is you want to do in the first place. After that you just need the correct functions. Fortunately for us a lot of the <code>tidyverse</code> names its functions based on what they specifically do!
</p>
</div>
</div>
<p><br></p>
</div>
<div id="skill-5-creating-your-own-functions" class="section level3" number="17.22.9">
<h3><span class="header-section-number">22.9</span> Skill 5: Creating Your Own Functions</h3>
<p>In Skills 1 to 4, we have looked at creating and sampling data, storing it in a tibble, and extracting information from that tibble. Now say we wanted to do this over and over again. For instance, we might want to generate 100 random datasets just like the one in Skill 4. It would be a pain to have to type out the <code>tibble()</code> function 100 times or even to copy and paste it 100 times. We’d likely make an error somewhere and it would be hard to read. To help us, we can create a custom function that performs the action you want; in our case, creating a tibble of random data.</p>
<p>Remember, a function is just a procedure that takes an input and gives you the same output each time - like a toaster! A function has the following format:</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="multiple-regression.html#cb383-1" aria-hidden="true" tabindex="-1"></a>name_of_function <span class="ot">&lt;-</span> <span class="cf">function</span>(arg1, arg2, arg3) {</span>
<span id="cb383-2"><a href="multiple-regression.html#cb383-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## body of function goes between these curly brackets; i.e. what the function does for you.</span></span>
<span id="cb383-3"><a href="multiple-regression.html#cb383-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Note that the last value calculated will be returned if you call the function.</span></span>
<span id="cb383-4"><a href="multiple-regression.html#cb383-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>First you define your own function name (e.g. <code>name_of_function</code>) and define the names of the arguments it will take (<code>arg1</code>, <code>arg2</code>, …) - an argument is the information that you feed into your function, e.g. data. Finally, you state the calculations or actions of the function in the body of the function (the portion that appears between the curly braces).</p>
<p>One of the most basic possible functions is one that takes no arguments and just prints a message. Here is an example:</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="multiple-regression.html#cb384-1" aria-hidden="true" tabindex="-1"></a>hello <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb384-2"><a href="multiple-regression.html#cb384-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Hello World!&quot;</span>)</span>
<span id="cb384-3"><a href="multiple-regression.html#cb384-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>So this function is called <code>hello</code>. It can be run by typing <code>hello()</code> in your console and it will give the output of <code>Hello World!</code> every single time you run it; it has no other actions or information. Test this in the console now by typing:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="multiple-regression.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hello</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Hello World!&quot;</code></pre>
<p>Awesome right? Ok, so not very exciting. Let’s make it better by adding an argument, <code>name</code>, and have it say Hello to <code>name</code>.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="multiple-regression.html#cb387-1" aria-hidden="true" tabindex="-1"></a>hello <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">name =</span> <span class="st">&quot;World!&quot;</span>) {</span>
<span id="cb387-2"><a href="multiple-regression.html#cb387-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">&quot;Hello&quot;</span>, name)</span>
<span id="cb387-3"><a href="multiple-regression.html#cb387-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This new function is again called <code>hello()</code> and replaces the one you previously created. This time however you are supplying what is called a default argument, `name = “World!” but it still has the same action as the previous function of putting “Hello” and “World!” together. So if you run it you get “Hello World!” Try it yourself!</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="multiple-regression.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hello</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Hello World!&quot;</code></pre>
<p>The difference this time however is that because you have added an argument to the input, you can change the information you give the argument and therefore change the output of the function. More flexible. More exciting.</p>
<p><span style="font-size: 22px; font-weight: bold; color: var(--green);">Quickfire Questions</span></p>
<p>Test your understanding by answering these questions:</p>
<ul>
<li><p>Typing <code>hello("Phil")</code> in the console with this new function will give: <select class='solveme' data-answer='["Hello Phil"]'> <option></option> <option>Hello Heather</option> <option>Hello Phil</option> <option>Hello Niamh</option> <option>Hello Kevin</option></select></p></li>
<li><p>Typing the argument as <code>"is it me you are looking for"</code> will give: <select class='solveme' data-answer='["Hello is it me you are looking for"]'> <option></option> <option>Hello is it me you are looking for</option> <option>I just called to say Hello</option> <option>You had me at Hello</option> <option>Hello seems to be the hardest word</option></select></p></li>
<li><p>What argument would you type to get “Hello Dolly!” as the output: <select class='solveme' data-answer='["Dolly!"]'> <option></option> <option>Dolly</option> <option>Molly</option> <option>Holly</option> <option>Dolly!</option></select></p></li>
</ul>
<p>Most of the time however we want to create a function that computes a value or constructs a table. For instance, let’s create a function that returns randomly generated data from two samples, as we learned in the previous skills - see below. All we are doing is taking the tibble we created in Skill 4 and putting it in the body (between the curly brackets) of the function.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="multiple-regression.html#cb390-1" aria-hidden="true" tabindex="-1"></a>gen_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb390-2"><a href="multiple-regression.html#cb390-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">20</span>)),</span>
<span id="cb390-3"><a href="multiple-regression.html#cb390-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,  <span class="dv">20</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="sc">-</span><span class="dv">20</span>, <span class="dv">5</span>)))</span>
<span id="cb390-4"><a href="multiple-regression.html#cb390-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This function is called <code>gen_data()</code> and when we run it we get a randomly generated table of two groups, each with 20 people, one with M = 20, SD = 5, the other with M = -20, sd = 5. Try running this <code>gen_data()</code> function in the console a few times; remember that as the data is random, the numbers will be different each time you run it.</p>
<p>But say we want to modify the function to allow us to get a table with smaller or larger numbers of observations per group. We can add an argument <code>n</code> and modify the code as follows. Create this function and run it a couple of times through <code>gen_data()</code>. The way to think about this is that every place that <code>n</code> appears in the body of the function (between the curly brackets) it will have the value of whatever you gave it in the arguments, i.e. in this case, 20.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="multiple-regression.html#cb391-1" aria-hidden="true" tabindex="-1"></a>gen_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">20</span>) {</span>
<span id="cb391-2"><a href="multiple-regression.html#cb391-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(n, n)),</span>
<span id="cb391-3"><a href="multiple-regression.html#cb391-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n,  <span class="dv">20</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(n, <span class="sc">-</span><span class="dv">20</span>, <span class="dv">5</span>)))</span>
<span id="cb391-4"><a href="multiple-regression.html#cb391-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li><p>How many total participants would there be if you ran <code>gen_data(2)</code>? <select class='solveme' data-answer='["4"]'> <option></option> <option>2</option> <option>4</option> <option>20</option> <option>40</option></select></p></li>
<li><p>What would you type to get 100 participants per group? <select class='solveme' data-answer='["gen_data(100)"]'> <option></option> <option>gen_data(50)</option> <option>gen_data(10)</option> <option>gen_dota(100)</option> <option>gen_data(100)</option></select></p></li>
</ul>
<p><strong>Challenge Question:</strong></p>
<p>Keeping in mind that functions can take numerous arguments, and that each group in your function have separate means, can you modify the function <code>gen_data</code> to allow the user to change the means for the two calls to <code>rnorm</code>? Have a try before revealing the solution below.</p>
<div class="solution">
<button>
Solution To Challenge Question
</button>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="multiple-regression.html#cb392-1" aria-hidden="true" tabindex="-1"></a>gen_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">m1 =</span> <span class="dv">20</span>, <span class="at">m2 =</span> <span class="sc">-</span><span class="dv">20</span>) {</span>
<span id="cb392-2"><a href="multiple-regression.html#cb392-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(n, n)),</span>
<span id="cb392-3"><a href="multiple-regression.html#cb392-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n,  m1, <span class="dv">5</span>), <span class="fu">rnorm</span>(n, m2, <span class="dv">5</span>)))</span>
<span id="cb392-4"><a href="multiple-regression.html#cb392-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb392-5"><a href="multiple-regression.html#cb392-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-6"><a href="multiple-regression.html#cb392-6" aria-hidden="true" tabindex="-1"></a><span class="co"># m1 is the mean of group A, </span></span>
<span id="cb392-7"><a href="multiple-regression.html#cb392-7" aria-hidden="true" tabindex="-1"></a><span class="co"># m2 is mean of group B and would look like:</span></span>
<span id="cb392-8"><a href="multiple-regression.html#cb392-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-9"><a href="multiple-regression.html#cb392-9" aria-hidden="true" tabindex="-1"></a><span class="co"># The function would be called by: gen_data(20, 20, -20)</span></span>
<span id="cb392-10"><a href="multiple-regression.html#cb392-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Giving 20 participants in each group, </span></span>
<span id="cb392-11"><a href="multiple-regression.html#cb392-11" aria-hidden="true" tabindex="-1"></a><span class="co"># The first group having a mean of 20, </span></span>
<span id="cb392-12"><a href="multiple-regression.html#cb392-12" aria-hidden="true" tabindex="-1"></a><span class="co"># The second group having a mean of -20. </span></span>
<span id="cb392-13"><a href="multiple-regression.html#cb392-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-14"><a href="multiple-regression.html#cb392-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Likewise, a call of: gen_data(4, 10, 5)</span></span>
<span id="cb392-15"><a href="multiple-regression.html#cb392-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Would give two groups of 4, </span></span>
<span id="cb392-16"><a href="multiple-regression.html#cb392-16" aria-hidden="true" tabindex="-1"></a><span class="co"># The first having a mean of 10, </span></span>
<span id="cb392-17"><a href="multiple-regression.html#cb392-17" aria-hidden="true" tabindex="-1"></a><span class="co"># The second having a mean of 5.</span></span></code></pre></div>
</div>
<div class="solution">
<button>
Portfolio Point - Two important facts about functions
</button>
<div class="info">
<p>
Here are two important things to understand about functions.
</p>
<ol style="list-style-type: decimal">
<li>
<p>
<strong>Functions obey lexical scoping.</strong> What does this mean? It’s like what they say about Las Vegas: what happens in the function, stays in the function. Any variables created inside of a function will be discarded after the function executes and will not be accessible to the outside calling process. So if you have a line, say a variable <code>my_var &lt;- 17</code> inside of a function, and try to print <code>my_var</code> from outside of the function, you will get an error: <code>object ‘my_var’ not found</code>. Although the function can ‘read’ variables from the environment that are not passed to it through an argument, it cannot change them. So you can only write a function to return a value, not change a value.
</p>
</li>
<li>
<p>
<strong>Functions return the last value that was computed.</strong> You can compute many things inside of a function but only the last thing that was computed will be returned as part of the calling process. If you want to return <code>my_var</code>, which you computed earlier but not as the final computation, you can do so explicitly using <code>return(my_var)</code> at the end of the function (before the second curly bracket).
</p>
</li>
</ol>
</div>
</div>
<p><br></p>
</div>
<div id="skill-6-replicating-operations" class="section level3" number="17.22.10">
<h3><span class="header-section-number">22.10</span> Skill 6: Replicating Operations</h3>
<p>The last skill you will need for the upcoming lab is knowing how to repeat an action (or expression) multiple times. You saw this in Lab 4 so we will only briefly recap here. Here, we use the base function <code>replicate()</code>. For instance, say you wanted to calculate the mean from <code>rnorm(100)</code> ten times, you could write it like this:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="multiple-regression.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="do">## bad way</span></span>
<span id="cb393-2"><a href="multiple-regression.html#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb393-3"><a href="multiple-regression.html#cb393-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb393-4"><a href="multiple-regression.html#cb393-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb393-5"><a href="multiple-regression.html#cb393-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb393-6"><a href="multiple-regression.html#cb393-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb393-7"><a href="multiple-regression.html#cb393-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb393-8"><a href="multiple-regression.html#cb393-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb393-9"><a href="multiple-regression.html#cb393-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span>
<span id="cb393-10"><a href="multiple-regression.html#cb393-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>()</span></code></pre></div>
<p>But it’s far easier and more readable to wrap the expression in <code>replicate()</code> function where the first argument is the number of times you want to repeat the expression stated as the second argument, i.e. <code>replicate(times, expression)</code>. Here below we replicate the mean of 100 randomly generated numbers from the normal distribution, and we do this 10 times:</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="multiple-regression.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="dv">10</span>, <span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>())</span></code></pre></div>
<p>Also you’ll probably want to store the results in a variable, for example, <code>ten_samples</code>:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="multiple-regression.html#cb395-1" aria-hidden="true" tabindex="-1"></a>ten_samples <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10</span>, <span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> <span class="fu">mean</span>())</span>
<span id="cb395-2"><a href="multiple-regression.html#cb395-2" aria-hidden="true" tabindex="-1"></a>ten_samples</span></code></pre></div>
<pre><code>##  [1]  0.110735195  0.005729656 -0.004077818  0.027126192 -0.035080774
##  [6] -0.093025492  0.168094486  0.153473305 -0.164497179 -0.136390585</code></pre>
<p>Each element (value) of the vector within <code>ten_samples</code> is the result of a single call to <code>rnorm(100) %&gt;% mean()</code>.</p>
<ul>
<li>Assuming that your <code>hello()</code> function from Skill 5 still exists, and it takes the argument <code>name = Goodbye</code>, what would happen in the console if you wrote, <code>replicate(1000, hello("Goodbye"))</code>? <select class='solveme' data-answer='["Hello Goodbye would appear a thousand times"]'> <option></option> <option>Hello World would appear a thousand times</option> <option>hello Goodbye would appear a thousand times</option> <option>Hello Goodbye would appear a thousand times</option></select> - Try it and see if it works!</li>
</ul>
<div class="solution">
<button>
Solution To Quickfire Question
</button>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="multiple-regression.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the function would be:</span></span>
<span id="cb397-2"><a href="multiple-regression.html#cb397-2" aria-hidden="true" tabindex="-1"></a>hello <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">name =</span> <span class="st">&quot;World!&quot;</span>){</span>
<span id="cb397-3"><a href="multiple-regression.html#cb397-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">&quot;Hello&quot;</span>, name)</span>
<span id="cb397-4"><a href="multiple-regression.html#cb397-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb397-5"><a href="multiple-regression.html#cb397-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-6"><a href="multiple-regression.html#cb397-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and would be called by:</span></span>
<span id="cb397-7"><a href="multiple-regression.html#cb397-7" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">hello</span>(<span class="st">&quot;Goodbye&quot;</span>))</span></code></pre></div>
</div>
<p><br></p>
</div>
<div id="finished" class="section level3" number="17.22.11">
<h3><span class="header-section-number">22.11</span> Finished!</h3>
<p>To recap, we have shown you the following six skills:</p>
<ul>
<li>Skill 1: Generating random numbers with <code>base::rnorm()</code></li>
<li>Skill 2: Permuting values with <code>base::sample()</code><br />
</li>
<li>Skill 3: Creating a “tibble” (a type of data table) using <code>tibble::tibble()</code></li>
<li>Skill 4: Computing and extracting a difference in group means using <code>dplyr::pull()</code> and <code>purrr::pluck()</code></li>
<li>Skill 5: Creating your own custom functions using <code>base::function()</code></li>
<li>Skill 6: Repeating operations using <code>base::replicate()</code></li>
</ul>
<p>You will need these skills in the coming lab to help you perform a real <strong>permutation test</strong>. Through these skills and the permutation test you will learn about null hypothesis significance testing.</p>
</div>
<div id="permutation-tests-of-hypotheses" class="section level3" number="17.22.12">
<h3><span class="header-section-number">22.12</span> Permutation Tests of Hypotheses</h3>
<p>A common statistical question when comparing two groups might be, “<strong>Is there a real difference between the group means?</strong>” From this we can establish two contrasting hypotheses:</p>
<ol style="list-style-type: decimal">
<li>The <strong>null hypothesis</strong> which states that the group means <strong>are equivalent</strong> and is written as: <span class="math inline">\(H_0: \mu_1 = \mu_2\)</span>
<ul>
<li>where <span class="math inline">\(\mu_1\)</span> is the population mean of group 1</li>
<li>and <span class="math inline">\(\mu_2\)</span> is the population mean of group 2<br />
</li>
</ul></li>
<li>Or the <strong>alternative hypothesis</strong> which states the groups means <strong>are not equivalent</strong> and is written as: <span class="math inline">\(H_1: \mu_1 \ne \mu_2\)</span>.</li>
</ol>
<p>Using the techniques you read about earlier and in previous labs, today you will learn how to test the null hypothesis of no difference between two independent groups. We will first do this using a <strong>permutation test</strong> before looking at other tests in later labs.</p>
<p>A permutation test is a basic inferential procedure that involves a reshuffling of group labels or values to create new possible outcomes of the data you collected to see how your original mean difference compares to all possible outcomes. The test can in fact be applied in many situations, this is just one, and it provides a good starting place for understanding hypothesis testing. The steps for the exercise below, and really the logic of a permutation test for two independent groups, are:</p>
<ol style="list-style-type: decimal">
<li>Calculate the real difference <span class="math inline">\(D_{orig}\)</span> between the means of two groups (e.g. Mean of A minus Mean of B).</li>
<li>Randomly shuffle the group labels (i.e. which group each participant belonged to - A or B) and re-calculate the difference, <span class="math inline">\(D&#39;\)</span>.</li>
<li>Repeat step 2 <span class="math inline">\(N_{r}\)</span> times, where <span class="math inline">\(N_r\)</span> is a large number (typically greater than 1000), storing each <span class="math inline">\(D_i&#39;\)</span> value to form a null hypothesis distribution.</li>
<li>Locate the difference you observed in step 1 (the real difference) on the null hypothesis distribution of all possible differences.</li>
<li>Decide whether the original difference is sufficiently extreme to reject the null hypothesis of no difference (<span class="math inline">\(H_0\)</span>).</li>
</ol>
<p>This logic works because if the null hypothesis is true (there is no difference between the groups) then the labeling of the observations/participants into groups is arbitrary, and we can rearrange the labels in order to estimate the likelihood of our original difference under the <span class="math inline">\(H_0\)</span>. In other words if you know the original value of the difference between two groups (or the true difference) falls in the middle of your permuted distribution then there is no significant difference between the two groups. If however the original difference falls in the tail of the permuted distribution then there might be a significant difference depending on how far into the tail it falls.</p>
<p>Let’s get started!</p>
</div>
<div id="Ch5InClassQueT1" class="section level3" number="17.22.13">
<h3><span class="header-section-number">22.13</span> Step 1: Load in Add-on Packages and Data</h3>
<p>1.1. Open a new script and call the <code>tidyverse</code> into your library.</p>
<p>1.2. Now type the statement <code>set.seed(1011)</code> at the top of your script after your library call and run it. (This ‘seeds’ the random number generator so that you will get the same results as everyone else. The number 1011 is a bit random but if everyone uses it then we all get the same outcome. Different seeds give different outcomes)</p>
<p>1.3. <a href="perm_data.csv" download>Download the data file here.</a> and read the data in <code>perm_data.csv</code> into a variable called <code>dat</code>.</p>
<p>1.4. Let’s give every participant a participant number as well by adding a new column to <code>dat</code>. Something like this would work: <code>mutate(subj_id = row_number())</code></p>
<div class="solution">
<button>
Helpful Hint
</button>
<div class="info">
<ol style="list-style-type: decimal">
<li>
<p>
Something to do with <code>library()</code>
</p>
</li>
<li>
<p>
<code>set.seed(1011)</code>
</p>
</li>
<li>
<p>
Something to do with <code>read_csv()</code>
</p>
</li>
<li>
<p>
pipe <code>%&gt;%</code> on the mutate line shown
</p>
</li>
</ol>
</div>
</div>
<div class="solution">
<button>
Portfolio Point - Different uses of row_number
</button>
<div class="info">
<p>
You will see that in the example here to put a row number for each of the participants we do not have to state the number of participants we have. In the Preclass however we did. What is the difference? Well, in the Preclass we were making a tibble and trying to create a column in that tibble using <code>row_numbers</code>. If you want to do that you have to state the number of rows, e.g. <code>1:20</code>. However, in this example in the lab today the tibble already exists, we are just adding to it. If that is the case then you can just mutate on a column of row numbers without stating the number of participants. In summary:
</p>
<ul>
<li>
When creating the tibble, state the number of participants in <code>row_numbers()</code>.
</li>
<li>
If tibble already exists, just mutate on <code>row_numbers()</code>. No need for specific numbers.
</li>
</ul>
</div>
</div>
<p>Have a look at the resulting tibble, <code>dat</code>.</p>
<ul>
<li>The column <code>Y</code> is your dependent variable (DV)</li>
<li>The column <code>group</code> is your independent variable (IV).</li>
<li>The columns <code>subj_id</code> is the participant number.</li>
</ul>
</div>
<div id="Ch5InClassQueT2" class="section level3" number="17.22.14">
<h3><span class="header-section-number">22.14</span> Step 2: Calculate the Original Mean Difference - <span class="math inline">\(D_{orig}\)</span></h3>
<p>We now need to write a pipeline of five functions that calculates the mean difference between the groups in <code>dat</code>, Group A minus Group B. Broken down into steps this would be:</p>
<p>2.1.1. Use a pipe of two <code>dplyr</code> one-table verbs (e.g. Lab 2) to create a tibble where each row contains the mean of one of the groups. Name the column storing the means as <code>m</code>.</p>
<p>2.1.2. Continue the pipe to <code>spread()</code> your data from long to wide format, based on the columns <code>group</code> and <code>m</code>.</p>
<p>2.1.3. Now add a pipe that <strong>creates</strong> a new column in this wide dataset called <code>diff</code> which is the value of group A’s mean minus group B’s mean.</p>
<p>2.1.4. Pull out the value in <code>diff</code> (the mean of group A minus the mean of group B) to finish the pipe.</p>
<div class="solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
<code>dat %&gt;%</code>
</p>
<p>
<code>group_by(?) %&gt;%</code>
</p>
<p>
<code>summarise(m = ?) %&gt;%</code>
</p>
<p>
<code>spread(group, m) %&gt;%</code>
</p>
<p>
<code>mutate(diff = ? - ?) %&gt;%</code>
</p>
<p>
<code>pull(?)</code>
</p>
</div>
</div>
<ul>
<li>Check that your value for <code>d_orig</code> is correct, without using the solution, by typing your <code>d_orig</code> value to two decimal places in the box. Include the sign, e.g. -1.23. The box will go green if you are correct. <input class='solveme nospaces' size='10' data-answer='["-7.39"]'/></li>
</ul>
<p>The above steps have created a pipeline of five functions to get one value. Nice! We now need to turn this into a function because we are going to be permuting the data set (specifically the grouping labels) and re-calculating the difference many, many times.</p>
<p>2.2. Wrap your pipeline in a function called <code>calc_diff</code> but swap <code>dat</code> for <code>x</code>. This function will take a single argument named <code>x</code>, where <code>x</code> is the tibble that you want to calculate group means from. As in the previous step, the function will return a single value which is the difference between the group means. The start will look like this below:</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="multiple-regression.html#cb398-1" aria-hidden="true" tabindex="-1"></a>calc_diff <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb398-2"><a href="multiple-regression.html#cb398-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span>.....</span>
<span id="cb398-3"><a href="multiple-regression.html#cb398-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="solution">
<button>
Helpful Hint
</button>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="multiple-regression.html#cb399-1" aria-hidden="true" tabindex="-1"></a>calc_diff <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb399-2"><a href="multiple-regression.html#cb399-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span></span>
<span id="cb399-3"><a href="multiple-regression.html#cb399-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb399-4"><a href="multiple-regression.html#cb399-4" aria-hidden="true" tabindex="-1"></a>    the_rest_of_your_pipe...</span>
<span id="cb399-5"><a href="multiple-regression.html#cb399-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<p>2.3. Now call your new function where <code>x</code> = <code>dat</code> as the argument and store the result in a new variable called <code>d_orig</code>. Make sure that your function returns the same value as you got above and that your function returns a single value rather than a tibble. You can test this: <code>is.tibble(d_orig)</code> should give you <code>FALSE</code> and <code>is.numeric(d_orig)</code> should give you <code>TRUE</code>.</p>
<div class="solution">
<button>
Helpful Hint
</button>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="multiple-regression.html#cb400-1" aria-hidden="true" tabindex="-1"></a>d_orig <span class="ot">&lt;-</span> <span class="fu">function_name</span>(<span class="at">x =</span> data_name) </span>
<span id="cb400-2"><a href="multiple-regression.html#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb400-3"><a href="multiple-regression.html#cb400-3" aria-hidden="true" tabindex="-1"></a>d_orig <span class="ot">&lt;-</span> <span class="fu">function_name</span>(data_name)</span>
<span id="cb400-4"><a href="multiple-regression.html#cb400-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-5"><a href="multiple-regression.html#cb400-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Then type the following in the Console and look at answer:</span></span>
<span id="cb400-6"><a href="multiple-regression.html#cb400-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-7"><a href="multiple-regression.html#cb400-7" aria-hidden="true" tabindex="-1"></a><span class="fu">is.tibble</span>(d_orig)</span>
<span id="cb400-8"><a href="multiple-regression.html#cb400-8" aria-hidden="true" tabindex="-1"></a><span class="co"># True (is a tibble) or False (is not a tibble)</span></span>
<span id="cb400-9"><a href="multiple-regression.html#cb400-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-10"><a href="multiple-regression.html#cb400-10" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(d_orig)</span>
<span id="cb400-11"><a href="multiple-regression.html#cb400-11" aria-hidden="true" tabindex="-1"></a><span class="co"># True (is numeric) or False (is not numeric; it is a character or integer instead.)</span></span></code></pre></div>
</div>
<p>So we now have the original difference between the groups stored in <code>d_orig</code>. Next we need to create a distribution of all possible differences to see where our original difference lies in this distribution. But first we need to shuffle the <code>group</code> letters (A or B) in our dataset and find the difference…a few hundred times!</p>
</div>
<div id="Ch5InClassQueT3" class="section level3" number="17.22.15">
<h3><span class="header-section-number">22.15</span> Step 3: Permute the Group Labels</h3>
<p>3.1. Create a new function called <code>permute()</code> that takes as input a dataset <code>x</code> and returns the same dataset transformed such that the group labels (the values in the column <code>group</code>) are shuffled: started below for you. This will require using the <code>sample()</code> function within a <code>mutate()</code>. You have used <code>mutate()</code> twice already today and you saw how to <code>sample()</code> <strong>letters</strong> in the PreClass.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="multiple-regression.html#cb401-1" aria-hidden="true" tabindex="-1"></a>permute <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb401-2"><a href="multiple-regression.html#cb401-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span>.....</span>
<span id="cb401-3"><a href="multiple-regression.html#cb401-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
Might be easier to think of these steps in reverse.
</p>
<ol style="list-style-type: decimal">
<li>
<p>
Start with a <code>mutate()</code> function that rewrites the column <code>group</code> every time you run it, e.g. <code>dat %&gt;% mutate(variable = sample(variable))</code>
</p>
</li>
<li>
<p>
Now put that into your <code>permute()</code> function making the necessary adjustments to the code so it starts <code>x %&gt;%…</code>. Again <code>x</code> should be in the function and not <code>dat</code>. ")
</p>
</li>
</ol>
</div>
</div>
<p>3.2. Try out your new <code>permute()</code> function by calling it on <code>dat</code> (i.e. <code>x = dat</code>) a few times. You should see the group labels in the <code>group</code> column changing randomly. The most common mistake is that people mutate a new column by mispelling <code>group</code>. You want to overwrite/change the information in the <code>group</code> column not make a new one, so be careful with the spelling.</p>
<p>Now would be an excellent time to spend five minutes as a group recapping what you are doing.</p>
<ul>
<li>You have the original difference between groups.</li>
<li>You have a function that calculates and stores this difference.</li>
<li>You have a function that reshuffles the labels of the group.</li>
</ul>
<p>Do you understand why? If not, go back to the principles of the permutation test at the start of the lab then read on…</p>
</div>
<div id="Ch5InClassQueT4" class="section level3" number="17.22.16">
<h3><span class="header-section-number">22.16</span> Step 4: Create the Null-Hypothesis Distribution (NHD) for the Difference</h3>
<p>Now that we have the original difference and our two functions, one to shuffle group labels and one to calculate the difference between two groups, we need to actually create the distribution of possible differences and see where the original difference lies in it.</p>
<p>4.1.1. Write a <strong>a single pipeline</strong> that takes <code>dat</code> as the input, permutes the group labels with a call to your function <code>permute()</code>, and then calculates the difference in means between these new groups with a call to your function <code>calc_diff()</code>.</p>
<p>4.1.2. Run this line manually a few times and watch the resulting value change as the labels get permuted.</p>
<div class="solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
Think about verbalising your pipelines. In a single pipeline:
</p>
<ol style="list-style-type: decimal">
<li>
I want to permute the data into two new groups.
</li>
<li>
Then I want to calculate the difference between these two new groups.
</li>
</ol>
<p>
The functions you have created do these steps. You just have to put them in order and pipe the data through it.
</p>
</div>
</div>
<p>4.2. Now take your pipeline of functions and repeat it 1000 times using the <code>replicate()</code> function. Store the output in a variable called <code>nhd</code>. <code>nhd</code> will contain 1000 values where each value is the mean difference of each of the 1000 random permutations of the data. (<strong>Warning:</strong> This will probably take a while to run, perhaps 10 seconds.)</p>
<div class="solution">
<button>
Helpful Hint
</button>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="multiple-regression.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace expression with the pipeline you created in 4.1</span></span>
<span id="cb402-2"><a href="multiple-regression.html#cb402-2" aria-hidden="true" tabindex="-1"></a>nhd <span class="ot">&lt;-</span> <span class="fu">replicate</span>(times, expression)</span></code></pre></div>
</div>
<p>You now have 1000 possible values of the difference between the permuted groups A and B - your permuted distribution.</p>
<p>4.3 Let’s visualise this distribution through a frequency histogram of the values in <code>nhd</code>. This shows us the likelihood of various mean differences under <span class="math inline">\(H_0\)</span>. One thing to note however is that <code>nhd</code> is not a <code>tibble</code> and <code>ggplot</code> needs it to be a <code>tibble</code>. You need to convert it. You might start by do something like:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="multiple-regression.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="cn">NULL</span>), <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
Remember that <code>ggplot</code> works as: <code>ggplot(data, aes(x)) + geom…</code>. Here you need to convert <code>nhd</code> into a tibble and put that in as your data. Look at the example above and keep in mind that, in this case, the first NULL could be replaced with the data in <code>nhd</code>.
</p>
</div>
</div>
<ul>
<li>Looking at the histogram, visually locate where your original value would sit on this distribution. Would it be extreme, in the tail, or does it look rather common, in the middle? <select class='solveme' data-answer='["is in the tail so looks extreme"]'> <option></option> <option>is in the middle so looks common</option> <option>is in the tail so looks extreme</option></select></li>
</ul>
<p>Before moving on stop to think about what this means - that the difference between the two original groups is rather uncommon in this permuted distribution, i.e. is in the tails! Again, if unsure, go back to the principles of NHST or discuss it with your tutor!</p>
</div>
<div id="Ch5InClassQueT5" class="section level3" number="17.22.17">
<h3><span class="header-section-number">22.17</span> Step 5: Compare the Observed Mean Difference to the NHD</h3>
<p>If the null hypothesis is false, and there is a real difference between the groups, then the difference in means we observed for the original data (<code>d_orig</code>) should be somewhere in either tail of the null-hypothesis distribution we just estimated; it should be an “extreme” value. How can we test this beyond a visual inspection?</p>
<p>First we have to decide on a false positive (Type I error) rate which is the rate at which we will falsely reject <span class="math inline">\(H_0\)</span> when it is true. This rate is referred to by the Greek letter <span class="math inline">\(\alpha\)</span> (“alpha”). Let’s just use the conventional level used in Psychology: <span class="math inline">\(\alpha = .05\)</span>.</p>
<p>So the question we must ask is, if the null hypothesis was true, what would be the probability of getting a difference in means as extreme as the one we observed in the original data? We will label this probability <code>p</code>.</p>
<p>Take a few moments to see if you can figure out how you might compute <code>p</code> from the data before we show you how. We will then show you the process in the next few, final, steps.</p>
<p>5.1. Replace the NULLS in the code below to create a logical vector which states TRUE for all values of <code>nhd</code> greater than or equal to <code>d_orig</code> regardless of sign. <strong>Note:</strong> A logical vector is one that returns TRUE when the expression is true and FALSE when the expression is false.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="multiple-regression.html#cb404-1" aria-hidden="true" tabindex="-1"></a>lvec <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="cn">NULL</span>) <span class="sc">&gt;=</span> <span class="fu">abs</span>(<span class="cn">NULL</span>)</span></code></pre></div>
<div class="solution">
<button>
Portfolio Point - abs and the case of one or two tails
</button>
<div class="info">
<p>
In the code above, the function <code>abs()</code> says to ignore the sign and use the absolute value. For instance, if <code>d_orig = -7</code>, then <code>abs(d_orig) = 7</code>. Why do we do this here? Can you think why you want to know how extreme your value is in this distribution regardless of whether the value is positive or negative?
</p>
<p>
The answer relates to whether you are testing in one or two tails of your distribution; the positive side, the negative side, or both. You will have heard in your lectures of one or two-tailed tests. Most people would say to run two-tailed tests. This means looking at the negative and positive tails of the distribution to see if our original value is extreme, and the simplest way to do this is to ignore the sign of the values and treat both sides equally. If you wanted to only test one-tail, say that your value is extreme to the negative side of the tail, then you would not use the <code>abs()</code> and set the expression to make sure you only find values less than your original value. To test only on the positive side of the distribution, make sure you only get values higher than the original. But for now we will mostly look at two-tailed tests.
</p>
</div>
</div>
<p>5.2. Replace the NULL in the code below to <code>sum()</code> the <code>lvec</code> vector to get the total number of values equal to or greater than our original difference, <code>d_orig</code>. Fortunately R is fine with summing TRUEs and FALSEs so you do not have to convert the data at all.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="multiple-regression.html#cb405-1" aria-hidden="true" tabindex="-1"></a>n_exceeding_orig <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>5.3. Replace the NULL in the code below to calculate the probability of finding a value of <code>d_orig</code> in our <code>nhd</code> distribution by dividing <code>n_exceeding_orig</code>, the number of values greater than or equal to your original value, by the <code>length()</code> of your whole distribution <code>nhd</code>. <strong>Note: the length of <code>nhd</code> is the same as the number of replications we ran. Using code reduces the chance of human error</strong></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="multiple-regression.html#cb406-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>5.4. Finally, complete the sentence below determining if the original value was extreme or not in regards to the distribution. Use inline coding, shown in Lab 1, to replace the <code>XXX</code>s. For example, when formatted without the space before the first r, <code>r length(nhd)</code> would present as 1000.</p>
<p><strong>" The difference between Group A and Group B (M = <code>XXX</code>) was found to be have a probability of p = <code>XXX</code>. This means that the original mean difference was …… and the null hypothesis is ….." </strong></p>
</div>
<div id="finished-1" class="section level3" number="17.22.18">
<h3><span class="header-section-number">22.18</span> Finished!</h3>
<p>Well done in completing this lab. Let’s recap before finishing. We had two groups, A and B, that we had tested in an experiment. We calculated the mean difference between A and B and wanted to know if this was a significant difference. To test this we created a distribution of all possible differences between A and B using the premise of permutation tests and then found the probability of our original value in that permuted distribution. The more extreme the value in a distribution the more likely that the difference is significant. And that is exactly what we found; an <span class="math inline">\(\alpha &lt; .05\)</span>. Next time we will look at using functions and inferential tests to perform this analysis but by understanding the above you now know how probability is determined.</p>
</div>
</div>
<div id="non-parametric-tests" class="section level2" number="17.23">
<h2><span class="header-section-number">23</span> Non-parametric tests</h2>
<p>First, before Dale Barr shouts at me, it needs to be noted that non-parametric tests are problematic. Because they are based on rank data:</p>
<ul>
<li>They ignore the magnitude of any differences therefore</li>
<li>They are less powerful</li>
<li>You cannot calculate interactions</li>
</ul>
<p>Additionally, with large sample sizes the parametric options (t-tests, one-way ANOVA, Pearson’s correlations) are usually robust and perform better and with the wealth of packages and tests available in R, we now all have easy access to better alternatives such as ordinal regression or permutation test, or options for data transformation that were more difficult when these tests were first popularised.</p>
<p>However, the textbooks still teach them and there may be situations in which you are called to perform non-parametric tests, so here we are.</p>
<div id="two-independent-groups" class="section level4" number="17.23.0.1">
<h4><span class="header-section-number">23.0.1</span> Two independent groups</h4>
<p>The non-parametric equivalent of a independent-samples t-test is known as the <em>Mann-Whitney-U</em> test also referred to as the <em>Wilcoxon Rank Sum</em> test. It uses ranked data to test the null hypothesis that the median ranks of two groups are different.</p>
<p>For this example we’re going to use the <code>wine</code> dataset from the <code>ordinal</code> package that has ratings for different wines.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="multiple-regression.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb407-2"><a href="multiple-regression.html#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;ordinal&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     slice</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="multiple-regression.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wine)</span>
<span id="cb410-2"><a href="multiple-regression.html#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="fu">force</span>(wine)</span></code></pre></div>
<pre><code>##    response rating temp contact bottle judge
## 1        36      2 cold      no      1     1
## 2        48      3 cold      no      2     1
## 3        47      3 cold     yes      3     1
## 4        67      4 cold     yes      4     1
## 5        77      4 warm      no      5     1
## 6        60      4 warm      no      6     1
## 7        83      5 warm     yes      7     1
## 8        90      5 warm     yes      8     1
## 9        17      1 cold      no      1     2
## 10       22      2 cold      no      2     2
## 11       14      1 cold     yes      3     2
## 12       50      3 cold     yes      4     2
## 13       30      2 warm      no      5     2
## 14       51      3 warm      no      6     2
## 15       90      5 warm     yes      7     2
## 16       70      4 warm     yes      8     2
## 17       36      2 cold      no      1     3
## 18       50      3 cold      no      2     3
## 19       42      3 cold     yes      3     3
## 20       23      2 cold     yes      4     3
## 21       80      5 warm      no      5     3
## 22       81      5 warm      no      6     3
## 23       73      4 warm     yes      7     3
## 24       62      4 warm     yes      8     3
## 25       46      3 cold      no      1     4
## 26       27      2 cold      no      2     4
## 27       48      3 cold     yes      3     4
## 28       32      2 cold     yes      4     4
## 29       57      3 warm      no      5     4
## 30       37      2 warm      no      6     4
## 31       84      5 warm     yes      7     4
## 32       58      3 warm     yes      8     4
## 33       26      2 cold      no      1     5
## 34       45      3 cold      no      2     5
## 35       61      4 cold     yes      3     5
## 36       41      3 cold     yes      4     5
## 37       48      3 warm      no      5     5
## 38       41      3 warm      no      6     5
## 39       58      3 warm     yes      7     5
## 40       55      3 warm     yes      8     5
## 41       46      3 cold      no      1     6
## 42       30      2 cold      no      2     6
## 43       54      3 cold     yes      3     6
## 44       37      2 cold     yes      4     6
## 45       32      2 warm      no      5     6
## 46       60      4 warm      no      6     6
## 47       88      5 warm     yes      7     6
## 48       73      4 warm     yes      8     6
## 49       13      1 cold      no      1     7
## 50       19      1 cold      no      2     7
## 51       31      2 cold     yes      3     7
## 52       29      2 cold     yes      4     7
## 53       22      2 warm      no      5     7
## 54       43      3 warm      no      6     7
## 55       32      2 warm     yes      7     7
## 56       49      3 warm     yes      8     7
## 57       25      2 cold      no      1     8
## 58       32      2 cold      no      2     8
## 59       39      2 cold     yes      3     8
## 60       40      3 cold     yes      4     8
## 61       51      3 warm      no      5     8
## 62       45      3 warm      no      6     8
## 63       42      3 warm     yes      7     8
## 64       67      4 warm     yes      8     8
## 65       12      1 cold      no      1     9
## 66       29      2 cold      no      2     9
## 67       47      3 cold     yes      3     9
## 68       28      2 cold     yes      4     9
## 69       47      3 warm      no      5     9
## 70       38      2 warm      no      6     9
## 71       72      4 warm     yes      7     9
## 72       65      4 warm     yes      8     9</code></pre>
<p>Each wine is given a bitterness rating on a 0-100 scale (<code>response</code> variable) and one of the grouping variables is whether the wine was served cold or warm (<code>temp</code>).</p>
<p>First, we can calculate descriptive statistics. For ordinal data the median and range are most suitable.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="multiple-regression.html#cb412-1" aria-hidden="true" tabindex="-1"></a>wine <span class="sc">%&gt;%</span></span>
<span id="cb412-2"><a href="multiple-regression.html#cb412-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp) <span class="sc">%&gt;%</span></span>
<span id="cb412-3"><a href="multiple-regression.html#cb412-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">median_response =</span> <span class="fu">median</span>(response),</span>
<span id="cb412-4"><a href="multiple-regression.html#cb412-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_response =</span> <span class="fu">min</span>(response),</span>
<span id="cb412-5"><a href="multiple-regression.html#cb412-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_response =</span> <span class="fu">max</span>(response))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   temp  median_response min_response max_response
##   &lt;fct&gt;           &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
## 1 cold               36           12           67
## 2 warm               58           22           90</code></pre>
<p>And to visualise, grouped histograms:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="multiple-regression.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wine, <span class="fu">aes</span>(<span class="at">x =</span> response, <span class="at">fill =</span> temp)) <span class="sc">+</span></span>
<span id="cb414-2"><a href="multiple-regression.html#cb414-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb414-3"><a href="multiple-regression.html#cb414-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;E&quot;</span>) <span class="sc">+</span></span>
<span id="cb414-4"><a href="multiple-regression.html#cb414-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-30"></span>
<img src="appendix-0_files/figure-html/unnamed-chunk-30-1.png" alt="**CAPTION THIS FIGURE!!**" width="100%" />
<p class="caption">
Figure 17.6: <strong>CAPTION THIS FIGURE!!</strong>
</p>
</div>
<p>The Mann-Whitney code takes the following form:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="multiple-regression.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(dv <span class="sc">~</span> iv, data, <span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Therefore to test whether bitterness ratings are significantly different between temperate groups.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="multiple-regression.html#cb417-1" aria-hidden="true" tabindex="-1"></a>np_test1 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(response <span class="sc">~</span> temp, </span>
<span id="cb417-2"><a href="multiple-regression.html#cb417-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> wine, </span>
<span id="cb417-3"><a href="multiple-regression.html#cb417-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">paired =</span> <span class="cn">FALSE</span>, </span>
<span id="cb417-4"><a href="multiple-regression.html#cb417-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">correct =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(x = c(36, 48, 47, 67, 17, 22, 14, 50, 36, :
## cannot compute exact p-value with ties</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="multiple-regression.html#cb419-1" aria-hidden="true" tabindex="-1"></a>np_test1</span></code></pre></div>
<pre><code>## 
## 	Wilcoxon rank sum test with continuity correction
## 
## data:  response by temp
## W = 214.5, p-value = 1.072e-06
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>The result of the test tells us that there is a significance difference between the groups, however, there’s also a warning message about the calculation of the p-value.</p>
<p>When we calculate a p-value, we do it under the assumption that the data are normally distributed so that we know what the probability of getting a particular score would be. However, non-parametric data isn’t normally distributed, that’s the point.</p>
<p>There are two solutions. First, there’s the exact method or the Monte Carlo method. This takes the data and randomizes the group labels, so it mixes up which group each score is in. It does this thousands of times to calculate the probability of the observed result - if you still get the same difference in scores between the groups when the labels have been randomly shuffled, you’d want to accept the null hypothesis.</p>
<p>The great thing about this method is because it randomizes the data thousands of times, you get the exact probability of your observed data. The problem is that it doesn’t work when you’ve got ties in your data.</p>
<p>The other way is to use the normal approximation and this is where rather than using the distribution of the data, it assumes that the distribution of the test statistic, so in this case <code>W</code>, is normally distributed, and calculates the probability the observed test statistic. Because the normal distribution is smooth, whereas ranked data increases in increments of .5 and 1, this can reduce the p-values so by default a correction is applied to counteract this which is what the continuity correction refers to.</p>
<div id="effect-size" class="section level5" number="17.23.0.1.1">
<h5><span class="header-section-number">23.0.1.1</span> Effect size</h5>
<p>The effect size for a Mann-wWitney is actually pearson’s R, the same r we use in correlation and is calculated by extracting the z score from the p-value. First, we create a new function to do this for us (from Field et al., 2013) that specifies we want to calculate r for the Mann-Whitney test we stored in <code>np_test</code>:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="multiple-regression.html#cb421-1" aria-hidden="true" tabindex="-1"></a>rFromWilcox <span class="ot">&lt;-</span>  <span class="cf">function</span>(np_test1, N){</span>
<span id="cb421-2"><a href="multiple-regression.html#cb421-2" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(np_test1<span class="sc">$</span>p.value<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb421-3"><a href="multiple-regression.html#cb421-3" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> Z<span class="sc">/</span><span class="fu">sqrt</span>(N)</span>
<span id="cb421-4"><a href="multiple-regression.html#cb421-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(np_test1<span class="sc">$</span>data.name, <span class="st">&quot;Effect Size, r = &quot;</span>, r)</span>
<span id="cb421-5"><a href="multiple-regression.html#cb421-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next, we use this new function to calculate the effect size by specifying the model object and the sample size.:</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="multiple-regression.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rFromWilcox</span>(np_test1, <span class="dv">72</span>)</span></code></pre></div>
<pre><code>## response by temp Effect Size, r =  -0.5748666</code></pre>
</div>
</div>
<div id="apa-write-up" class="section level4" number="17.23.0.2">
<h4><span class="header-section-number">23.0.2</span> APA write-up</h4>
<blockquote>
<p>A Mann-Whitney U test found that cold wines recieved significantly higher bitterness ratings than warm wines (<strong>W</strong> = 214.5, <strong>p</strong> &lt;.001, <strong>r</strong> = -.58).</p>
</blockquote>
</div>
<div id="spearmans-correlations" class="section level4" number="17.23.0.3">
<h4><span class="header-section-number">23.0.3</span> Spearman’s correlations</h4>
<p>The <code>cocor</code> package comes with a dataset called <code>aptitude</code>. This dataset contains scores on four aptitude tests <code>knowledge</code>, <code>logic</code>, <code>intelligence.a</code>, and <code>intelligence.b</code> for two separate samples and we’ll also load <code>lsr</code> for correlations</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="multiple-regression.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cocor)</span>
<span id="cb424-2"><a href="multiple-regression.html#cb424-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb424-3"><a href="multiple-regression.html#cb424-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lsr)</span></code></pre></div>
<p>First, let’s load the full dataset and then pull out just the data for one sample.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="multiple-regression.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(aptitude)</span>
<span id="cb425-2"><a href="multiple-regression.html#cb425-2" aria-hidden="true" tabindex="-1"></a>sample1 <span class="ot">&lt;-</span> aptitude<span class="sc">$</span>sample1</span></code></pre></div>
<p>We can use <code>ggplot()</code> to look at the distributions of the data. Looking at all four variables, we might conclude that the distributions for <code>intelligence.b</code> and <code>logic</code> do not meet the assumption of normality as so we want to do a non-parametric Spearman’s correlation (although if N &gt; 100, Spearman and Pearson correlations are basically identical but let’s ignore that for now).</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="multiple-regression.html#cb426-1" aria-hidden="true" tabindex="-1"></a>sample1 <span class="sc">%&gt;%</span></span>
<span id="cb426-2"><a href="multiple-regression.html#cb426-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subject =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb426-3"><a href="multiple-regression.html#cb426-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> knowledge<span class="sc">:</span>intelligence.a, <span class="at">names_to =</span> <span class="st">&quot;test&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;score&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb426-4"><a href="multiple-regression.html#cb426-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> score)) <span class="sc">+</span></span>
<span id="cb426-5"><a href="multiple-regression.html#cb426-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb426-6"><a href="multiple-regression.html#cb426-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>test, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-37"></span>
<img src="appendix-0_files/figure-html/unnamed-chunk-37-1.png" alt="**CAPTION THIS FIGURE!!**" width="100%" />
<p class="caption">
Figure 17.7: <strong>CAPTION THIS FIGURE!!</strong>
</p>
</div>
<p>To run a single Spearman’s correlation we can use <code>cor.test()</code>. The code is the same as we have used previously with one edit, we change <code>method</code> to <code>spearman</code>.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="multiple-regression.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(sample1<span class="sc">$</span>knowledge, sample1<span class="sc">$</span>logic, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in cor.test.default(sample1$knowledge, sample1$logic, method =
## &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
## 	Spearman&#39;s rank correlation rho
## 
## data:  sample1$knowledge and sample1$logic
## S = 3999856, p-value = 0.6577
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## 0.02608352</code></pre>
<p>For reasons I am unclear about, the Spearman test doesn’t produce degrees of freedom, the easiest way to do this is probably just to run the test again using <code>method = "pearson"</code> and take the DF from there.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="multiple-regression.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(sample1<span class="sc">$</span>knowledge, sample1<span class="sc">$</span>logic, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 	Pearson&#39;s product-moment correlation
## 
## data:  sample1$knowledge and sample1$logic
## t = 0.43664, df = 289, p-value = 0.6627
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.0895695  0.1402433
## sample estimates:
##        cor 
## 0.02567615</code></pre>
<p>If you want to run multiple correlations using <code>correlate()</code> from <code>lsr</code>, again, you just need to amend the method.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="multiple-regression.html#cb433-1" aria-hidden="true" tabindex="-1"></a>sample1 <span class="sc">%&gt;%</span></span>
<span id="cb433-2"><a href="multiple-regression.html#cb433-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>(<span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">corr.method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## 
## CORRELATIONS
## ============
## - correlation type:  spearman 
## - correlations shown only when both variables are numeric
## 
##                knowledge    logic    intelligence.b    intelligence.a   
## knowledge              .    0.026             0.169*            0.101   
## logic              0.026        .             0.279***          0.305***
## intelligence.b     0.169*   0.279***              .             0.486***
## intelligence.a     0.101    0.305***          0.486***              .   
## 
## ---
## Signif. codes: . = p &lt; .1, * = p&lt;.05, ** = p&lt;.01, *** = p&lt;.001
## 
## 
## p-VALUES
## ========
## - total number of tests run:  6 
## - correction for multiple testing:  holm 
## - WARNING: cannot compute exact p-values with ties
## 
##                knowledge logic intelligence.b intelligence.a
## knowledge              . 0.658          0.011          0.171
## logic              0.658     .          0.000          0.000
## intelligence.b     0.011 0.000              .          0.000
## intelligence.a     0.171 0.000          0.000              .
## 
## 
## SAMPLE SIZES
## ============
## 
##                knowledge logic intelligence.b intelligence.a
## knowledge            291   291            291            291
## logic                291   291            291            291
## intelligence.b       291   291            291            291
## intelligence.a       291   291            291            291</code></pre>
</div>
<div id="apa-write-up-1" class="section level4" number="17.23.0.4">
<h4><span class="header-section-number">23.0.4</span> APA write-up</h4>
<blockquote>
<p>A Spearman’s correlation found a weak,non-significant, positive correlation (rs (289) = .03, p = .658) between knowledge and logic test scores.</p>
</blockquote>
</div>
</div>
<div id="dissertation-analysis-guide" class="section level2" number="17.24">
<h2><span class="header-section-number">24</span> Dissertation analysis guide</h2>
<p>In this chapter we’re going to provide a guide for how to get started working with your dissertation data. It’s important to note that this guide won’t work for every project and every kind of data - and nothing in this chapter should supersede advice your supervisor has given you. Rather, this chapter is here to help guide you through the initial steps of working with quantitative data and to show you how what you have learned in RM2 maps on to your dissertation project.</p>
<div id="before-r" class="section level3" number="17.24.1">
<h3><span class="header-section-number">24.1</span> Before R</h3>
<p>Before you touch R, you need to make sure you understand your design, data, and analysis plan. This will make your work in R considerably easier. Before you start coding, make sure you have answers to the following questions:</p>
</div>
<div id="study-design" class="section level3" number="17.24.2">
<h3><span class="header-section-number">24.2</span> Study design</h3>
<ul>
<li>What is the design of your study?</li>
<li>What are your variables?
<ul>
<li>Are they IVs/predictors/correlation variables?</li>
<li>How many levels do they have?
<ul>
<li>Are they between or within-subject?</li>
</ul></li>
</ul></li>
<li>What are your DVs?
<ul>
<li>How will you calculate them? For example, do you need to take a mean of several of questionnaire items or reaction times from multiple trials?</li>
</ul></li>
<li>What are your hypotheses?</li>
<li>Do you have any demographic data included in the data files?</li>
<li>Thinking back to the concept of tidy data, how many variables will you have?</li>
</ul>
</div>
<div id="data-wrangling-considerations" class="section level3" number="17.24.3">
<h3><span class="header-section-number">24.3</span> Data wrangling considerations</h3>
<ul>
<li>What does each variable in your data set represent?
<ul>
<li>Do you want to rename any variables to make them easier to work with?
<ul>
<li>Do you have a convention for naming variables? For example, I use all lower-case variables and words are always separated by underscores, e.g., <code>group_data</code>.<br />
</li>
</ul></li>
<li>Are there any variables that are not necessary for the analysis? For example, consent forms.</li>
<li>Are there minimum and maximum values for any of your variables?</li>
</ul></li>
<li>Do you have multiple data sets you need to join together?
<ul>
<li>Do they have a common variable? For example, does each file have the participant ID or a question number?</li>
</ul></li>
<li>Do you need to create any new variables? For example, the mean or sum of a number of questionnaire items to give a total scale score?<br />
</li>
<li>What type of data should each variable be?
<ul>
<li>Are there any variables that you need to convert to factors?<br />
</li>
</ul></li>
<li>Do you need to recode any variables? For example, 1 = male, 2 = female, or perhaps reverse coding questionnaire responses.</li>
<li>Do you have a rule for outlier exclusion/replacement?<br />
</li>
<li>Do you need to exclude any participants? For example, if they score below a certain threshold, if they are non-native speakers etc.</li>
<li>Is there any missing data for each variable?
<ul>
<li>What will you do about missing data?</li>
</ul></li>
<li>Do you need to tidy your data?</li>
</ul>
</div>
<div id="data-analysis" class="section level3" number="17.24.4">
<h3><span class="header-section-number">24.4</span> Data analysis</h3>
<ul>
<li>What descriptive statistics do you need to calculate for each variable?
<ul>
<li>Do you need to calculate descriptive by groups?</li>
<li>Are the descriptive statistics similar to values reported in other studies that have used the same measures. Are they similar? If not, what is the explanation?</li>
</ul></li>
<li>How will you visualize your data?</li>
<li>Do you need to transform your data?</li>
<li>Do you need to conduct any kind of reliability analysis?</li>
<li>What type of inferential tests are you going to conduct?
<ul>
<li>Where appropriate, do you need to perform one or two-tailed hypothesis testing?<br />
</li>
<li>Do you need to do any dummy coding for regression models?<br />
</li>
</ul></li>
<li>What assumptions do you need to test in order to perform your analyses?
<ul>
<li>What will you do if your data do not meet these assumptions?</li>
</ul></li>
<li>Do you need to apply a correction for multiple comparison testing? If so, which one?</li>
<li>Do you need to calculate measures of effect size? If so, which ones?</li>
</ul>
<p>If this looks like a lot of work - it is. It’s important to remember that a lot of the problems that students face with R are really nothing to do with R. In order to wrangle and analyse your data you first need to understand the data that you have. If you don’t know what your independent and dependent variables are or what analysis you’re supposed to be running, it doesn’t matter what statistical software you are using, you won’t be able to complete your task. Don’t rush or skip any part of the preparation, it will make coding much harder. If you know the answers to all of the above questions then it means you’re ready to get started in R.</p>
</div>
<div id="exploring-and-cleaning-your-data" class="section level3" number="17.24.5">
<h3><span class="header-section-number">24.5</span> Exploring and cleaning your data</h3>
<p>The following sections will not provide comprehensive instructions on how to use the example code, nor will they cover every function you may need to use. You should refer to the RM2 materials, help documentation, and online resources, however, these examples may give you an idea of where to start.</p>
<p>As a first step you should explore your dataset to understand its properties and then perform some basic cleaning operations that will facilitate further analysis.</p>
</div>
<div id="summary" class="section level3" number="17.24.6">
<h3><span class="header-section-number">24.6</span> <code>summary()</code></h3>
<p>A useful first step is to run <code>summary()</code>. Check the output for:</p>
<ul>
<li>Missing data<br />
</li>
<li>What type of data each variable is<br />
</li>
<li>If the variable names are easy to work with, for example <code>Participant Age</code> is difficult to work with because it has two capital letters and a space. Renaming this as <code>age</code> will make your coding easier.<br />
</li>
<li>Any suspicious values, for example, if your likert scale is 1-7 you shouldn’t have a maximum score of 10. If you have standardised IQ scores, you may want to check that a score of 200 or 20 isn’t a typo.<br />
</li>
<li>If you make any changes, run <code>summary()</code> again</li>
</ul>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="multiple-regression.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code></pre></div>
</div>
<div id="visualisations" class="section level3" number="17.24.7">
<h3><span class="header-section-number">24.7</span> Visualisations</h3>
<p>To get an overview of the data and spot any potential issues such as outliers you should plot histograms and boxplots to eyeball the distributions.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="multiple-regression.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> variable)) <span class="sc">+</span></span>
<span id="cb436-2"><a href="multiple-regression.html#cb436-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb436-3"><a href="multiple-regression.html#cb436-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-4"><a href="multiple-regression.html#cb436-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> score)) <span class="sc">+</span></span>
<span id="cb436-5"><a href="multiple-regression.html#cb436-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
</div>
<div id="renaming-variables" class="section level3" number="17.24.8">
<h3><span class="header-section-number">24.8</span> Renaming variables</h3>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="multiple-regression.html#cb437-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rename</span>(data, <span class="at">new_name =</span> old_name)</span></code></pre></div>
</div>
<div id="converting-to-factors" class="section level3" number="17.24.9">
<h3><span class="header-section-number">24.9</span> Converting to factors</h3>
<p>This is incredibly important. Don’t skip this step otherwise things might go very wrong much further down the line.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="multiple-regression.html#cb438-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(data, <span class="at">variable =</span> <span class="fu">as_factor</span>(variable))</span></code></pre></div>
</div>
<div id="dropping-irrelevant-variables" class="section level3" number="17.24.10">
<h3><span class="header-section-number">24.10</span> Dropping irrelevant variables</h3>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="multiple-regression.html#cb439-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">select</span>(data, <span class="sc">-</span>consent1)</span></code></pre></div>
</div>
<div id="recoding-variables" class="section level3" number="17.24.11">
<h3><span class="header-section-number">24.11</span> Recoding variables</h3>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="multiple-regression.html#cb440-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(data, <span class="at">variable =</span> <span class="fu">recode</span>(variable, <span class="st">&quot;old_code&quot;</span> <span class="ot">=</span> <span class="st">&quot;new_code&quot;</span>))</span></code></pre></div>
</div>
<div id="exclude-participantsdata" class="section level3" number="17.24.12">
<h3><span class="header-section-number">24.12</span> Exclude participants/data</h3>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="multiple-regression.html#cb441-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, variable <span class="sc">!=</span> <span class="st">&quot;value&quot;</span>) <span class="co"># exclude anyone with value</span></span>
<span id="cb441-2"><a href="multiple-regression.html#cb441-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, variable <span class="sc">==</span> <span class="st">&quot;value&quot;</span>) <span class="co"># include only those with value</span></span>
<span id="cb441-3"><a href="multiple-regression.html#cb441-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;value1&quot;</span>, <span class="st">&quot;value2&quot;</span>)) <span class="co"># include all specified values</span></span>
<span id="cb441-4"><a href="multiple-regression.html#cb441-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, variable <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="co"># keep data if value of variable is more than 10</span></span>
<span id="cb441-5"><a href="multiple-regression.html#cb441-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, variable <span class="sc">&lt;=</span> <span class="dv">10</span>) <span class="co"># keep data if value of variable is less than or equal to 10</span></span></code></pre></div>
</div>
<div id="reliability" class="section level3" number="17.24.13">
<h3><span class="header-section-number">24.13</span> Reliability</h3>
<p>If you are using a scale, for example, as part of a questionnaire study you may need to calculate reliability and you should do this before you calculate the aggregated scale scores. There are several options about how you do this and you should consult your supervisor but one option is to use <code>alpha()</code> from the <code>psych</code> package.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="multiple-regression.html#cb442-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb442-2"><a href="multiple-regression.html#cb442-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Q1<span class="sc">:</span>Q5) <span class="sc">%&gt;%</span></span>
<span id="cb442-3"><a href="multiple-regression.html#cb442-3" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">alpha</span>()</span></code></pre></div>
</div>
<div id="transforming-data" class="section level3" number="17.24.14">
<h3><span class="header-section-number">24.14</span> Transforming data</h3>
<p>The above steps should leave you with a good understanding of your data and all the variables you need for your analysis. The next step is to correct any problems with the data by replacing or transforming individual values. You may also need to create new variables, for example the total score for a questionnaire or mean reaction times or accuracy.</p>
</div>
<div id="replace-missing-values" class="section level3" number="17.24.15">
<h3><span class="header-section-number">24.15</span> Replace missing values</h3>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="multiple-regression.html#cb443-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb443-2"><a href="multiple-regression.html#cb443-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">replace_na</span>(data<span class="sc">$</span>variable, <span class="dv">0</span>)) <span class="co"># replace NAs in variable with 0</span></span>
<span id="cb443-3"><a href="multiple-regression.html#cb443-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-4"><a href="multiple-regression.html#cb443-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">gender =</span> <span class="st">&quot;unknown&quot;</span>, <span class="co"># replace NAs in `gender` with &quot;unknown&quot;</span></span>
<span id="cb443-5"><a href="multiple-regression.html#cb443-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">score =</span> <span class="dv">0</span>,          <span class="co"># replace NAs in `score` with 0  </span></span>
<span id="cb443-6"><a href="multiple-regression.html#cb443-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">rt =</span> <span class="fu">mean</span>(data<span class="sc">$</span>rt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))  <span class="co"># replace NAs in `rt` with mean of `rt`</span></span></code></pre></div>
</div>
<div id="convert-implausible-values" class="section level3" number="17.24.16">
<h3><span class="header-section-number">24.16</span> Convert implausible values</h3>
<p>In the case of implausible values (such as a score or 10 on a 7-point likert scale), you may wish to recode these as missing, or as the mean (or some other value).</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="multiple-regression.html#cb444-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb444-2"><a href="multiple-regression.html#cb444-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">q1=</span> <span class="fu">ifelse</span>(q1 <span class="sc">&gt;</span> <span class="dv">10</span>, <span class="cn">NA</span>, q1)) <span class="co"># if the value in q1 is more than 10 replace it with NA, if it&#39;s not, keep the value as it is</span></span>
<span id="cb444-3"><a href="multiple-regression.html#cb444-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-4"><a href="multiple-regression.html#cb444-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb444-5"><a href="multiple-regression.html#cb444-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt =</span> <span class="fu">ifelse</span>(rt <span class="sc">&gt;</span> <span class="dv">1000</span>, <span class="fu">mean</span>(rt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), rt)) <span class="co"># if the value in rt is more than 1000, replace it with the mean rt, if it&#39;s below 1000, keep the value as it is</span></span></code></pre></div>
</div>
<div id="calculate-z-scores" class="section level3" number="17.24.17">
<h3><span class="header-section-number">24.17</span> Calculate z-scores</h3>
<p>You may want to calculate z-scores in order to remove outliers. You could then use <code>filter()</code> on the new z-score variable you have created.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="multiple-regression.html#cb445-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">z_scores =</span> <span class="fu">scale</span>(scores))</span></code></pre></div>
<p>There are a few other types of transformations we can do to correct for problems with normality. <a href="https://rcompanion.org/handbook/I_12.html">This page</a> gives a good overview of all the options.</p>
</div>
<div id="log-transformation" class="section level3" number="17.24.18">
<h3><span class="header-section-number">24.18</span> Log transformation</h3>
<p>A popular method of transformation is to calculate the log of a variable.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="multiple-regression.html#cb446-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">variable_log =</span> <span class="fu">log</span>(variable))</span></code></pre></div>
</div>
<div id="square-root" class="section level3" number="17.24.19">
<h3><span class="header-section-number">24.19</span> Square root</h3>
<p>Another popular method is to perform a square root transformation.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="multiple-regression.html#cb447-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">variable_sqrt =</span> <span class="fu">sqrt</span>(variable))</span></code></pre></div>
</div>
<div id="calculating-new-variables" class="section level3" number="17.24.20">
<h3><span class="header-section-number">24.20</span> Calculating new variables</h3>
<p>You may wish to calculate the sum or the mean of a number of variables. For example, if you have 9 questions and you want the sum of questions 1-5 and the mean of questions 6 - 9 and your data is is wide-form:</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="multiple-regression.html#cb448-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb448-2"><a href="multiple-regression.html#cb448-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_scoreq1q5 =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., Q1<span class="sc">:</span>Q5)),</span>
<span id="cb448-3"><a href="multiple-regression.html#cb448-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_scoreq6q10 =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., Q6<span class="sc">:</span>Q9)))</span></code></pre></div>
<p>If your data is in long-form you may want to use functions such as <code>gather()</code>, <code>spread()</code> and <code>summarise()</code>. See RM2 Lab 3 for more info on this.</p>
</div>
<div id="tidy-data" class="section level3" number="17.24.21">
<h3><span class="header-section-number">24.21</span> Tidy data</h3>
<p>It is at this point that you should tidy the dataset using functions such as <code>gather()</code>. Refer back to the RM1 Lab 2 and RM2 Lab 3. You may also wish to have a wide-form version of your data depending upon the analyses you are conducting.</p>
</div>
<div id="summarising-and-visualising-data" class="section level3" number="17.24.22">
<h3><span class="header-section-number">24.22</span> Summarising and visualising data</h3>
</div>
<div id="descriptive-statistics" class="section level3" number="17.24.23">
<h3><span class="header-section-number">24.23</span> Descriptive statistics</h3>
<p>At this point you may want to calculate descriptive statistics for variables of interest. Refer back to RM1 Lab 2 and Lab 3 for more information on these functions.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="multiple-regression.html#cb449-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="co"># produce descriptives for the total data set</span></span>
<span id="cb449-2"><a href="multiple-regression.html#cb449-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(score, <span class="at">na.rm =</span> true),</span>
<span id="cb449-3"><a href="multiple-regression.html#cb449-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_score =</span> <span class="fu">sd</span>(score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb449-4"><a href="multiple-regression.html#cb449-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_score =</span> <span class="fu">median</span>(score))</span>
<span id="cb449-5"><a href="multiple-regression.html#cb449-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-6"><a href="multiple-regression.html#cb449-6" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="co"># produce descriptives for each of the grouping variables</span></span>
<span id="cb449-7"><a href="multiple-regression.html#cb449-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender, condition) <span class="sc">%&gt;%</span></span>
<span id="cb449-8"><a href="multiple-regression.html#cb449-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(score, <span class="at">na.rm =</span> true),</span>
<span id="cb449-9"><a href="multiple-regression.html#cb449-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_score =</span> <span class="fu">sd</span>(score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb449-10"><a href="multiple-regression.html#cb449-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_score =</span> <span class="fu">median</span>(score))</span></code></pre></div>
<p>You may also find the function <code>describe()</code> from the <code>psych</code> package useful (you may need to install this package but as always, <strong>do not install packages on university computers</strong>). <code>describe()</code> produces a full range of descriptive statistics including skew, kurtosis and standard error.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="multiple-regression.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb450-2"><a href="multiple-regression.html#cb450-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data)</span></code></pre></div>
<p><code>describeBy()</code> produces descriptives by a grouping variable.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="multiple-regression.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(data, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>)</span></code></pre></div>
</div>
<div id="data-visualisation" class="section level3" number="17.24.24">
<h3><span class="header-section-number">24.24</span> Data visualisation</h3>
<p>At this point you should plot your data using a method that reflects the analysis you wish to conduct (e.g., a scatterplot for a correlation, a violn-boxplot for a t-test). For the plots and code specific to each type of analysis, please refer to the relevant chapters. You should ensure that your plots are as informative as possible and display the spread of the data using functions such as <code>geom_violin()</code>, and <code>geom_point()</code>. Avoid purely aggregated plots like bar charts representing means.</p>
</div>
<div id="inferential-statistics" class="section level3" number="17.24.25">
<h3><span class="header-section-number">24.25</span> Inferential statistics</h3>
<p>You are now ready to conduct your inferential analyses. For details on how to perform different tests, please refer to relevant chapters. Ensure that you understand how each test relates to each of your hypotheses.</p>
</div>
<div id="assumption-tests" class="section level3" number="17.24.26">
<h3><span class="header-section-number">24.26</span> Assumption tests</h3>
<p>Depending upon the analysis, you may be able to conduct assumption checks before the inferential tests are conducted, however, for methods such as ANOVA and regression, you need to check the model residuals and therefore this can’t be done until afterwards.</p>
<p>Foe details on what assumption checks to conduct for each statistical test, please refer to the relevant chapters.</p>

</div>
</div>
</div>
<div class="psyteachr_footer">
  
</div>
<script>

/* update total correct if #total_correct exists */
update_total_correct = function() {
  if (t = document.getElementById("total_correct")) {
    t.innerHTML =
      document.getElementsByClassName("correct").length + " of " +
      document.getElementsByClassName("solveme").length + " correct";
  }
}

/* solution button toggling function */
b_func = function() {
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "");
  }
  
  if (my_answer !== "" & real_answers.includes(my_answer)) {
    cl.add("correct");
  } else {
    cl.remove("correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol){
    var tol = JSON.parse(this.dataset.tol);  
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("correct");
    } else {
      cl.remove("correct");
    }  
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("correct");
    }  
  }
  
  update_total_correct();
}

window.onload = function() {
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('solution')) {
      buttons[i].onclick = b_func;
    }
  }
  
  /* set up solveme inputs */
  var solveme = document.getElementsByClassName("solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off"); 
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";
    
    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;
    
    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
